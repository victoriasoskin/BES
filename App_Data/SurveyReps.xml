<?xml version="1.0" encoding="utf-8"?>
<Surveys>
  <Charts SurveyGroupID="2" SubGroup="1" ConnectionString="Book10VPS">
    <OrganizationalData>
      <Avg AvgType="1">
        SELECT     ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        where 1=1
        GROUP BY סקר
      </Avg>
      <Avg AvgType="2">
        SELECT round(cast(sum([VCnt]) as float)/cast(sum([Tcnt]) as float) * 100,0)	as rslt
        FROM [vSurveyCount]
        where 1=1
      </Avg>
    </OrganizationalData>
    <SelectionControls>
      <Control ID="DSServices" Type="sql" Scontrol="DDLServices">
        SELECT ServiceName, ServiceID
        FROM P9Flist
        LEFT OUTER JOIN dbo.p0v_UserFrameList ON p9FList.FrameID = dbo.p0v_UserFrameList.FrameID
        Where Serviceid not in (8,12) And UserID=@UserID
        GROUP BY ServiceName, ServiceID
        ORDER BY ServiceID
      </Control>
      <Control ID="DSFrames" Type="sql" Scontrol="DDLFrames">
        SELECT vsfl.FrameName, vsfl.FrameID, ufl.UserID, vsfl.ServiceID
        FROM p9Flist AS vsfl
        LEFT OUTER JOIN dbo.p0v_UserFrameList AS ufl ON vsfl.FrameID = ufl.FrameID
        WHERE (ufl.UserID = @UserID) AND (vsfl.ServiceID = @ServiceID) And ServiceID not in (13,14) And SurveyID=2
      </Control>
      <Control ID="DSJob" Type="sql" Scontrol="DDLJob">
        SELECT 0 AS ID, 'כל התפקידים'  AS AnswerText UNION ALL SELECT [RJobID] AS [ID], [RJob] AS [AnswerText] FROM [Survey_RJob] where RJobID!=12
      </Control>
      <Control ID="tdd" Type="tdd" Root="1" Scontrol="tdd">(Select * From SV_Survey_Profiles Where Root=1)</Control>
    </SelectionControls>
    <Criterions>
      <Criterion Name="@Services">(ServiceID=@Services)</Criterion>
      <Criterion Name="@Frames">(FrameID=@Frames)</Criterion>
      <Criterion Name="@sen">(SenID=@Sen)</Criterion>
      <Criterion Name="@Jobs">(RJobID=@Jobs)</Criterion>
      <Criterion Name="@Profiles">((isnull(פרופיל_1,'') = ISNULL(@Profile_1,פרופיל_1)) And (isnull(פרופיל_2,'') = ISNULL(@Profile_2,isnull(פרופיל_2,''))) And (isnull(פרופיל_3,'') = ISNULL(@Profile_3,isnull(פרופיל_3,''))))</Criterion>
      <Criterion Name="@Questions">שאלה in @Questions</Criterion>
      <Criterion Name="@UserID">FrameID in (select frameid from dbo.p0v_UserFrameList where userid=@UserID)</Criterion>
      <Criterion Name="@SurveyGroupID">@SurveyGroupID</Criterion>
      <Criterion Name="@SurveyID">סקר=@SurveyID</Criterion>
      <Criterion Name="@RSurveyID">(סקר Between @RSurveyID-1 And @RSurveyID)</Criterion>
    </Criterions>
    <Chart UserGroups="Admin,FullSurveys">
      <Name>אחוזי השבה למסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="prc" MinY="0" MaxY="100" AvgType="2">
        Select distinct סקר,מסגרת + ' - ' + cast(tcnt as varchar(5)) + ' עובדים' as מסגרת,Round(Cast(vcnt as float)/Cast(tcnt as float) * 100,0) as prc from vSurveyCount_U
        Where ServiceID not in (13,14) And 1=1
        Order by Round(Cast(vcnt as float)/Cast(tcnt as float) * 100,0) desc
      </Query>
      <Params>
        <Param Name="@UserID"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys">
      <Name>אחוזי השבה למסגרת לפי אזור</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="prc" MinY="0" MaxY="100" AvgType="2">
        Select distinct סקר,
        מסגרת + ' - ' + (Select cast(tcnt as varchar(5)) from vSurveyCount where FrameID=c.FrameID and SurveyID=2) + ' עובדים' as מסגרת,
        case Cast(tcnt as float) When 0 then 0 else Round(Cast(vcnt as float)/Cast(tcnt as float) * 100,0) End as prc
        From vSurveyCount as c
        Where ServiceID not in (13,14) And 1=1 and case Cast(tcnt as float) When 0 then 0 else Round(Cast(vcnt as float)/Cast(tcnt as float) * 100,0) End != 0
        Order by סקר desc,case Cast(tcnt as float) When 0 then 0 else Round(Cast(vcnt as float)/Cast(tcnt as float) * 100,0) End desc
      </Query>
      <Params>
        <Param Name="@UserID"/>
        <Param Name="@Services" MustSelect="true"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr">
      <Name>אחוזי השבה למסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="prc" MinY="0" MaxY="100" AvgType="2">
        Select distinct סקר,
        מסגרת + ' - ' + (Select cast(tcnt as varchar(5)) from vSurveyCount where FrameID=c.FrameID and SurveyID=2) + ' עובדים' as מסגרת,
        case Cast(tcnt as float) When 0 then 0 else Round(Cast(vcnt as float)/Cast(tcnt as float) * 100,0) End as prc
        From vSurveyCount as c
        Where ServiceID not in (13,14) And 1=1 and case Cast(tcnt as float) When 0 then 0 else Round(Cast(vcnt as float)/Cast(tcnt as float) * 100,0) End != 0
        Order by סקר desc,case Cast(tcnt as float) When 0 then 0 else Round(Cast(vcnt as float)/Cast(tcnt as float) * 100,0) End desc
      </Query>
      <Params>
        <Param Name="@UserID"/>
        <Param Name="@ButtonText"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys">
      <Name>אחוזי השבה אזורים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="אזור" pivotValueColumn="prc" MinY="0" MaxY="100" AvgType="2">
        Select סקר,אזור,Round(Cast(sum(vcnt) as float)/Cast(sum(tcnt) as float) * 100,0) as prc
        From vSurveyCount
        Where Serviceid not in (8,12) And 1=1
        Group By סקר,אזור
        Order by סקר desc,Cast(Sum(Vcnt) as Float)/Cast(Sum(TCnt) as Float) desc
      </Query>
      <Params>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FMNGRTest,Frmngr,fmngr,FullSurveys">
      <Name>ממוצע ארגוני</Name>
      <Type>Column</Type>
      <Query keyColumn="Org" pivotNameColumn="סקר" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT    'ארגון' AS Org, 'ממוצע' as ממוצע,סקר,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where סקר=2010 AND 1=1
        GROUP BY סקר
        ORDER BY סקר, ROUND(AVG(CAST(Val AS float)), 2) desc
      </Query>
      <Params>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@Questions"/>
      </Params>
    </Chart>
    <!--<Chart UserGroups="Admin,FullSurveys">
      <Name>ממוצע עם ובלי שכר</Name>
      <Type>Column</Type>
      <Query keyColumn="ממוצע" pivotNameColumn="סקר" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        Select * From
        (SELECT     'ממוצע כללי' as ממוצע,סקר,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        where 1=1
        GROUP BY סקר
        UNION ALL
        SELECT     'ממוצע ללא שכר' as ממוצע,סקר,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where  1=1 And שאלה!=24
        GROUP BY סקר) as p
        Order by ממוצע,סקר
      </Query>
      <Params>
        <Param Name="@Services" />
        <Param Name="@Frames" />
        <Param Name="@Jobs" />
        <Param Name="@Sen" />
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>-->
    <Chart UserGroups="Admin,FullSurveys">
      <Name>ממוצע לפי אזורים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="אזור" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,אזור,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where אזור is not null and serviceid not in (8,12) and 1=1
        GROUP BY סקר,אזור
        ORDER BY סקר,ROUND(AVG(CAST(Val AS float)), 2) desc
      </Query>
      <Params>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@Questions"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr">
      <Name>ממוצע למסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,מסגרת,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM       vSurvey_Results_2
        Where 1=1 And ServiceID not in (8,12,13,14)
        GROUP BY סקר,מסגרת
        ORDER BY סקר,ROUND(AVG(CAST(Val AS float)), 2) desc
      </Query>
      <Params>
        <Param Name="@Services"/>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@Questions"/>
        <Param Name="@ButtonText"/>
        <Param Name="@UserID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys">
      <Name>ממוצע לפי מסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,מסגרת,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where 1=1 And ServiceID not in (8,12,13,14)
        GROUP BY סקר,מסגרת
        ORDER BY סקר,ROUND(AVG(CAST(Val AS float)), 2) desc
      </Query>
      <Params>
        <Param Name="@Services"/>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@Questions"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys">
      <Name>ממוצע לפי פרופילים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="פרופיל_1" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,פרופיל_1,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where 1=1
        GROUP BY סקר,פרופיל_1
        ORDER BY סקר,ROUND(AVG(CAST(Val AS float)), 2) desc
      </Query>
      <Params>
        <Param Name="@Services"/>
        <Param Name="@Frames"/>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@UserID"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr">
      <Name>ממוצע לפי פרופילים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="פרופיל_1" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,פרופיל_1,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where 1=1
        GROUP BY סקר,פרופיל_1
        ORDER BY סקר,ROUND(AVG(CAST(Val AS float)), 2) desc
      </Query>
      <Params>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@UserID"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys">
      <Name>הערכת המנהל הישיר</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="פרופיל_2" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,פרופיל_2,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where 1=1 And (isnull(פרופיל_1,'') = ISNULL('הערכת המנהל הישיר',פרופיל_1))
        GROUP BY סקר,פרופיל_2
        ORDER BY סקר,ROUND(AVG(CAST(Val AS float)), 2) desc
      </Query>
      <Params>
        <Param Name="@Services"/>
        <Param Name="@Frames"/>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr">
      <Name>הערכת המנהל הישיר</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="פרופיל_2" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,פרופיל_2,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where 1=1 And (isnull(פרופיל_1,'') = ISNULL('הערכת המנהל הישיר',פרופיל_1))
        GROUP BY סקר,פרופיל_2
        ORDER BY סקר,ROUND(AVG(CAST(Val AS float)), 2) desc
      </Query>
      <Params>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@UserID"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys">
      <Name>התרשמות כללית ממקום העבודה</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="פרופיל_2" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,פרופיל_2,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where 1=1 And (isnull(פרופיל_1,'') = ISNULL('התרשמות כללית ממקום העבודה',פרופיל_1))
        GROUP BY סקר,פרופיל_2
        ORDER BY סקר,ROUND(AVG(CAST(Val AS float)), 2) desc
      </Query>
      <Params>
        <Param Name="@Services"/>
        <Param Name="@Frames"/>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr">
      <Name>התרשמות כללית ממקום העבודה</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="פרופיל_2" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,פרופיל_2,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where 1=1 And (isnull(פרופיל_1,'') = ISNULL('התרשמות כללית ממקום העבודה',פרופיל_1))
        GROUP BY סקר,פרופיל_2
        ORDER BY סקר,ROUND(AVG(CAST(Val AS float)), 2) desc
      </Query>
      <Params>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@UserID"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys">
      <Name>מידת הענין מתחום העיסוק</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="פרופיל_2" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,פרופיל_2,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where 1=1 And (isnull(פרופיל_1,'') = ISNULL('מידת הענין מתחום העיסוק',פרופיל_1))
        GROUP BY סקר,פרופיל_2
        ORDER BY סקר,ROUND(AVG(CAST(Val AS float)), 2) desc
      </Query>
      <Params>
        <Param Name="@Services"/>
        <Param Name="@Frames"/>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr">
      <Name>מידת הענין מתחום העיסוק</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="פרופיל_2" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,פרופיל_2,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where 1=1 And (isnull(פרופיל_1,'') = ISNULL('מידת הענין מתחום העיסוק',פרופיל_1))
        GROUP BY סקר,פרופיל_2
        ORDER BY סקר,ROUND(AVG(CAST(Val AS float)), 2) desc
      </Query>
      <Params>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@UserID"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys">
      <Name>אמונה בדרך</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="פרופיל_3" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,פרופיל_3,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where 1=1 And (isnull(פרופיל_2,'') = ISNULL('אמונה בדרך',פרופיל_2))
        GROUP BY סקר,פרופיל_3
        ORDER BY סקר,ROUND(AVG(CAST(Val AS float)), 2) desc
      </Query>
      <Params>
        <Param Name="@Services"/>
        <Param Name="@Frames"/>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr">
      <Name>אמונה בדרך</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="פרופיל_3" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,פרופיל_3,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where 1=1 And (isnull(פרופיל_2,'') = ISNULL('אמונה בדרך',פרופיל_2))
        GROUP BY סקר,פרופיל_3
        ORDER BY סקר,ROUND(AVG(CAST(Val AS float)), 2) desc
      </Query>
      <Params>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@UserID"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys">
      <Name>ממוצע לפי שאלות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="שאלה" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,שאלה,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        where 1=1
        GROUP BY סקר,שאלה
        ORDER BY סקר,שאלה
      </Query>
      <Params>
        <Param Name="@Services"/>
        <Param Name="@Frames"/>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@SurveyID"/>
        <Param Name="@Questions"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr">
      <Name>ממוצע לפי שאלות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="שאלה" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,שאלה,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        where 1=1
        GROUP BY סקר,שאלה
        ORDER BY סקר,שאלה
      </Query>
      <Params>
        <Param Name="@Jobs"/>
        <Param Name="@Sen"/>
        <Param Name="@UserID"/>
        <Param Name="@Questions"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys">
      <Name>ממוצע לפי ותק</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ותק" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT  shortDescription as סקר,Sen as ותק,
        (Select ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        From vSurvey_Results_2 r
        where r.senID=t.SenID and r.SurveyID=s.Surveyid And 1=1) As rslt
        FROM         SV_Surveys s cross join Survey_sen as t
        where SurveyGroupID=2 And SubGroup=1
        order by shortdescription,senid
      </Query>
      <Params>
        <Param Name="@Services"/>
        <Param Name="@Frames"/>
        <Param Name="@Jobs"/>
        <Param Name="@Questions"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr">
      <Name>ממוצע לפי ותק</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ותק" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT  shortDescription as סקר,Sen as ותק,
        (Select ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        From vSurvey_Results_2 r
        where r.senID=t.SenID and r.SurveyID=s.Surveyid And 1=1) As rslt
        FROM         SV_Surveys s cross join Survey_sen as t
        where SurveyGroupID=2 And SubGroup=1
        order by shortdescription,senid
      </Query>
      <Params>
        <Param Name="@Jobs"/>
        <Param Name="@Questions"/>
        <Param Name="@SurveyID"/>
        <Param Name="@UserID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys">
      <Name>ממוצע לפי תפקיד</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="תפקיד" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,תפקיד,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM  vSurvey_Results_2
        Where 1=1 And תפקיד is not null and RJobID&lt;=7 And ServiceID not in (8,12,13,14)
        GROUP BY סקר,תפקיד,RJobID
        order by סקר,RjobID
      </Query>
      <Params>
        <Param Name="@Services"/>
        <Param Name="@Frames"/>
        <Param Name="@Sen"/>
        <Param Name="@Questions"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr">
      <Name>ממוצע לפי תפקיד</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="תפקיד" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,תפקיד,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM  vSurvey_Results_2
        Where 1=1 And תפקיד is not null and RJobID&lt;=7 And ServiceID not in (8,12,13,14)
        GROUP BY סקר,תפקיד,RJobID
        order by סקר,RjobID
      </Query>
      <Params>
        <Param Name="@Sen"/>
        <Param Name="@Questions"/>
        <Param Name="@UserID"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys">
      <Name>ממוצע לפי שירות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="שירות" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT     סקר,שירות,ROUND(AVG(CAST(Val AS float)), 2) AS rslt
        FROM         vSurvey_Results_2
        Where 1=1 And שירות is not null
        GROUP BY סקר,שירות,RJobID
        order by סקר,שירות
      </Query>
      <Params>
        <Param Name="@Services"/>
        <Param Name="@Sen"/>
        <Param Name="@Questions"/>
        <Param Name="@Jobs"/>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr,SurveysF,Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>הטקסט המלא של שאלות הסקר</Name>
      <Type>URL</Type>
      <Query>
        SurveyQuestionpopup.aspx?s=2
      </Query>
      <Params>
        <Param Name="@SurveyGroupID" Repl="1" Conc=""/>
      </Params>
    </Chart>
  </Charts>
  <Charts SurveyGroupID="2" SubGroup="2" ConnectionString="Book10VPS">
    <OrganizationalData>
      <Avg AvgType="1"></Avg>
      <Avg AvgType="2"></Avg>
    </OrganizationalData>
    <SelectionControls>
      <Control ID="DSServices" Type="sql" Scontrol="DDLServices">
        Select ServiceName,ServiceID
        From
        (SELECT ServiceName, ServiceID
        FROM ServiceList
        Where Serviceid in (1,2,3,4,8) And ServiceID in (Select Distinct ServiceID
        From FrameList
        Where FrameID in (Select FrameID
        From dbo.p0v_UserFrameList
        Where UserID=@UserID))) x
        ORDER BY ServiceID
      </Control>
      <Control ID="DSFrames" Type="sql" Scontrol="DDLFrames">
        SELECT f.FrameName, f.FrameID, @UserID As UserID, f.ServiceID
        FROM FrameList f
        WHERE f.FrameID not in(14,23) And f.FrameID in (Select FrameID
        From dbo.p0v_UserFrameList
        Where (UserID=@UserID)) And (f.ServiceID=@ServiceID)
      </Control>
      <Control ID="DSProfiles" Type="sql" Scontrol="DDLProfiles">
        Select * From SV_Survey_Profiles Where Root=27
      </Control>
      <Control ID="DSJob" Type="sql" Scontrol="DDLJob">
        SELECT 0 AS ID,'כל התפקידים' AS AnswerText UNION ALL
        SELECT [ID], [AnswerText]
        FROM [SV_SurAnswers]
        Where ExcludeFromList = 0 AND ID in (Select Val From (Select val,count(*) Over(Partition by val) as c From Survey_Answers_8 Where QuestionID=91 And FrameID=Coalesce(@FrameID,@FrameIDD,'99999')) x)
      </Control>
    </SelectionControls>
    <Criterions>
      <Criterion Name="@Services">(Prefix.ServiceID=@Services)</Criterion>
      <Criterion Name="@Frames">(Prefix.FrameID=@Frames)</Criterion>
      <Criterion Name="@sen">(Prefix.SenID=@Sen)</Criterion>
      <Criterion Name="@Jobs">(Prefix.JobID=@Jobs)</Criterion>
      <Criterion Name="@Profiles">((isnull(פרופיל_1,'') = ISNULL(@Profile_1,פרופיל_1)) And (isnull(פרופיל_2,'') = ISNULL(@Profile_2,isnull(פרופיל_2,''))) And (isnull(פרופיל_3,'') = ISNULL(@Profile_3,isnull(פרופיל_3,''))))</Criterion>
      <Criterion Name="@Questions">שאלה in @Questions</Criterion>
      <Criterion Name="@UserID">Prefix.FrameID in (select frameid from dbo.p0v_UserFrameList where userid=@UserID)</Criterion>
      <Criterion Name="@FrameID">ISNULL(Prefix.FrameID,@FrameID)=@FrameID</Criterion>
      <Criterion Name="@Profilen">
        Prefix.QuestionID in (SELECT QuestionID
        FROM SV_Survey_PRofileSA
        Where SurveyID=@SurveyID And CategoryID=(Select CategoryID From SV_Survey_Profiles Where title=@Profilen And SurveyID=2 And SubGroup=2))
      </Criterion>
      <Criterion Name="@ExcludeFrameID">Prefix.FrameID!=@ExcludeFrameID</Criterion>
      <Criterion Name="@SurveyGroupID">@SurveyGroupID</Criterion>
      <Criterion Name="@SurveyGroupName">@SurveyGroupName</Criterion>
      <Criterion Name="@JobQ">(Prefix.JobID=@JobQ)</Criterion>
      <Criterion Name="@FrameQ">(Prefix.FrameID=@FrameQ)</Criterion>
      <Criterion Name="@SurveyID">(SurveyID=@SurveyID)</Criterion>
      <Criterion Name="@RSurveyID">@RSurveyID</Criterion>
    </Criterions>
    <TextsReport>
      Declare @SurveyID int
      Select top 1 @SurveyID = SurveyID from SV_Surveys where SurveyGroupID=2 And SubGroup=2 order by ShortDescription DESC
      SELECT textclass x,TextDET,Case r When 1 then TextClass + '&lt;br(' + Cast(c As varchar(5)) + ' הערות)' Else NULL End As TextClass,FrameName,c,r From (
      SELECT     distinct t.TextDET,tc.TextClass,fl.FrameName,count(*) Over(Partition by tc.TextClass) as c,
      ROW_NUMBER() Over(Partition by tc.TextClass Order by tc.TextClass,fl.FrameName) as r
      From  SV_Survey_Texts t
      LEFT OUTER JOIN (Select Distinct FormID,FrameID From Survey_Answers_8 where FrameID is not null) a on t.FormID=a.FormID
      LEFT OUTER JOIN SV_TextClassificastions c on t.FormID = c.FormID And t.QuestionID=c.QuestionID
      LEFT OUTER JOIN SV_TextClasses tc on tc.textClassID=isnull(c.TextClassID,9)
      LEFT OUTER JOIN FrameList fl on fl.FrameID=a.FrameID
      LEFT OUTER JOIN ServiceList sl on sl.ServiceID=fl.ServiceID
      LEFT OUTER JOIN SV_Survey_Forms f on f.FormID=a.FormID
      Where (a.FrameID is not null) And (SurveyID = 8) AND (LEN(t.TextDET) &gt; 0) AND (a.FrameID = ISNULL(@FrameID, a.FrameID)) AND (fl.ServiceID = @ServiceID) And (t.QuestionID=@QuestionID)) x
      ORDER BY case TextClass when 'שונות' Then 0 Else c End desc,x,r
    </TextsReport>
    <Chart UserGroups="Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>מצגת ארגונית</Name>
      <Type>PPT</Type>
      <Query>
        Select URL from SV_PPTList WHERE ServiceID is null And SurveyID=8
      </Query>
      <Params></Params>
    </Chart>
    <Chart UserGroups="Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>מצגת חטיבה טיפולית</Name>
      <Type>PPT</Type>
      <Query>
        Select URL From SV_PPTList p WHERE SurveyID=8 And ServiceID=1
      </Query>
      <Params>
        <Param Name="@SurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>מצגת אזור צפון</Name>
      <Type>PPT</Type>
      <Query>
        Select URL From SV_PPTList p WHERE SurveyID=8 And ServiceID=2
      </Query>
      <Params></Params>
    </Chart>
    <Chart UserGroups="Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>מצגת אזור שרון</Name>
      <Type>PPT</Type>
      <Query>
        Select URL From SV_PPTList p WHERE SurveyID=8 And ServiceID=3
      </Query>
      <Params></Params>
    </Chart>
    <Chart UserGroups="Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>מצגת אזור מרכז/דרום</Name>
      <Type>PPT</Type>
      <Query>
        Select URL From SV_PPTList p WHERE SurveyID=8 And ServiceID=4
      </Query>
      <Params></Params>
    </Chart>
    <Chart UserGroups="Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>מצגת מטה</Name>
      <Type>PPT</Type>
      <Query>
        Select URL From SV_PPTList p WHERE SurveyID=8 And ServiceID=8
      </Query>
      <Params></Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys">
      <Name>אחוז מענה למסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ארגון" pivotValueColumn="prc" MinY="0" MaxY="100">
        Declare @SurveyID int
        SET @SurveyID = 2=2
        Select 2011 As סקר,ColH As ארגון,prc
        From
        (Select 5 as Ord,ColH + '\n n=' + CAST(Fcnt as varchar(5)) + '/' + CAST(Cnt as varchar(5)) As Colh, ROUND(Cast(ISNULL(Fcnt,0) as float) / cast(Cnt as float) * 100,0) as prc
        From (SELECT c.[FrameID],[Cnt],[FCnt],f.FrameName As ColH
        FROM [Survey_PCount] c
        LEFT OUTER JOIN FrameList f on f.FrameID=c.FrameID
        LEFT OUTER JOIN ServiceList s on s.ServiceID=f.ServiceID
        where SurveyID=@SurveyID And 1=1) x
        UNION ALL
        Select 4 As Ord, ' ' As ColH, 0 as prc
        UNION ALL
        Select 3 As ORD, ColH + '\n n=' + CAST(Fcnt as varchar(5)) + '/' + CAST(Cnt as varchar(5)) As Colh, ROUND(Cast(ISNULL(Fcnt,0) as float) / cast(Cnt as float) * 100,0) as prc
        From
        (SELECT sum([Cnt]) As [Cnt],sum([FCnt]) As [FCnt],s.ServiceName As ColH
        FROM [Survey_PCount] c
        LEFT OUTER JOIN FrameList f on f.FrameID=c.FrameID
        LEFT OUTER JOIN ServiceList s on s.ServiceID=f.ServiceID
        where SurveyID=@SurveyID And f.ServiceID in (1,2,3,4,14)
        Group By s.ServiceName) x
        UNION ALL
        Select 2 As ORD, '  ' As Colh, 0 as prc
        UNION ALL
        Select 1 As ORD, ColH + '\n n=' + CAST(Fcnt as varchar(5)) + '/' + CAST(Cnt as varchar(5)) As Colh, ROUND(Cast(ISNULL(Fcnt,0) as float) / cast(Cnt as float) * 100,0) as prc
        From (SELECT sum([Cnt]) As [Cnt],sum([FCnt]) As [FCnt],'כלל הארגון' As ColH
        FROM [Survey_PCount] c
        LEFT OUTER JOIN FrameList f on f.FrameID=c.FrameID
        LEFT OUTER JOIN ServiceList s on s.ServiceID=f.ServiceID
        where SurveyID=@SurveyID) x) y
        order by Ord,prc
      </Query>
      <Params>
        <Param Name="@UserID" Prefix="c"/>
        <Param Name="@Services" Prefix="f" MustSelect="true"/>
        <Param Name="@Frames" Prefix="c" MustSelect="true"/>
        <Param Name="@RSurveyID" Repl="2"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF">
      <Name>אחוז מענה</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ארגון" pivotValueColumn="prc" MinY="0" MaxY="100">
        Declare @SurveyID int
        SET @SurveyID = 2=2
        Select 2011 As סקר,ColH As ארגון,prc
        From
        (Select 5 as Ord,ColH + '\n n=' + CAST(Fcnt as varchar(5)) + '/' + CAST(Cnt as varchar(5)) As Colh, ROUND(Cast(ISNULL(Fcnt,0) as float) / cast(Cnt as float) * 100,0) as prc
        From (SELECT c.[FrameID],[Cnt],[FCnt],f.FrameName As ColH
        FROM [Survey_PCount] c
        LEFT OUTER JOIN FrameList f on f.FrameID=c.FrameID
        LEFT OUTER JOIN ServiceList s on s.ServiceID=f.ServiceID
        where SurveyID=@SurveyID And 1=1) x
        UNION ALL
        Select 4 As Ord, ' ' As ColH, 0 as prc
        UNION ALL
        Select 3 As ORD, ColH + '\n n=' + CAST(Fcnt as varchar(5)) + '/' + CAST(Cnt as varchar(5)) As Colh, ROUND(Cast(ISNULL(Fcnt,0) as float) / cast(Cnt as float) * 100,0) as prc
        From
        (SELECT sum([Cnt]) As [Cnt],sum([FCnt]) As [FCnt],s.ServiceName As ColH
        FROM [Survey_PCount] c
        LEFT OUTER JOIN FrameList f on f.FrameID=c.FrameID
        LEFT OUTER JOIN ServiceList s on s.ServiceID=f.ServiceID
        where SurveyID=@SurveyID And f.ServiceID in (1,2,3,4,14)
        Group By s.ServiceName) x
        UNION ALL
        Select 2 As ORD, '  ' As Colh, 0 as prc
        UNION ALL
        Select 1 As ORD, ColH + '\n n=' + CAST(Fcnt as varchar(5)) + '/' + CAST(Cnt as varchar(5)) As Colh, ROUND(Cast(ISNULL(Fcnt,0) as float) / cast(Cnt as float) * 100,0) as prc
        From (SELECT sum([Cnt]) As [Cnt],sum([FCnt]) As [FCnt],'כלל הארגון' As ColH
        FROM [Survey_PCount] c
        LEFT OUTER JOIN FrameList f on f.FrameID=c.FrameID
        LEFT OUTER JOIN ServiceList s on s.ServiceID=f.ServiceID
        where SurveyID=@SurveyID) x) y
        order by Ord,prc
      </Query>
      <Params>
        <Param Name="@UserID" Prefix="c" Repl="1"/>
        <Param Name="@RSurveyID" Repl="2"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF">
      <Name>מצגת אזורית</Name>
      <Type>PPT</Type>
      <Query>
        Select URL from SV_PPTList Where SurveyID=8 And ServiceID=(Select ServiceID From FrameList Where 1=1)
      </Query>
      <Params>
        <Param Name="@FrameID"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT">
      <Name>מצגת אזורית</Name>
      <Type>PPT</Type>
      <Query>
        Select URL from SV_PPTList WHERE SurveyID=8 And 1=1
      </Query>
      <Params>
        <Param Name="@Services" Repl="1" MustSelect="true"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF">
      <Name>אינדיקטורים של המחויבות הארגונית במסגרת בהשוואה לכלל הארגון</Name>
      <Type>Column</Type>
      <Query keyColumn="ארגון" pivotNameColumn="Question" pivotValueColumn="Avgx" LabelFormat="0.00;-0.00;" MinY="0" MaxY="5">
        Declare @SurveyID int
        SET @SurveyID = 3=3
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select ColH  + Case b when 2 then @JobCnt Else '' End As ארגון,Question, Avgx
        From(
        Select b,ColH,Question,Avgx,1 as Ord
        From
        (Select b,ColH,Question,Round(AvG(cast(Val As Float)),2) as Avgx
        From
        (Select 1 as b,'כלל הארגון' As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        Where a.QuestionID between 40 and 45 And 2=2
        UNION ALL
        Select  2 as b,f.FrameName As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where a.QuestionID between 40 and 45 And 1=1 And 2=2) k
        Group by ColH,Question,b) x
        UNION ALL
        Select b,ColH,Question,Avgx,3 As ORd
        From
        (Select b,ColH,Question,Round(AvG(cast(Val As Float)),2) as Avgx
        From
        (Select 1 as b,'כלל הארגון' As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        Where a.QuestionID = 39 And 2=2
        UNION ALL
        Select 2 as b,f.FrameName As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where a.QuestionID = 39 And 1=1 And 2=2) k
        Group by ColH,Question,b) x
        UNION ALL
        Select 1 as b,'כלל הארגון'  As ColH,'-' As Question,0 As Avgx,2 As ORd) y
        Order By b,Ord,Avgx
      </Query>
      <Params>
        <Param Name="@FrameID" Repl="1" Prefix="a"/>
        <Param Name="@Jobs" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  בכלל הארגון</Param>
        <Param Name="@RSurveyID" Repl="3"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys">
      <Name>אינדיקטורים של המחויבות הארגונית במסגרת בהשוואה לכלל הארגון</Name>
      <Type>Column</Type>
      <Query keyColumn="ארגון" pivotNameColumn="Question" pivotValueColumn="Avgx" LabelFormat="0.00;-0.00;" MinY="0" MaxY="5">
        Declare @SurveyID int
        SET @SurveyID = 4=4
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select ColH + Case b when 2 then @JobCnt Else '' End As ארגון,Question, Avgx
        From(
        Select b,ColH,Question,Avgx,1 as Ord
        From
        (Select b,ColH,Question,Round(AvG(cast(Val As Float)),2) as Avgx
        From
        (Select 1 as b,'כלל הארגון' As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        Where a.QuestionID between 40 and 45 And 2=2
        UNION ALL
        Select  2 as b,f.FrameName As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where a.QuestionID between 40 and 45 And 1=1 And 2=2 And 3=3) k
        Group by ColH,Question,b) x
        UNION ALL
        Select b,ColH,Question,Avgx,3 As ORd
        From
        (Select b,ColH,Question,Round(AvG(cast(Val As Float)),2) as Avgx
        From
        (Select 1 as b,'כלל הארגון' As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        Where a.QuestionID = 39 And 2=2
        UNION ALL
        Select 2 as b,f.FrameName As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where a.QuestionID = 39 And 1=1 And 2=2 And 3=3) k
        Group by ColH,Question,b) x
        UNION ALL
        Select 1 as b,'כלל הארגון'  As ColH,'-' As Question,0 As Avgx,2 As ORd) y
        Order By b,Ord,Avgx
      </Query>
      <Params>
        <Param Name="@UserID" Repl="1" Prefix="a"/>
        <Param Name="@Services" Repl="3" Prefix="f" MustSelect="true"/>
        <Param Name="@Frames" Repl="1" Prefix="a" MustSelect="true"/>
        <Param Name="@Jobs" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  בכלל הארגון</Param>
        <Param Name="@RSurveyID" Repl="4"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF">
      <Name>אינדיקטורים של המחויבות הארגונית במסגרת בהשוואה למסגרות דומות</Name>
      <Type>Column</Type>
      <Query keyColumn="ארגון" pivotNameColumn="Question" pivotValueColumn="Avgx" LabelFormat="0.00;-0.00;" MinY="0" MaxY="5">
        Declare @SurveyID int
        SET @SurveyID = 3=3
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select ColH + Case b when 2 then @JobCnt Else '' End As ארגון,Question, Avgx
        From(
        Select b,ColH,Question,Avgx,1 as Ord
        From
        (Select b,ColH,Question,Round(AvG(cast(Val As Float)),2) as Avgx
        From
        (Select 1 as b,'מסגרות דומות ללא המסגרת שלך' As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID And f.ServiceTypeID=(Select ServiceTypeID From FrameList Where FrameID=a.FrameID)
        Where a.QuestionID between 40 and 45 And 2=2 And 3=3
        UNION ALL
        Select  2 as b,f.FrameName As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where a.QuestionID between 40 and 45 And 1=1 And 2=2) k
        Group by ColH,Question,b) x
        UNION ALL
        Select b,ColH,Question,Avgx,3 As ORd
        From
        (Select b,ColH,Question,Round(AvG(cast(Val As Float)),2) as Avgx
        From
        (Select 1 as b,'מסגרות דומות ללא המסגרת שלך' As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID And f.ServiceTypeID=(Select ServiceTypeID From FrameList Where FrameID=a.FrameID)
        Where a.QuestionID = 39 And 2=2 And 3=3
        UNION ALL
        Select 2 as b,f.FrameName As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where a.QuestionID = 39 And 1=1 And 2=2) k
        Group by ColH,Question,b) x
        UNION ALL
        Select 1 as b,'מסגרות דומות ללא המסגרת שלך'  As ColH,'-' As Question,0 As Avgx,2 As ORd) y
        Order By b,Ord,Avgx
      </Query>
      <Params>
        <Param Name="@FrameID" Repl="1"/>
        <Param Name="@Jobs" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  במסגרות דומות</Param>
        <Param Name="@ExcludeFrameID" Prefix="a" Repl="3"/>
        <Param Name="@RSurveyID" Repl="3"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys">
      <Name>אינדיקטורים של המחויבות הארגונית במסגרת בהשוואה למסגרות דומות</Name>
      <Type>Column</Type>
      <Query keyColumn="ארגון" pivotNameColumn="Question" pivotValueColumn="Avgx" LabelFormat="0.00;-0.00;" MinY="0" MaxY="5">
        Declare @SurveyID int
        SET @SurveyID = 5=5
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select ColH + Case b when 2 then @JobCnt Else '' End As ארגון,Question, Avgx
        From(
        Select b,ColH,Question,Avgx,1 as Ord
        From
        (Select b,ColH,Question,Round(AvG(cast(Val As Float)),2) as Avgx
        From
        (Select 1 as b,'מסגרות דומות ללא המסגרת שלך' As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID And f.ServiceTypeID=(Select ServiceTypeID From FrameList Where FrameID=a.FrameID)
        Where a.QuestionID between 40 and 45 And 2=2 And 3=3
        UNION ALL
        Select  2 as b,f.FrameName As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where a.QuestionID between 40 and 45 And 1=1 And 2=2 And 4=4) k
        Group by ColH,Question,b) x
        UNION ALL
        Select b,ColH,Question,Avgx,3 As ORd
        From
        (Select b,ColH,Question,Round(AvG(cast(Val As Float)),2) as Avgx
        From
        (Select 1 as b,'מסגרות דומות ללא המסגרת שלך' As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID And f.ServiceTypeID=(Select ServiceTypeID From FrameList Where FrameID=a.FrameID)
        Where a.QuestionID = 39 And 2=2 And 3=3
        UNION ALL
        Select 2 as b,f.FrameName As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where a.QuestionID = 39 And 1=1 And 2=2 And 4=4) k
        Group by ColH,Question,b) x
        UNION ALL
        Select 1 as b,'מסגרות דומות ללא המסגרת שלך'  As ColH,'-' As Question,0 As Avgx,2 As ORd) y
        Order By b,Ord,Avgx
      </Query>
      <Params>
        <Param Name="@UserID" Repl="1" Prefix="a" MustSelect="true"/>
        <Param Name="@Services" Repl="4" Prefix="f" MustSelect="true"/>
        <Param Name="@Frames" Repl="1" Prefix="a" MustSelect="true"/>
        <Param Name="@Jobs" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  במסגרות דומות</Param>
        <Param Name="@ExcludeFrameID" Prefix="a" Repl="3"/>
        <Param Name="@RSurveyID" Repl="5"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF">
      <Name>ממוצע הממדים במסגרת בהשוואה לכלל הארגון</Name>
      <Type>Bar</Type>
      <Query keyColumn="ארגון" pivotNameColumn="title" pivotValueColumn="Avgx" MinY="0" MaxY="5" LabelFormat="0.00;-0.00;" URL="SurveyAvg.aspx?Rep=ממוצע מפורט למימד במסגרת בהשוואה לכלל הארגון&amp;P=#ColHdr#&amp;J=#JobID#&amp;JN=#JobName#">
        Declare @SurveyID int
        SET @SurveyID = 3=3
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select ColH + Case b when 2 then @JobCnt Else '' End as ארגון,title,isnull(Avgx,0) as Avgx
        From
        (Select b,ColH,title,ROUND(AVG(Val),2) AS Avgx,ord From
        (SELECT CategoryID,title,ord FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth&gt;0) p
        LEFT OUTER JOIN (
        Select 1 As b,'כלל הארגון' As ColH,Avg(a.Val) As Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_PRofileSA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        Where CategoryID IS NOT NULL And 2=2
        GROUP BY a.FormID * 10 + a.c,pa.CategoryID
        UNION ALL
        Select  2 As b,f.FrameName As ColH,Avg(a.Val) as Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_PRofileSA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where CategoryID IS NOT NULL And 1=1 And 2=2
        Group By a.FormID,pa.CategoryID,f.FrameName) k on p.CategoryID=k.CategoryID
        Group by b,ColH,title,ord
        UNION ALL
        SELECT 1 as b,'כלל הארגון' As ColH,title,0 As Avg,Ord
        FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth=0 And CategoryID!=27) x
        order by b,ColH,ord desc
      </Query>
      <Params>
        <Param Name="@FrameID" Repl="1" Prefix="a"/>
        <Param Name="@Jobs" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  בכלל הארגון</Param>
        <Param Name="@RSurveyID" Repl="3"/>
      </Params>
      <Comment>ניתן להקליק על גרף של מימד, ולקבל דוח המציג את פירוט השאלות הכלולות במימד</Comment>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys">
      <Name>ממוצע הממדים במסגרת בהשוואה לכלל הארגון</Name>
      <Type>Bar</Type>
      <Query keyColumn="ארגון" pivotNameColumn="title" pivotValueColumn="Avgx" MinY="0" MaxY="5" LabelFormat="0.00;-0.00;" URL="SurveyAvg.aspx?Rep=ממוצע מפורט למימד במסגרת בהשוואה לכלל הארגון&amp;P=#ColHdr#&amp;J=#JobID#&amp;JN=#JobName#&amp;F=#FrameID#&amp;FN=#FrameName#">
        Declare @SurveyID int
        SET @SurveyID = 4=4
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select ColH + Case b when 2 then @JobCnt Else '' End as ארגון,title,isnull(Avgx,0) as Avgx
        From
        (Select b,ColH,title,ROUND(AVG(Val),2) AS Avgx,ord From
        (SELECT CategoryID,title,ord FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth&gt;0) p
        LEFT OUTER JOIN (
        Select 1 As b,'כלל הארגון' As ColH,Avg(a.Val) As Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_ProfilesA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        Where CategoryID IS NOT NULL And 2=2
        GROUP BY a.FormID * 10 + a.c,pa.CategoryID
        UNION ALL
        Select  2 As b,f.FrameName As ColH,Avg(a.Val) as Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_ProfilesA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where CategoryID IS NOT NULL And 1=1 And 2=2 And 3=3
        Group By a.FormID,pa.CategoryID,f.FrameName) k on p.CategoryID=k.CategoryID
        Group by b,ColH,title,ord
        UNION ALL
        SELECT 1 as b,'כלל הארגון' As ColH,title,0 As Avg,Ord
        FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth=0 And CategoryID!=27) x
        order by b,ColH,ord desc
      </Query>
      <Params>
        <Param Name="@UserID" Repl="1" Prefix="a"/>
        <Param Name="@Services" Repl="3" Prefix="f" MustSelect="true"/>
        <Param Name="@Frames" Repl="1" Prefix="a" MustSelect="true"/>
        <Param Name="@Jobs" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  בכלל הארגון</Param>
        <Param Name="@RSurveyID" Repl="4"/>
      </Params>
      <Comment>ניתן להקליק על גרף של מימד, ולקבל דוח המציג את פירוט השאלות הכלולות במימד</Comment>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF">
      <Name>ממוצע הממדים במסגרת בהשוואה למסגרות דומות</Name>
      <Type>Bar</Type>
      <Query keyColumn="ארגון" pivotNameColumn="title" pivotValueColumn="Avgx" MinY="0" MaxY="5" LabelFormat="0.00;-0.00;" URL="SurveyAvg.aspx?Rep=ממוצע מפורט למימד במסגרת בהשוואה למסגרות דומות&amp;P=#ColHdr#&amp;J=#JobID#&amp;JN=#JobName#">
        Declare @SurveyID int
        SET @SurveyID = 4
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select ColH + Case b when 2 then @JobCnt Else '' End as ארגון,title,isnull(Avgx,0) as Avgx
        From
        (Select b,ColH,title,ROUND(AVG(Val),2) AS Avgx,ord From
        (SELECT CategoryID,title,ord FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth&gt;0) p
        LEFT OUTER JOIN (
        Select 1 As b,'מסגרות דומות ללא המסגרת שלך' As ColH,Avg(a.Val) As Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID And f.ServiceTypeID=(Select ServiceTypeID From FrameList Where FrameID=a.FrameID)
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_ProfilesA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        Where CategoryID IS NOT NULL And 2=2 And 3=3
        GROUP BY a.FormID * 10 + a.c,pa.CategoryID
        UNION ALL
        Select  2 As b,f.FrameName As ColH,Avg(a.Val) as Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_ProfilesA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where CategoryID IS NOT NULL And 1=1 And 2=2
        Group By a.FormID,pa.CategoryID,f.FrameName) k on p.CategoryID=k.CategoryID
        Group by b,ColH,title,ord
        UNION ALL
        SELECT 1 as b,'מסגרות דומות ללא המסגרת שלך' As ColH,title,0 As Avg,Ord
        FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth=0 And CategoryID!=27) x
        order by b,ColH,ord desc
      </Query>
      <Params>
        <Param Name="@FrameID" Repl="1" Prefix="a"/>
        <Param Name="@Jobs" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  במסגרות דומות</Param>
        <Param Name="@ExcludeFrameID" Prefix="a" Repl="3"/>
        <Param Name="@RSurveyID" Repl="4"/>
      </Params>
      <Comment>ניתן להקליק על גרף של מימד, ולקבל דוח המציג את פירוט השאלות הכלולות במימד</Comment>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys">
      <Name>ממוצע הממדים במסגרת בהשוואה למסגרות דומות</Name>
      <Type>Bar</Type>
      <Query keyColumn="ארגון" pivotNameColumn="title" pivotValueColumn="Avgx" MinY="0" MaxY="5" LabelFormat="0.00;-0.00;" URL="SurveyAvg.aspx?Rep=ממוצע מפורט למימד במסגרת בהשוואה למסגרות דומות&amp;P=#ColHdr#&amp;J=#JobID#&amp;JN=#JobName#&amp;F=#FrameID#&amp;FN=#FrameName#">
        Declare @SurveyID int
        SET @SurveyID = 4=4
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select ColH + Case b when 2 then @JobCnt Else '' End as ארגון,title,isnull(Avgx,0) as Avgx
        From
        (Select b,ColH,title,ROUND(AVG(Val),2) AS Avgx,ord From
        (SELECT CategoryID,title,ord FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth&gt;0) p
        LEFT OUTER JOIN (
        Select 1 As b,'מסגרות דומות ללא המסגרת שלך' As ColH,Avg(a.Val) As Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID And f.ServiceTypeID=(Select ServiceTypeID From FrameList Where FrameID=a.FrameID)
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_ProfilesA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        Where CategoryID IS NOT NULL And 2=2 And 3=3
        GROUP BY a.FormID * 10 + a.c,pa.CategoryID
        UNION ALL
        Select  2 As b,f.FrameName As ColH,Avg(a.Val) as Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_ProfilesA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where CategoryID IS NOT NULL And 1=1 And 2=2
        Group By a.FormID,pa.CategoryID,f.FrameName) k on p.CategoryID=k.CategoryID
        Group by b,ColH,title,ord
        UNION ALL
        SELECT 1 as b,'מסגרות דומות ללא המסגרת שלך' As ColH,title,0 As Avg,Ord
        FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth=0 And CategoryID!=27) x
        order by b,ColH,ord desc
      </Query>
      <Params>
        <Param Name="@UserID" Repl="1" Prefix="a"/>
        <Param Name="@Services" Repl="3" Prefix="f" MustSelect="true"/>
        <Param Name="@Frames" Repl="1" Prefix="a" MustSelect="true"/>
        <Param Name="@Jobs" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  במסגרות דומות</Param>
        <Param Name="@ExcludeFrameID" Prefix="a" Repl="3"/>
        <Param Name="@RSurveyID" Repl="4"/>
      </Params>
      <Comment>ניתן להקליק על גרף של מימד, ולקבל דוח המציג את פירוט השאלות הכלולות במימד</Comment>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF">
      <Name>פער מסגרת בהשוואה לכלל הארגון</Name>
      <Type>Bar</Type>
      <Query keyColumn="ארגון" pivotNameColumn="title" pivotValueColumn="diffx" LabelFormat="0.00;-0.00;">
        Declare @SurveyID int
        SET @SurveyID = 3=3
        Declare @FrameName as varchar(100)
        Select @FrameName=FrameName From FrameList a where 1=1
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select x.ColH + @JobCnt as ארגון,x.title,Round(isnull(x.Avgx,0)-isnull(y.Avgx,0),2) as diffx
        From
        (Select b,ColH,title,ROUND(AVG(Val),2) AS Avgx,ord,k.CategoryID From
        (SELECT CategoryID,title,ord FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth&gt;0) p
        LEFT OUTER JOIN (
        Select  2 As b,f.FrameName As ColH,Avg(a.Val) as Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_ProfilesA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where CategoryID IS NOT NULL And 1=1 And 2=2
        Group By a.FormID,pa.CategoryID,f.FrameName) k on p.CategoryID=k.CategoryID
        Group by b,ColH,title,ord,k.CategoryID) x
        LEFT OUTER JOIN
        (Select ColH as ארגון,title,isnull(Avgx,0) as Avgx,l.CategoryID
        From
        (Select b,ColH,title,ROUND(AVG(Val),2) AS Avgx,ord,k.CategoryID From
        (SELECT CategoryID,title,ord FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth&gt;0) p
        LEFT OUTER JOIN (
        Select 1 As b,@FrameName As ColH,Avg(a.Val) As Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_ProfilesA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        Where CategoryID IS NOT NULL And 2=2
        GROUP BY a.FormID * 10 + a.c,pa.CategoryID) k on p.CategoryID=k.CategoryID
        Group by b,ColH,title,ord,k.CategoryID) l) y on x.CategoryID=y.CategoryID
        Order by isnull(x.Avgx,0)-isnull(y.Avgx,0)
      </Query>
      <Params>
        <Param Name="@FrameID" Repl="1" Prefix="a"/>
        <Param Name="@Jobs" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  בכלל הארגון</Param>
        <Param Name="@RSurveyID" Repl="3"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys">
      <Name>פער מסגרת בהשוואה לכלל הארגון</Name>
      <Type>Bar</Type>
      <Query keyColumn="ארגון" pivotNameColumn="title" pivotValueColumn="diffx" LabelFormat="0.00;-0.00;">
        Declare @SurveyID int
        SET @SurveyID = 3=3
        Declare @FrameName as varchar(100)
        Select @FrameName=FrameName From FrameList a where 1=1
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select x.ColH + @JobCnt as ארגון,x.title,Round(isnull(x.Avgx,0)-isnull(y.Avgx,0),2) as diffx
        From
        (Select b,ColH,title,ROUND(AVG(Val),2) AS Avgx,ord,k.CategoryID From
        (SELECT CategoryID,title,ord FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth&gt;0) p
        LEFT OUTER JOIN (
        Select  2 As b,f.FrameName As ColH,Avg(a.Val) as Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_ProfilesA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where CategoryID IS NOT NULL And 1=1 And 2=2
        Group By a.FormID,pa.CategoryID,f.FrameName) k on p.CategoryID=k.CategoryID
        Group by b,ColH,title,ord,k.CategoryID) x
        LEFT OUTER JOIN
        (Select ColH as ארגון,title,isnull(Avgx,0) as Avgx,l.CategoryID
        From
        (Select b,ColH,title,ROUND(AVG(Val),2) AS Avgx,ord,k.CategoryID From
        (SELECT CategoryID,title,ord FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth&gt;0) p
        LEFT OUTER JOIN (
        Select 1 As b,@FrameName As ColH,Avg(a.Val) As Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_ProfilesA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        Where CategoryID IS NOT NULL And 2=2
        GROUP BY a.FormID * 10 + a.c,pa.CategoryID) k on p.CategoryID=k.CategoryID
        Group by b,ColH,title,ord,k.CategoryID) l) y on x.CategoryID=y.CategoryID
        Order by isnull(x.Avgx,0)-isnull(y.Avgx,0)
      </Query>
      <Params>
        <Param Name="@UserID" Repl="1" Prefix="a"/>
        <Param Name="@Services" Repl="9" Prefix="f" MustSelect="true"/>
        <Param Name="@Frames" Repl="1" Prefix="a" MustSelect="true"/>
        <Param Name="@Jobs" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  בכלל הארגון</Param>
        <Param Name="@RSurveyID" Repl="3"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF">
      <Name>פער מסגרת בהשוואה למסגרות דומות</Name>
      <Type>Bar</Type>
      <Query keyColumn="ארגון" pivotNameColumn="title" pivotValueColumn="diffx" LabelFormat="0.00;-0.00;">
        Declare @SurveyID int
        SET @SurveyID = 4=4
        Declare @FrameName as varchar(100)
        Select @FrameName=FrameName From FrameList a where 1=1
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select x.ColH + @JobCnt as ארגון,x.title,Round(isnull(x.Avgx,0)-isnull(y.Avgx,0),2) as diffx
        From
        (Select b,ColH,title,ROUND(AVG(Val),2) AS Avgx,ord,k.CategoryID From
        (SELECT CategoryID,title,ord FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth&gt;0) p
        LEFT OUTER JOIN (
        Select  2 As b,f.FrameName As ColH,Avg(a.Val) as Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_ProfilesA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where CategoryID IS NOT NULL And 1=1 And 2=2
        Group By a.FormID,pa.CategoryID,f.FrameName) k on p.CategoryID=k.CategoryID
        Group by b,ColH,title,ord,k.CategoryID) x
        LEFT OUTER JOIN
        (Select ColH as ארגון,title,isnull(Avgx,0) as Avgx,l.CategoryID
        From
        (Select b,ColH,title,ROUND(AVG(Val),2) AS Avgx,ord,k.CategoryID From
        (SELECT CategoryID,title,ord FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth&gt;0) p
        LEFT OUTER JOIN (
        Select 1 As b,@FrameName As ColH,Avg(a.Val) As Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID And f.ServiceTypeID=(Select ServiceTypeID From FrameList Where FrameID=a.FrameID)
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_ProfilesA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        Where CategoryID IS NOT NULL And 2=2 And 3=3
        GROUP BY a.FormID * 10 + a.c,pa.CategoryID) k on p.CategoryID=k.CategoryID
        Group by b,ColH,title,ord,k.CategoryID) l) y on x.CategoryID=y.CategoryID
        Order by isnull(x.Avgx,0)-isnull(y.Avgx,0)
      </Query>
      <Params>
        <Param Name="@FrameID" Repl="1" Prefix="a"/>
        <Param Name="@Jobs" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  במסגרות דומות</Param>
        <Param Name="@ExcludeFrameID" Prefix="a" Repl="3"/>
        <Param Name="@RSurveyID" Repl="4"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys">
      <Name>פער מסגרת בהשוואה למסגרות דומות</Name>
      <Type>Bar</Type>
      <Query keyColumn="ארגון" pivotNameColumn="title" pivotValueColumn="diffx" LabelFormat="0.00;-0.00;">
        Declare @SurveyID int
        SET @SurveyID = 4=4
        Declare @FrameName as varchar(100)
        Select @FrameName=FrameName From FrameList a where 1=1
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select x.ColH + @JobCnt as ארגון,x.title,Round(isnull(x.Avgx,0)-isnull(y.Avgx,0),2) as diffx
        From
        (Select b,ColH,title,ROUND(AVG(Val),2) AS Avgx,ord,k.CategoryID From
        (SELECT CategoryID,title,ord FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth&gt;0) p
        LEFT OUTER JOIN (
        Select  2 As b,f.FrameName As ColH,Avg(a.Val) as Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_ProfilesA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        Where CategoryID IS NOT NULL And 1=1 And 2=2
        Group By a.FormID,pa.CategoryID,f.FrameName) k on p.CategoryID=k.CategoryID
        Group by b,ColH,title,ord,k.CategoryID) x
        LEFT OUTER JOIN
        (Select ColH as ארגון,title,isnull(Avgx,0) as Avgx,l.CategoryID
        From
        (Select b,ColH,title,ROUND(AVG(Val),2) AS Avgx,ord,k.CategoryID From
        (SELECT CategoryID,title,ord FROM SV_Survey_Profiles Where SurveyID=2 And SubGroup=2 And Depth&gt;0) p
        LEFT OUTER JOIN (
        Select 1 As b,@FrameName As ColH,Avg(a.Val) As Val,pa.CategoryID
        From vSurvey_Answers_8 a
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID And f.ServiceTypeID=(Select ServiceTypeID From FrameList Where FrameID=a.FrameID)
        LEFT OUTER JOIN (SELECT CategoryID,QuestionID From SV_Survey_ProfilesA Where SurveyID=@SurveyID) pa on pa.QuestionID=a.QuestionID
        Where CategoryID IS NOT NULL And 2=2 And 3=3
        GROUP BY a.FormID * 10 + a.c,pa.CategoryID) k on p.CategoryID=k.CategoryID
        Group by b,ColH,title,ord,k.CategoryID) l) y on x.CategoryID=y.CategoryID
        Order by isnull(x.Avgx,0)-isnull(y.Avgx,0)
      </Query>
      <Params>
        <Param Name="@UserID" Repl="1" Prefix="a"/>
        <Param Name="@Services" Repl="9" Prefix="f" MustSelect="true"/>
        <Param Name="@Frames" Repl="1" Prefix="a" MustSelect="true"/>
        <Param Name="@Jobs" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  במסגרות דומות</Param>
        <Param Name="@ExcludeFrameID" Prefix="a" Repl="3"/>
        <Param Name="@RSurveyID" Repl="3"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF" Visible="false">
      <Name>ממוצע מפורט למימד במסגרת בהשוואה לכלל הארגון</Name>
      <Type>Bar</Type>
      <Query keyColumn="ארגון" pivotNameColumn="Question" pivotValueColumn="Avgx" MinY="0" MaxY="5" LabelFormat="0.00;-0.00;">
        Declare @SurveyID int
        SET @SurveyID = 4=4
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select ColH + Case b when 2 then @JobCnt Else '' End As ארגון,Question, Avgx
        From(
        Select b,ColH,Question,Avgx,1 as Ord
        From
        (Select b,ColH,Question,Round(AvG(cast(Val As Float)),2) as Avgx
        From
        (Select 1 as b,'כלל הארגון' As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From (SELECT * FROM vSurvey_Answers_8 Where 3=3 And 2=2) a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        UNION ALL
        Select  2 as b,f.FrameName As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From (SELECT * FROM vSurvey_Answers_8 Where 3=3 And 1=1 And 2=2) a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        ) k
        Group by ColH,Question,b) x) y
        Order By b,Ord,Avgx
      </Query>
      <Params>
        <Param Name="@FrameID" Repl="1"/>
        <Param Name="@Profilen" Repl="3"/>
        <Param Name="@JobQ" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  בכלל הארגון</Param>
        <Param Name="@RSurveyID" Repl="4"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys" Visible="false">
      <Name>ממוצע מפורט למימד במסגרת בהשוואה לכלל הארגון</Name>
      <Type>Bar</Type>
      <Query keyColumn="ארגון" pivotNameColumn="Question" pivotValueColumn="Avgx" MinY="0" MaxY="5" LabelFormat="0.00;-0.00;">
        Declare @SurveyID int
        SET @SurveyID = 4=4
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select ColH + Case b when 2 then @JobCnt Else '' End As ארגון,Question, Avgx
        From(
        Select b,ColH,Question,Avgx,1 as Ord
        From
        (Select b,ColH,Question,Round(AvG(cast(Val As Float)),2) as Avgx
        From
        (Select 1 as b,'כלל הארגון' As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From (SELECT * FROM vSurvey_Answers_8 Where 3=3 And 2=2) a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        UNION ALL
        Select  2 as b,f.FrameName As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From (SELECT * FROM vSurvey_Answers_8 Where 3=3 And 1=1 And 2=2) a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        ) k
        Group by ColH,Question,b) x) y
        Order By b,Ord,Avgx
      </Query>
      <Params>
        <Param Name="@FrameQ" Repl="1"/>
        <Param Name="@Profilen" Repl="3"/>
        <Param Name="@JobQ" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  בכלל הארגון</Param>
        <Param Name="@RSurveyID" Repl="4"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF" Visible="false">
      <Name>ממוצע מפורט למימד במסגרת בהשוואה למסגרות דומות</Name>
      <Type>Bar</Type>
      <Query keyColumn="ארגון" pivotNameColumn="Question" pivotValueColumn="Avgx" MinY="0" MaxY="5" LabelFormat="0.00;-0.00;">
        Declare @SurveyID int
        SET @SurveyID = 5=5
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select ColH + Case b when 2 then @JobCnt Else '' End As ארגון,Question, Avgx
        From(
        Select b,ColH,Question,Avgx,1 as Ord
        From
        (Select b,ColH,Question,Round(AvG(cast(Val As Float)),2) as Avgx
        From
        (Select 1 as b,'מסגרות דומות ללא המסגרת שלך' As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From (SELECT * FROM  vSurvey_Answers_8 Where 3=3 And 2=2 And 4=4) a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID And f.ServiceTypeID=(Select ServiceTypeID From FrameList Where FrameID=a.FrameID)
        UNION ALL
        Select  2 as b,f.FrameName As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From (SELECT * FROM vSurvey_Answers_8 Where 3=3 And 1=1 And 2=2) a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        ) k
        Group by ColH,Question,b) x) y
        Order By b,Ord,Avgx
      </Query>
      <Params>
        <Param Name="@FrameID" Repl="1"/>
        <Param Name="@Profilen" Repl="3"/>
        <Param Name="@JobQ" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  במסגרות דומות</Param>
        <Param Name="@ExcludeFrameID" Repl="4"/>
        <Param Name="@RSurveyID" Repl="5"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys" Visible="false">
      <Name>ממוצע מפורט למימד במסגרת בהשוואה למסגרות דומות</Name>
      <Type>Bar</Type>
      <Query keyColumn="ארגון" pivotNameColumn="Question" pivotValueColumn="Avgx" MinY="0" MaxY="5" LabelFormat="0.00;-0.00;">
        Declare @SurveyID int
        SET @SurveyID = 5=5
        Declare @JobCnt as varchar(100)
        Select @JobCnt=Case Count(Distinct JobID) When 1 then ' - ' + Cast(Count(Distinct FormID) As Varchar(5)) + ' משיבים' Else '' End From vSurvey_Answers_8 a where 1=1 And 2=2
        Select ColH + Case b when 2 then @JobCnt Else '' End As ארגון,Question, Avgx
        From(
        Select b,ColH,Question,Avgx,1 as Ord
        From
        (Select b,ColH,Question,Round(AvG(cast(Val As Float)),2) as Avgx
        From
        (Select 1 as b,'מסגרות דומות ללא המסגרת שלך' As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From (SELECT * FROM vSurvey_Answers_8 Where 3=3 And 2=2 And 4=4) a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID And f.ServiceTypeID=(Select ServiceTypeID From FrameList Where FrameID=a.FrameID)
        UNION ALL
        Select  2 as b,f.FrameName As ColH,[Question],a.Val,NULL As FrameID,a.JobID
        From (SELECT * FROM vSurvey_Answers_8 Where 3=3 And 1=1 And 2=2) a
        LEFT OUTER JOIN (Select QuestionID,Replace(Question,'<br />','') As Question
        From [SV_SurQuestions] Where SurveyID=@SurveyID) q on Q.QuestionID=a.QuestionID
        LEFT OUTER JOIN FrameList f on f.FrameID=a.FrameID
        ) k
        Group by ColH,Question,b) x) y
        Order By b,Ord,Avgx
      </Query>
      <Params>
        <Param Name="@FrameQ" Repl="1"/>
        <Param Name="@Profilen" Repl="3"/>
        <Param Name="@JobQ" Repl="2">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  במסגרות דומות</Param>
        <Param Name="@ExcludeFrameID" Repl="4"/>
        <Param Name="@RSurveyID" Repl="5"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF">
      <Name>שביעות רצון כללית – לפי מסגרות</Name>
      <Type>Img</Type>
      <Query>
        Declare @SurveyID int
        SET @SurveyID = 2=2
        Select FrameID,FileName
        From
        (SELECT [projectID]
        ,[SlideNumber]
        ,[SurveyID]
        ,d.[ServiceID]
        ,f.[FrameID]
        ,[description]
        ,[filename]
        FROM [SV_DispImages] d
        left Outer join FrameList f on f.ServiceID=d.ServiceID
        Where ProjectID=1  And
        SurveyID=@SurveyID AND f.FrameID = 1=1) x
      </Query>
      <Params>
        <Param Name="@Frames" Repl="1" Type="N"/>
        <Param Name="@RSurveyID" Repl="2"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF">
      <Name>ממוצע הממדים לפי מסגרת</Name>
      <Type>Img</Type>
      <Query>
        Declare @SurveyID int
        SET @SurveyID = 2=2
        Select FrameID,FileName
        From
        (SELECT [projectID]
        ,[SlideNumber]
        ,[SurveyID]
        ,d.[ServiceID]
        ,f.[FrameID]
        ,[description]
        ,[filename]
        FROM [SV_DispImages] d
        left Outer join FrameList f on f.ServiceID=d.ServiceID
        Where ProjectID=2  And
        SurveyID=@SurveyID AND f.FrameID = 1=1) x
      </Query>
      <Params>
        <Param Name="@Frames" Repl="1" Type="N"/>
        <Param Name="@RSurveyID" Repl="2"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr,SurveysF,Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>רשימת הטקסטים החופשיים במסגרת: מה הנך מעריך בבית אקשטיין</Name>
      <Type>URL</Type>
      <Query>
        SurveyTexts.aspx?q=62&amp;sb=2&amp;sg=1=1&amp;T=2=2&amp;r=רשימת הטקסטים החופשיים: מה הנך מעריך בבית אקשטיין&amp;s=3=3
      </Query>
      <Params>
        <Param Name="@RSurveyID" Repl="3" Conc=""/>
        <Param Name="@SurveyGroupID" Repl="1" Conc=""/>
        <Param Name="@SurveyGroupName" Repl="2" Conc=""/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr,SurveysF,Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>רשימת הטקסטים החופשיים במסגרת: מה היית מציע לשנות/לשפר</Name>
      <Type>URL</Type>
      <Query>
        SurveyTexts.aspx?q=63&amp;sb=2&amp;sg=1=1&amp;T=2=2&amp;r=שימת הטקסטים החופשיים: מה היית מציע לשנות/לשפר&amp;s=3=3
      </Query>
      <Params>
        <Param Name="@RSurveyID" Repl="3" Conc=""/>
        <Param Name="@SurveyGroupID" Repl="1" Conc=""/>
        <Param Name="@SurveyGroupName" Repl="2" Conc=""/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr,SurveysF,Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>הטקסט המלא של שאלות הסקר</Name>
      <Type>URL</Type>
      <Query>
        SurveyQuestionpopup.aspx?s=1=1&amp;g=2
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
  </Charts>
  <Charts SurveyGroupID="2" SubGroup="3" ConnectionString="Book10VPS">
    <OrganizationalData>
      <Avg AvgType="1"></Avg>
      <Avg AvgType="2"></Avg>
    </OrganizationalData>
    <SelectionControls>
      <Control ID="DSServices" Type="sql" Scontrol="DDLServices">
        Select ServiceName,ServiceID
        From
        (SELECT ServiceName, ServiceID
        FROM ServiceList
        Where Serviceid in (1,2,3,4,8) And ServiceID in (Select Distinct ServiceID
        From FrameList
        Where FrameID in (Select FrameID
        From dbo.p0v_UserFrameList
        Where UserID=@UserID))) x
        ORDER BY ServiceID
      </Control>
      <Control ID="DSFrames" Type="sql" Scontrol="DDLFrames" SurveyID="12">
        SELECT FrameID,FrameName
        FROM SV_vSurvey_Frames
        Where SurveyID=12 AND ServiceID=ISNULL(@ServiceID,0) AND ((FrameID IN (SELECT FrameID FROM dbo.p0v_UserFrameList WHERE UserID = @UserID)) OR (FrameID&gt;9999))
        Order by ISNULL(ord,0)
        <!--SELECT f.FrameName, f.FrameID, @UserID As UserID, f.ServiceID
        FROM FrameList f
        WHERE f.FrameID not in(14,23) And f.FrameID in (Select FrameID
        From dbo.p0v_UserFrameList
        Where (UserID=@UserID)) And (f.ServiceID=ISNULL(@ServiceID,ServiceID))-->
      </Control>
      <Control ID="DSProfiles" Type="sql" Scontrol="DDLProfiles">
        Select * From SV_Survey_Profiles Where Root=27
      </Control>
      <Control ID="DSJob" Type="sql" Scontrol="DDLJob">
        SELECT 0 AS ID, 'כל התפקידים' AS [AnswerText]
        UNION ALL
        SELECT [ID], [AnswerText]
        FROM dbo.SV_fnSelectionList(@SurveyID,'JobID',1)
        Where ExcludeFromList = 0 AND ID in (Select DISTINCT JobID FROM dbo.SV_fnAnswers_2(@SurveyID,2,Coalesce(@FrameID,@FrameIDD,999999),NULL,NULL,NULL) GROUP BY JobID Having COUNT(JobID)&gt;1)
      </Control>
    </SelectionControls>
    <Criterions>
      <Criterion Name="@Services">(Prefix.ServiceID=@Services)</Criterion>
      <Criterion Name="@Frames">(Prefix.FrameID=@Frames)</Criterion>
      <Criterion Name="@SEN">(Prefix.SenID=@Sen)</Criterion>
      <Criterion Name="@Age">(Prefix.AgeID=@Age)</Criterion>
      <Criterion Name="@Gender">(Prefix.GenderID=@Gender)</Criterion>
      <Criterion Name="@Jobs">(Prefix.JobID=@Jobs)</Criterion>
      <Criterion Name="@Profiles">((isnull(פרופיל_1,'') = ISNULL(@Profile_1,פרופיל_1)) And (isnull(פרופיל_2,'') = ISNULL(@Profile_2,isnull(פרופיל_2,''))) And (isnull(פרופיל_3,'') = ISNULL(@Profile_3,isnull(פרופיל_3,''))))</Criterion>
      <Criterion Name="@Questions">שאלה in @Questions</Criterion>
      <Criterion Name="@UserID">Prefix.FrameID in (select frameid from dbo.p0v_UserFrameList where userid=@UserID)</Criterion>
      <Criterion Name="@FrameID">ISNULL(Prefix.FrameID,@FrameID)=@FrameID</Criterion>
      <Criterion Name="@Profilen">
        Prefix.QuestionID in (SELECT QuestionID
        FROM SV_Survey_PRofileSA
        Where SurveyID=@SurveyID And CategoryID=(Select CategoryID From SV_Survey_Profiles Where title=@Profilen And SurveyID=@SurveyID))
      </Criterion>
      <Criterion Name="@ExcludeFrameID">Prefix.FrameID!=@ExcludeFrameID</Criterion>
      <Criterion Name="@SurveyGroupID">@SurveyGroupID</Criterion>
      <Criterion Name="@SurveyGroupName">@SurveyGroupName</Criterion>
      <Criterion Name="@JobQ">(Prefix.JobID=@JobQ)</Criterion>
      <Criterion Name="@FrameQ">(Prefix.FrameID=@FrameQ)</Criterion>
      <Criterion Name="@SurveyID">(SurveyID=@SurveyID)</Criterion>
      <Criterion Name="@RSurveyID">@RSurveyID</Criterion>
    </Criterions>
    <Chart UserGroups="Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>******* מצגת ארגונית/אזור **********************</Name>
      <Type></Type>
      <Query>
        SELECT 1
      </Query>
      <Params></Params>
    </Chart>
    <Chart UserGroups="Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>מצגת ארגונית</Name>
      <Type>PPT</Type>
      <Query>
        Select URL From SV_PPTList p WHERE SurveyID=1=1 And ServiceID iS NULL
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>מצגת חטיבה טיפולית</Name>
      <Type>PPT</Type>
      <Query>
        Select URL From SV_PPTList p WHERE SurveyID=1=1 And ServiceID=1
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>מצגת אזור צפון</Name>
      <Type>PPT</Type>
      <Query>
        Select URL From SV_PPTList p WHERE SurveyID=1=1 And ServiceID=2
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>מצגת אזור שרון</Name>
      <Type>PPT</Type>
      <Query>
        Select URL From SV_PPTList p WHERE SurveyID=1=1 And ServiceID=3
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>מצגת אזור מרכז/דרום</Name>
      <Type>PPT</Type>
      <Query>
        Select URL From SV_PPTList p WHERE SurveyID=1=1 And ServiceID=4
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>מצגת מטה</Name>
      <Type>PPT</Type>
      <Query>
        Select URL From SV_PPTList p WHERE SurveyID=1=1 And ServiceID=8
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>-------------------------------------------------------------</Name>
      <Type></Type>
      <Query>
        SELECT 2
      </Query>
      <Params></Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys">
      <Name>אחוז מענה למסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="sDesc" pivotNameColumn="ORG" pivotValueColumn="prc" AdditionalHeaderTextColumn="cnt" MinY="0" MaxY="100">
        <!--SELECT sDesc,Org,prc,cnt FROM (
        SELECT 1 AS ord,sDesc,Org,prc,cnt FROM dbo.SV_fnCount(2=2,1,NULL,NULL,'עובדים',NULL)
        UNION ALL
        SELECT 2 AS ord,sDesc,'_' AS Org,prc,cnt FROM dbo.SV_fnCount(2=2,0,NULL,NULL,NULL,NULL)
        UNION ALL
        SELECT 3 as ord,sDesc,Org,prc,cnt FROM dbo.SV_fnCount(2=2,2,NULL,NULL,'עובדים',NULL)
        UNION ALL
        SELECT 4 AS ord,sDesc,'__' AS Org,prc,cnt FROM dbo.SV_fnCount(2=2,0,NULL,NULL,NULL,NULL)
        UNION ALL
        SELECT 5 as ord,sDesc,Org,prc,cnt FROM dbo.SV_fnCount(2=2,3,3=3,4=4,'עובדים',1=1)) x
        order by ord,sDesc Desc,prc-->
        SELECT ROUND(CAST(Acnt AS float)/CAST(cnt AS float) * 100,0) As prc,sDesc,Org,CASE sDesc WHEN 2011 THEN NULL ELSE CASE acnt WHEN 1 THEN 'משיב אחד מתוך '  ELSE CAST(acnt as varchar(5)) + ' משיבים מתוך ' END + CAST(cnt AS varchar(5)) + ' עובדים' END AS cnt
        FROM (
        SELECT 10 as b,2012 as sDesc,FrameName AS ORG, CASE WHEN f.Acnt IS NULL THEN (SELECT COUNT(Distinct FormID) c FROM SV_CLosedSurveys_2 WHERE 4=4 AND SurveyID=12) ELSE Acnt END AS Acnt,CNT
        FROM SV_vSurvey_Frames f
        WHERE SurveyID=12 AND 4=4
        UNION ALL
        SELECT 10 as b,2011 as sDesc,FrameName AS ORG, CASE WHEN f.Acnt IS NULL THEN (SELECT COUNT(Distinct FormID) c FROM SV_CLosedSurveys_2 WHERE 4=4 AND SurveyID=8) ELSE Acnt END AS Acnt,CNT
        FROM SV_vSurvey_Frames f
        WHERE SurveyID=8 AND 4=4

        UNION ALL

        SELECT 9 AS b, 2012 as sDesc, '-'  AS ORG,NULL as Acnt,NULL AS cnt
        UNION ALL
        SELECT 9 AS b, 2011 as sDesc, '-'  AS ORG,NULL as Acnt,NULL AS cnt

        UNION ALL

        select 8 AS  b,SHortDescription AS sDesc,ServiceName, Acnt,Cnt
        FROm SV_CorrectCount c
        LEFT OUTER JOIN SV_Surveys s ON s.SurveyID=c.SurveyID
        LEFT OUTER JOIN ServiceList l ON l.ServiceID=c.ServiceID
        WHERE c.ServiceID!=0

        UNION ALL

        SELECT 7 AS b, 2012 as sDesc, '--'  AS ORG,NULL as Acnt,NULL AS cnt
        UNION ALL
        SELECT 7 AS b, 2011 as sDesc, '--'  AS ORG,NULL as Acnt,NULL AS cnt
        UNION ALL

        select 6 AS  b,SHortDescription AS sDesc,'ארגון' As ServiceName, Acnt,Cnt
        FROm SV_CorrectCount c
        LEFT OUTER JOIN SV_Surveys s ON s.SurveyID=c.SurveyID
        WHERE c.ServiceID = 0
        ) a
        ORDER BY b,sDesc Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="9"/>
        <Param Name="@Frames" Repl="4"/>
        <Param Name="@RSurveyID" Repl="2" Type="N"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF">
      <Name>אחוז מענה</Name>
      <Type>Column</Type>
      <Query keyColumn="sDesc" pivotNameColumn="ORG" pivotValueColumn="prc" AdditionalHeaderTextColumn="cnt" MinY="0" MaxY="100">
        SELECT ROUND(CAST(Acnt AS float)/CAST(cnt AS float) * 100,0) As prc,sDesc,Org,CASE acnt WHEN 1 THEN 'משיב אחד מתוך '  ELSE CAST(acnt as varchar(5)) + ' משיבים מתוך ' END + CAST(cnt AS varchar(5)) + ' עובדים' AS cnt
        FROM (
        SELECT 10 as b,2012 as sDesc,FrameName AS ORG, CASE WHEN f.Acnt IS NULL THEN (SELECT COUNT(Distinct FormID) c FROM SV_CLosedSurveys_2 WHERE 4=4 AND SurveyID=12) ELSE Acnt END AS Acnt,CNT
        FROM SV_vSurvey_Frames f
        WHERE SurveyID=12 AND 4=4
        UNION ALL
        SELECT 10 as b,2011 as sDesc,FrameName AS ORG, CASE WHEN f.Acnt IS NULL THEN (SELECT COUNT(Distinct FormID) c FROM SV_CLosedSurveys_2 WHERE 4=4 AND SurveyID=8) ELSE Acnt END AS Acnt,CNT
        FROM SV_vSurvey_Frames f
        WHERE SurveyID=8 AND 4=4
        UNION ALL

        SELECT 9 AS b, 2012 as sDesc, '-'  AS ORG,NULL as Acnt,NULL AS cnt
        UNION ALL
        SELECT 9 AS b, 2011 as sDesc, '-'  AS ORG,NULL as Acnt,NULL AS cnt
        UNION ALL

        select 8 AS  b,SHortDescription AS sDesc,ServiceName, Acnt,Cnt
        FROm SV_CorrectCount c
        LEFT OUTER JOIN SV_Surveys s ON s.SurveyID=c.SurveyID
        LEFT OUTER JOIN ServiceList l ON l.ServiceID=c.ServiceID
        WHERE c.ServiceID!=0

        UNION ALL

        SELECT 7 AS b, 2012 as sDesc, '--'  AS ORG,NULL as Acnt,NULL AS cnt
        UNION ALL
        SELECT 7 AS b, 2011 as sDesc, '--'  AS ORG,NULL as Acnt,NULL AS cnt

        UNION ALL

        select 6 AS  b,SHortDescription AS sDesc,'ארגון' As ServiceName, Acnt,Cnt
        FROm SV_CorrectCount c
        LEFT OUTER JOIN SV_Surveys s ON s.SurveyID=c.SurveyID
        WHERE c.ServiceID = 0
        ) a
        ORDER BY b,sDesc Desc
      </Query>
      <Params>
        <Param Name="@UserID" Repl="4"/>
        <Param Name="@RSurveyID" Repl="2" Type="N"/>
      </Params>
    </Chart>
    <Chart UserGroups="fmngr">
      <Name>מצגת אזורית</Name>
      <Type>PPT</Type>
      <Query>
        Select URL from SV_PPTList Where SurveyID=2=2 And ServiceID=(Select ServiceID From FrameList Where 1=1)
      </Query>
      <Params>
        <Param Name="@FrameID"/>
        <Param Name="@RSurveyID" Repl="2"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT">
      <Name>מצגת אזורית</Name>
      <Type>PPT</Type>
      <Query>
        Select URL from SV_PPTList WHERE SurveyID=2=2 And 1=1
      </Query>
      <Params>
        <Param Name="@Services" Repl="1" MustSelect="true"/>
        <Param Name="@RSurveyID" Repl="2"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys,fmngr">
      <Name>-------------------------------------------------------------</Name>
      <Type></Type>
      <Query>
        SELECT 12
      </Query>
      <Params></Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys,fmngr">
      <Name>******* ניתוח המחויבות הארגונית במסגרת *******</Name>
      <Type></Type>
      <Query>
        SELECT 3
      </Query>
      <Params></Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,fmngr">
      <Name>ניתוח של המחויבות הארגונית במסגרת בהשוואה לכלל הארגון</Name>
      <Type>Column</Type>
      <Query keyColumn="sDesc" pivotNameColumn="Question" pivotValueColumn="Avgx" LabelFormat="0.00;-0.00;" MinY="0" MaxY="5">
        DECLARE @SurveyID int
        SET @SurveyID = 1=1

        DECLARE @CNT int
        DECLARE @CNTT varchar(12)

        SELECT @CNT = COUNT(DISTINCT FormID)
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL)
        WHERE QuestionID between 37 AND 42 AND Val IS NOT NULL AND 3=3
        SET @CNTT = CASE WHEN ISNULL(@CNT,0) &lt; 5 THEN '' ELSE ' - ' + CAST(@CNT AS varchar(5)) + ' משיבים' END

        SELECT CASE b WHEN 3 THEN 'כלל הארגון' ELSE sDesc  END As sDesc,QUestion,ROUND(AVG(CAST(Val AS float)),2) as Avgx
        FROM (
        SELECT QuestionID * 10 ORD, 1 AS b,sDesc + @CNTT AS sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL)
        WHERE QuestionID between 37 AND 42 AND Val IS NOT NULL AND 3=3
        UNION ALL
        SELECT QuestionID * 10 ORD, 2 AS b,sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,3,2=2,NULL,NULL,NULL)
        WHERE QuestionID between 37 AND 42 AND Val IS NOT NULL AND 3=3
        UNION ALL
        SELECT QuestionID * 10 ORD, 3 AS b,sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,NULL,NULL,NULL,NULL)
        WHERE QuestionID between 37 AND 42 AND Val IS NOT NULL AND 3=3
        UNION ALL
        SELECT 375 As ORD,1 AS b,sDesc + @CNTT AS sDesc,NULL As QuestionID,NULL AS Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,4,NULL,NULL,NULL,NULL)
        UNION ALL
        SELECT 375 As ORD,1 AS b,sDesc,NULL As QuestionID,NULL AS Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,5,NULL,NULL,NULL,NULL)
        ) a
        LEFT OUTER JOIN (SELECT QuestionID,Question FROM SV_SurQuestions WHERE SurveyID=@SurveyID) q ON q.QuestionID = a.QuestionID
        GROUP BY sDesc,b,question,ord
        ORDER BY Ord DESC,b
      </Query>
      <Params>
        <Param Name="@Services" Repl="9"/>
        <Param Name="@Frames" Repl="2" Type="N"/>
        <Param Name="@Jobs" Repl="3">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  בכלל הארגון</Param>
        <Param Name="@Sen" Repl="3"></Param>
        <Param Name="@Gender" Repl="3"></Param>
        <Param Name="@RSurveyID" Repl="1"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys,fmngr">
      <Name>ניתוח של המחויבות הארגונית במסגרת בהשוואה למסגרות דומות</Name>
      <Type>Column</Type>
      <Query keyColumn="sDesc" pivotNameColumn="Question" pivotValueColumn="Avgx" LabelFormat="0.00;-0.00;" MinY="0" MaxY="5">
        DECLARE @SurveyID int
        DECLARE @ST int
        SET @SurveyID = 1=1
        SELECT @ST = ServiceTypeID FROM FrameList WHERE FrameID = 2=2

        DECLARE @CNT int
        DECLARE @CNTT varchar(12)

        SELECT @CNT = COUNT(DISTINCT FormID)
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL)
        WHERE QuestionID between 37 AND 42 AND Val IS NOT NULL AND 3=3
        SET @CNTT = CASE WHEN ISNULL(@CNT,0) &lt; 5 THEN '' ELSE ' - ' + CAST(@CNT AS varchar(5)) + ' משיבים' END

        SELECT CASE b WHEN 3 THEN 'מסגרות דומות ללא המסגרת שלך' ELSE sDesc END As sDesc,QUestion,ROUND(AVG(CAST(Val AS float)),2) as Avgx
        FROM (
        SELECT QuestionID * 10 ORD, 1 AS b,sDesc + @CNTT AS sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL)
        WHERE QuestionID between 37 AND 42 AND Val IS NOT NULL AND 3=3
        UNION ALL
        SELECT QuestionID * 10 ORD, 2 AS b,sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,3,2=2,NULL,NULL,NULL)
        WHERE QuestionID between 37 AND 42 AND Val IS NOT NULL AND 3=3
        UNION ALL
        SELECT QuestionID * 10 ORD, 3 AS b,sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,-2=2,@ST,NULL,NULL)
        WHERE QuestionID between 37 AND 42 AND Val IS NOT NULL AND 3=3
        UNION ALL
        SELECT 375 As ORD,1 AS b,sDesc + @CNTT AS sDesc,NULL As QuestionID,NULL AS Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,4,NULL,NULL,NULL,NULL)
        UNION ALL
        SELECT 375 As ORD,1 AS b,sDesc,NULL As QuestionID,NULL AS Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,5,NULL,NULL,NULL,NULL)
        ) a
        LEFT OUTER JOIN (SELECT QuestionID,Question FROM SV_SurQuestions WHERE SurveyID=@SurveyID) q ON q.QuestionID = a.QuestionID
        GROUP BY sDesc,b,question,ord
        ORDER BY Ord DESC,b
      </Query>
      <Params>
        <Param Name="@Services" Repl="9"/>
        <Param Name="@Frames" Repl="2" Type="N"/>
        <Param Name="@Jobs" Repl="3">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  במסגרות דומות</Param>
        <Param Name="@Sen" Repl="3"></Param>
        <Param Name="@Gender" Repl="3"></Param>
        <Param Name="@RSurveyID" Repl="1"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys,fmngr">
      <Name>-------------------------------------------------------------</Name>
      <Type></Type>
      <Query>
        SELECT 16
      </Query>
      <Params></Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys,fmngr">
      <Name>******* ממוצע תשובות הסקר *********************</Name>
      <Type></Type>
      <Query>
        SELECT 4
      </Query>
      <Params></Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys,fmngr">
      <Name>ממוצע התשובות במסגרת בהשוואה לכלל הארגון</Name>
      <Type>Bar</Type>
      <Query keyColumn="sDesc" pivotNameColumn="title" pivotValueColumn="Avgx" MinY="0" MaxY="5" LabelFormat="0.00;-0.00;" URL="SurveyAvg.aspx?Rep=ממוצע מפורט למימד במסגרת בהשוואה לכלל הארגון&amp;P=#ColHdr#&amp;J=#JobID#&amp;JN=#JobName#&amp;F=#FrameID#&amp;FN=#FrameName#">
        DECLARE @SurveyID int
        SET @SurveyID = 1=1

        DECLARE @CNT int
        DECLARE @CNTT varchar(12)

        SELECT @CNT = COUNT(DISTINCT FormID)
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL)
        WHERE Val IS NOT NULL AND 3=3
        SET @CNTT = CASE WHEN ISNULL(@CNT,0) &lt; 5 THEN '' ELSE ' - ' + CAST(@CNT AS varchar(5)) + ' משיבים' END

        SELECT CASE b WHEN 3 THEN 'כלל הארגון' ELSE sDesc END As sDesc,p.title,ROUND(AVG(CAST(Val AS float)),2) as Avgx
        FROM (SELECT CategoryID,title,Ord FROM SV_Survey_Profiles p WHERE SurveyID=@SurveyID AND ParentID!=0) p
        LEFT OUTER JOIN (SELECT QuestionID,CategoryID FROM SV_Survey_PRofileSA WHERE SurveyID=@SurveyID) c On p.CategoryID=c.CategoryID
        LEFT OUTER JOIN (
        SELECT 1 AS b,sDesc + @CNTT AS sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL)
        WHERE Val IS NOT NULL AND 3=3
        <!--UNION ALL
        SELECT 2 AS b,sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,3,2=2)
        WHERE Val IS NOT NULL AND 3=3-->
        UNION ALL
        SELECT 3 AS b,sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,NULL,NULL,NULL,NULL)
        WHERE Val IS NOT NULL AND 3=3
        ) a ON c.QuestionID = a.QuestionID
        GROUP BY sDesc,b,title,ord
        ORDER BY Ord DESC,b
      </Query>
      <Params>
        <Param Name="@Services" Repl="9" MustSelect="true"/>
        <Param Name="@Frames" Repl="2" Type="N" MustSelect="true"/>
        <Param Name="@Jobs" Repl="3">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  בכלל הארגון</Param>
        <Param Name="@RSurveyID" Repl="1"/>
      </Params>
      <Comment>ניתן להקליק על גרף של מימד, ולקבל דוח המציג את פירוט השאלות הכלולות במימד</Comment>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys,fmngr">
      <Name>ממוצע התשובות במסגרת בהשוואה למסגרות דומות</Name>
      <Type>Bar</Type>
      <Query keyColumn="sDesc" pivotNameColumn="title" pivotValueColumn="Avgx" MinY="0" MaxY="5" LabelFormat="0.00;-0.00;" URL="SurveyAvg.aspx?Rep=ממוצע מפורט למימד במסגרת בהשוואה למסגרות דומות&amp;P=#ColHdr#&amp;J=#JobID#&amp;JN=#JobName#&amp;F=#FrameID#&amp;FN=#FrameName#">
        DECLARE @SurveyID int
        DECLARE @ST int
        SET @SurveyID = 1=1

        SELECT @ST = ServiceTypeID FROM FrameList WHERE FrameID = 2=2

        DECLARE @CNT int
        DECLARE @CNTT varchar(12)

        SELECT @CNT = COUNT(DISTINCT FormID)
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL)
        WHERE Val IS NOT NULL AND 3=3
        SET @CNTT = CASE WHEN ISNULL(@CNT,0) &lt; 5 THEN '' ELSE ' - ' + CAST(@CNT AS varchar(5)) + ' משיבים' END

        SELECT CASE b WHEN 3 THEN 'מסגרות דומות ללא המסגרת שלך' ELSE sDesc END As sDesc,p.title,ROUND(AVG(CAST(Val AS float)),2) as Avgx
        FROM (SELECT CategoryID,title,Ord FROM SV_Survey_Profiles p WHERE SurveyID=@SurveyID AND ParentID!=0) p
        LEFT OUTER JOIN (SELECT QuestionID,CategoryID FROM SV_Survey_PRofileSA WHERE SurveyID=@SurveyID) c On p.CategoryID=c.CategoryID
        LEFT OUTER JOIN (
        SELECT 1 as b,QuestionID,sDesc + @CNTT AS sDesc,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL)
        WHERE Val IS NOT NULL AND 3=3
        <!--UNION ALL
        SELECT 2 as b,QuestionID,sDesc,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,3,2=2)
        WHERE Val IS NOT NULL AND 3=3-->
        UNION ALL
        SELECT 3 as b,QuestionID,sDesc,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,-2=2,@ST,NULL,NULL)
        WHERE Val IS NOT NULL AND 3=3) a ON c.QuestionID = a.QuestionID
        GROUP BY b,sDesc,title,Ord
        ORDER BY Ord DESC,b
      </Query>
      <Params>
        <Param Name="@Services" Repl="9" MustSelect="true"/>
        <Param Name="@Frames" Repl="2" Type="N" MustSelect="true"/>
        <Param Name="@Jobs" Repl="3">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  במסגרות דומות</Param>
        <Param Name="@RSurveyID" Repl="1"/>
      </Params>
      <Comment>ניתן להקליק על גרף של מימד, ולקבל דוח המציג את פירוט השאלות הכלולות במימד</Comment>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys,fmngr">
      <Name>ממוצע התשובות במסגרת בהשוואה לסקר הקודם</Name>
      <Type>Bar</Type>
      <Query keyColumn="sDesc" pivotNameColumn="title" pivotValueColumn="Avgx" MinY="0" MaxY="5" LabelFormat="0.00;-0.00;" URL="SurveyAvg.aspx?Rep=ממוצע מפורט למימד במסגרת בהשוואה לכלל הארגון&amp;P=#ColHdr#&amp;J=#JobID#&amp;JN=#JobName#&amp;F=#FrameID#&amp;FN=#FrameName#">
        DECLARE @SurveyID int
        SET @SurveyID = 1=1

        DECLARE @CNT int
        DECLARE @CNTT varchar(12)

        SELECT @CNT = COUNT(DISTINCT FormID)
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL)
        WHERE Val IS NOT NULL AND 3=3
        SET @CNTT = CASE WHEN ISNULL(@CNT,0) &lt; 5 THEN '' ELSE ' - ' + CAST(@CNT AS varchar(5)) + ' משיבים' END

        SELECT CASE b WHEN 3 THEN 'כלל הארגון' ELSE sDesc END As sDesc,p.title,ROUND(AVG(CAST(Val AS float)),2) as Avgx
        FROM (SELECT CategoryID,title,Ord FROM SV_Survey_Profiles p WHERE SurveyID=@SurveyID AND ParentID!=0) p
        LEFT OUTER JOIN (SELECT QuestionID,CategoryID FROM SV_Survey_PRofileSA WHERE SurveyID=@SurveyID) c On p.CategoryID=c.CategoryID
        LEFT OUTER JOIN (
        SELECT 1 AS b,sDesc + @CNTT AS sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL)
        WHERE Val IS NOT NULL AND 3=3
        UNION ALL
        SELECT 2 AS b,sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,3,2=2,NULL,NULL,NULL)
        WHERE Val IS NOT NULL AND 3=3
        <!--UNION ALL
        SELECT 3 AS b,sDesc,QuestionID,Val     42,32,31,47,44,45,46,48,35,36,39,43 37,41,40,50,28,33,29,38,34
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,NULL)
        WHERE Val IS NOT NULL AND 3=3-->
        ) a ON c.QuestionID = a.QuestionID
        GROUP BY sDesc,b,title,ord
        ORDER BY Ord DESC,b
      </Query>
      <Params>
        <Param Name="@Services" Repl="9" MustSelect="true"/>
        <Param Name="@Frames" Repl="2" Type="N" MustSelect="true"/>
        <Param Name="@Jobs" Repl="3">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  בכלל הארגון</Param>
        <Param Name="@RSurveyID" Repl="1"/>
      </Params>
      <Comment>ניתן להקליק על גרף של מימד, ולקבל דוח המציג את פירוט השאלות הכלולות במימד</Comment>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys,fmngr">
      <Name>פער התשובות במסגרת בהשוואה לכלל הארגון</Name>
      <Type>Bar</Type>
      <Query keyColumn="x" pivotNameColumn="title" pivotValueColumn="Avgx" LabelFormat="0.00;-0.00;">
        DECLARE @SurveyID int
        SET @SurveyID = 1=1

        DECLARE @CNT int
        DECLARE @CNTT varchar(12)

        SELECT @CNT = COUNT(DISTINCT FormID)
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL) a
        LEFT OUTER JOIN (SELECT QuestionID,CategoryID FROM SV_Survey_PRofileSA WHERE SurveyID=@SurveyID) c On a.QuestionID=c.QuestionID
        WHERE Val IS NOT NULL AND CategoryID IS NOT NULL AND 3=3
        SET @CNTT = CASE WHEN ISNULL(@CNT,0) &lt; 5 THEN '' ELSE ' - ' + CAST(@CNT AS varchar(5)) + ' משיבים' END

        SELECT 'פער' + @CNTT AS x, p.title,ROUND(f.Avgx - o.Avgx,2) as Avgx
        FROM (
        SELECT CategoryID,AVG(CAST(Val as float)) As Avgx
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL) a
        LEFT OUTER JOIN (SELECT QuestionID,CategoryID FROM SV_Survey_PRofileSA WHERE SurveyID=@SurveyID) c On a.QuestionID=c.QuestionID
        WHERE Val IS NOT NULL AND CategoryID IS NOT NULL AND 3=3
        GROUP BY CategoryID) f
        LEFT OUTER JOIN (
        SELECT CategoryID,AVG(CAST(Val as float)) As Avgx
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,NULL,NULL,NULL,NULL) a
        LEFT OUTER JOIN (SELECT QuestionID,CategoryID FROM SV_Survey_PRofileSA WHERE SurveyID=@SurveyID) c On a.QuestionID=c.QuestionID
        WHERE Val IS NOT NULL AND CategoryID IS NOT NULL AND 3=3
        GROUP BY CategoryID) o ON o.CateGoryID = f.CategoryID
        LEFT OUTER JOIN (SELECT CategoryID,title FROM SV_Survey_Profiles p WHERE SurveyID=@SurveyID AND ParentID!=0) p ON p.CategoryID = f.CategoryID
        ORDER BY f.Avgx - o.Avgx
      </Query>
      <Params>
        <Param Name="@Services" Repl="9" MustSelect="true"/>
        <Param Name="@Frames" Repl="2" Type="N" MustSelect="true"/>
        <Param Name="@Jobs" Repl="3">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  בכלל הארגון</Param>
        <Param Name="@RSurveyID" Repl="1"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys,fmngr">
      <Name>פער התשובות במסגרת בהשוואה למסגרות דומות</Name>
      <Type>Bar</Type>
      <Query keyColumn="x" pivotNameColumn="title" pivotValueColumn="Avgx" LabelFormat="0.00;-0.00;">
        DECLARE @SurveyID int
        DECLARE @ST int
        SET @SurveyID = 1=1

        SELECT @ST = ServiceTypeID FROM FrameList WHERE FrameID = 2=2

        DECLARE @CNT int
        DECLARE @CNTT varchar(12)

        SELECT @CNT = COUNT(DISTINCT FormID)
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL) a
        LEFT OUTER JOIN (SELECT QuestionID,CategoryID FROM SV_Survey_PRofileSA WHERE SurveyID=@SurveyID) c On a.QuestionID=c.QuestionID
        WHERE Val IS NOT NULL AND CategoryID IS NOT NULL AND 3=3
        SET @CNTT = CASE WHEN ISNULL(@CNT,0) &lt; 5 THEN '' ELSE ' - ' + CAST(@CNT AS varchar(5)) + ' משיבים' END

        SELECT 'פער' + @CNTT AS x, p.title,ROUND(f.Avgx - o.Avgx,2) as Avgx
        FROM (
        SELECT CategoryID,AVG(CAST(Val as float)) As Avgx
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL) a
        LEFT OUTER JOIN (SELECT QuestionID,CategoryID FROM SV_Survey_PRofileSA WHERE SurveyID=@SurveyID) c On a.QuestionID=c.QuestionID
        WHERE Val IS NOT NULL AND CategoryID IS NOT NULL AND 3=3
        GROUP BY CategoryID) f
        LEFT OUTER JOIN (
        SELECT CategoryID,AVG(CAST(Val as float)) As Avgx
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,-2=2,@ST,NULL,NULL) a
        LEFT OUTER JOIN (SELECT QuestionID,CategoryID FROM SV_Survey_PRofileSA WHERE SurveyID=@SurveyID) c On a.QuestionID=c.QuestionID
        WHERE Val IS NOT NULL AND CategoryID IS NOT NULL AND 3=3
        GROUP BY CategoryID) o ON o.CateGoryID = f.CategoryID
        LEFT OUTER JOIN (SELECT CategoryID,title FROM SV_Survey_Profiles p WHERE SurveyID=@SurveyID AND ParentID!=0) p ON p.CategoryID = f.CategoryID
        ORDER BY f.Avgx - o.Avgx
      </Query>
      <Params>
        <Param Name="@Services" Repl="9" MustSelect="true"/>
        <Param Name="@Frames" Repl="2" Type="N"/>
        <Param Name="@Jobs" Repl="3">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  במסגרות דומות</Param>
        <Param Name="@RSurveyID" Repl="1"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys,fmngr">
      <Name>פער התשובות במסגרת בהשוואה לסקר הקודם</Name>
      <Type>Bar</Type>
      <Query keyColumn="x" pivotNameColumn="title" pivotValueColumn="Avgx" LabelFormat="0.00;-0.00;">
        DECLARE @SurveyID int
        SET @SurveyID = 1=1

        DECLARE @CNT int
        DECLARE @CNTT varchar(12)

        SELECT @CNT = COUNT(DISTINCT FormID)
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL) a
        LEFT OUTER JOIN (SELECT QuestionID,CategoryID FROM SV_Survey_PRofileSA WHERE SurveyID=@SurveyID) c On a.QuestionID=c.QuestionID
        WHERE Val IS NOT NULL AND CategoryID IS NOT NULL AND 3=3
        SET @CNTT = CASE WHEN ISNULL(@CNT,0) &lt; 5 THEN '' ELSE ' - ' + CAST(@CNT AS varchar(5)) + ' משיבים' END

        SELECT 'פער' + @CNTT AS x, p.title,ROUND(f.Avgx - o.Avgx,2) as Avgx
        FROM (
        SELECT CategoryID,AVG(CAST(Val as float)) As Avgx
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL) a
        LEFT OUTER JOIN (SELECT QuestionID,CategoryID FROM SV_Survey_PRofileSA WHERE SurveyID=@SurveyID) c On a.QuestionID=c.QuestionID
        WHERE Val IS NOT NULL AND CategoryID IS NOT NULL AND 3=3
        GROUP BY CategoryID) f
        LEFT OUTER JOIN (
        SELECT CategoryID,AVG(CAST(Val as float)) As Avgx
        FROM dbo.SV_fnAnswers_2(@SurveyID,3,2=2,NULL,NULL,NULL) a
        LEFT OUTER JOIN (SELECT QuestionID,CategoryID FROM SV_Survey_PRofileSA WHERE SurveyID=@SurveyID) c On a.QuestionID=c.QuestionID
        WHERE Val IS NOT NULL AND CategoryID IS NOT NULL AND 3=3
        GROUP BY CategoryID) o ON o.CateGoryID = f.CategoryID
        LEFT OUTER JOIN (SELECT CategoryID,title FROM SV_Survey_Profiles p WHERE SurveyID=@SurveyID AND ParentID!=0) p ON p.CategoryID = f.CategoryID
        ORDER BY f.Avgx - o.Avgx
      </Query>
      <Params>
        <Param Name="@Services" Repl="9" MustSelect="true"/>
        <Param Name="@Frames" Repl="2" Type="N"/>
        <Param Name="@Jobs" Repl="3">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  במסגרות דומות</Param>
        <Param Name="@RSurveyID" Repl="1"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys,fmngr" Visible="false">
      <Name>ממוצע מפורט למימד במסגרת בהשוואה לכלל הארגון</Name>
      <Type>Bar</Type>
      <Query keyColumn="colH" pivotNameColumn="Question" pivotValueColumn="Avgx" MinY="0" MaxY="5" LabelFormat="0.00;-0.00;">
        Declare @SurveyID int
        SET @SurveyID = 1=1

        DECLARE @CNT int
        DECLARE @CNTT varchar(12)

        SELECT @CNT = COUNT(DISTINCT FormID)
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL)
        WHERE 3=3
        SET @CNTT = CASE WHEN ISNULL(@CNT,0) &lt; 5 THEN '' ELSE ' - ' + CAST(@CNT AS varchar(5)) + ' משיבים' END

        SELECT CASE b WHEN 3 THEN 'כלל הארגון' ELSE sDesc END As colH,Question,ROUND(AVG(CAST(Val As float)),2) As Avgx
        FROM (
        SELECT 1 AS b,sDesc + @CNTT AS sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL)
        WHERE 3=3
        UNION ALL
        SELECT 2 AS b,sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,3,2=2,NULL,NULL,NULL)
        WHERE 3=3
        UNION ALL
        SELECT 3 AS b,sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,NULL,NULL,NULL,NULL)
        WHERE 3=3) a
        LEFT OUTER JOIN (SELECT QuestionID,Question FROM SV_SurQuestions WHERE SurveyID = @SurveyID ANd QuestionID != 0) q
        ON q.QuestionID=a.QuestionID
        GROUP BY b,sDesc,Question,a.QuestionID
        Order by a.QuestionID DESC,a.b
      </Query>
      <Params>
        <Param Name="@FrameQ" Repl="2" Type="N"/>
        <Param Name="@Profilen" Repl="3"/>
        <Param Name="@JobQ" Repl="3">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  בכלל הארגון</Param>
        <Param Name="@RSurveyID" Repl="1"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys,fmngr" Visible="false">
      <Name>ממוצע מפורט למימד במסגרת בהשוואה למסגרות דומות</Name>
      <Type>Bar</Type>
      <Query keyColumn="colH" pivotNameColumn="Question" pivotValueColumn="Avgx" MinY="0" MaxY="5" LabelFormat="0.00;-0.00;">
        DECLARE @SurveyID int
        DECLARE @ST int
        SET @SurveyID = 1=1
        SELECT @ST = ServiceTypeID FROM FrameList WHERE FrameID = 2=2

        DECLARE @CNT int
        DECLARE @CNTT varchar(12)

        SELECT @CNT = COUNT(DISTINCT FormID)
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL)
        WHERE 3=3
        SET @CNTT = CASE WHEN ISNULL(@CNT,0) &lt; 5 THEN '' ELSE ' - ' + CAST(@CNT AS varchar(5)) + ' משיבים' END

        SELECT CASE b WHEN 3 THEN 'מסגרות דומות ללא המסגרת שלך' ELSE sDesc END As colH,Question,ROUND(AVG(CAST(Val As float)),2) As Avgx
        FROM (
        SELECT 1 AS b,sDesc + @CNTT AS sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,2=2,NULL,NULL,NULL)
        WHERE 3=3
        UNION ALL
        SELECT 2 AS b,sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,3,2=2,NULL,NULL,NULL)
        WHERE 3=3
        UNION ALL
        SELECT 3 AS b,sDesc,QuestionID,Val
        FROM dbo.SV_fnAnswers_2(@SurveyID,2,-2=2,@ST,NULL,NULL)
        WHERE Val IS NOT NULL AND 3=3) a
        LEFT OUTER JOIN (SELECT QuestionID,Question FROM SV_SurQuestions WHERE SurveyID = @SurveyID ANd QuestionID != 0) q ON q.QuestionID = a.QuestionID
        GROUP BY b,sDesc,Question,a.QuestionID
        Order by a.QuestionID DESC,a.b
      </Query>
      <Params>
        <Param Name="@FrameQ" Repl="2" Type="N"/>
        <Param Name="@Profilen" Repl="3"/>
        <Param Name="@JobQ" Repl="3">נתונים של [P] במסגרת בהשוואה לאותם בעלי תפקידים  במסגרות דומות</Param>
        <Param Name="@RSurveyID" Repl="1"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF">
      <Name>שביעות רצון כללית – לפי מסגרות</Name>
      <Type>Img</Type>
      <Query>
        Declare @SurveyID int
        SET @SurveyID = 2=2
        Select FrameID,FileName
        From
        (SELECT [projectID]
        ,[SlideNumber]
        ,[SurveyID]
        ,d.[ServiceID]
        ,f.[FrameID]
        ,[description]
        ,[filename]
        FROM [SV_DispImages] d
        left Outer join FrameList f on f.ServiceID=d.ServiceID
        Where ProjectID=1  And
        SurveyID=@SurveyID AND f.FrameID = 1=1) x
      </Query>
      <Params>
        <Param Name="@Frames" Repl="1" Type="N"/>
        <Param Name="@RSurveyID" Repl="2"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF">
      <Name>ממוצע התשובות לפי מסגרת</Name>
      <Type>Img</Type>
      <Query>
        Declare @SurveyID int
        SET @SurveyID = 2=2
        Select FrameID,FileName
        From
        (SELECT [projectID]
        ,[SlideNumber]
        ,[SurveyID]
        ,d.[ServiceID]
        ,f.[FrameID]
        ,[description]
        ,[filename]
        FROM [SV_DispImages] d
        left Outer join FrameList f on f.ServiceID=d.ServiceID
        Where ProjectID=2  And
        SurveyID=@SurveyID AND f.FrameID = 1=1) x
      </Query>
      <Params>
        <Param Name="@Frames" Repl="1" Type="N"/>
        <Param Name="@RSurveyID" Repl="2"/>
      </Params>
    </Chart>
    <Chart UserGroups="FMNGRTest,Frmngr,fmngr,SurveysF">
      <Name>דפוסי עזיבה</Name>
      <Type>Img</Type>
      <Query>
        Declare @SurveyID int
        SET @SurveyID = 2=2
        Select FrameID,FileName
        From
        (SELECT [projectID]
        ,[SlideNumber]
        ,[SurveyID]
        ,d.[ServiceID]
        ,f.[FrameID]
        ,[description]
        ,[filename]
        FROM [SV_DispImages] d
        left Outer join FrameList f on f.ServiceID=d.ServiceID
        Where ProjectID=3  And
        SurveyID=@SurveyID AND f.FrameID = 1=1) x
      </Query>
      <Params>
        <Param Name="@Frames" Repl="1" Type="N"/>
        <Param Name="@RSurveyID" Repl="2"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,SMNGR,MPMNGR,Admin,FullSurveys,fmngr">
      <Name>-------------------------------------------------------------</Name>
      <Type></Type>
      <Query>
        SELECT 6
      </Query>
      <Params></Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr,SurveysF,Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>רשימת הטקסטים החופשיים במסגרת: מה הנך מעריך בבית אקשטיין</Name>
      <Type>URL</Type>
      <Query>
        SurveyTexts.aspx?q=59&amp;sb=3&amp;sg=1=1&amp;T=2=2&amp;r=רשימת הטקסטים החופשיים: מה הנך מעריך בבית אקשטיין&amp;s=3=3
      </Query>
      <Params>
        <Param Name="@RSurveyID" Repl="3" Conc=""/>
        <Param Name="@SurveyGroupID" Repl="1" Conc=""/>
        <Param Name="@SurveyGroupName" Repl="2" Conc=""/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr,SurveysF,Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>רשימת הטקסטים החופשיים במסגרת: מה היית מציע לשנות/לשפר</Name>
      <Type>URL</Type>
      <Query>
        SurveyTexts.aspx?q=60&amp;sb=3&amp;sg=1=1&amp;T=2=2&amp;r=שימת הטקסטים החופשיים: מה היית מציע לשנות/לשפר&amp;s=3=3
      </Query>
      <Params>
        <Param Name="@RSurveyID" Repl="3" Conc=""/>
        <Param Name="@SurveyGroupID" Repl="1" Conc=""/>
        <Param Name="@SurveyGroupName" Repl="2" Conc=""/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr,SurveysF,Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>הטקסט המלא של שאלות הסקר</Name>
      <Type>URL</Type>
      <Query>
        SurveyQuestionpopup.aspx?s=1=1&amp;g=2
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
  </Charts>
  <Charts SurveyGroupID="2" SubGroup="4" ConnectionString="Book10VPS">
    <OrganizationalData>
      <Avg AvgType="1"></Avg>
      <Avg AvgType="2"></Avg>
    </OrganizationalData>
    <SelectionControls>
      <Control ID="DSServiceID" Type="sql" Scontrol="DDLServiceID">
        Select ServiceName,ServiceID
        From
        (SELECT ServiceName, ServiceID
        FROM ServiceList
        Where Serviceid in (1,2,3,4,8) And ServiceID in (Select Distinct ServiceID
        From FrameList
        Where FrameID in (Select FrameID
        From dbo.p0v_UserFrameList
        Where UserID=@UserID))) x
        ORDER BY ServiceID
      </Control>
      <Control ID="DSFrameID" Type="sql" Scontrol="DDLFrameID" SurveyID="15">
        SELECT FrameID,FrameName
        FROM SV_vSurvey_Frames
        Where SurveyID=15 AND ServiceID=ISNULL(@ServiceID,0) AND ((FrameID IN (SELECT FrameID FROM dbo.p0v_UserFrameList WHERE UserID = @UserID)) OR (FrameID&gt;9999))
        Order by ISNULL(ord,0)
        <!--SELECT f.FrameName, f.FrameID, @UserID As UserID, f.ServiceID
        FROM FrameList f
        WHERE f.FrameID not in(14,23) And f.FrameID in (Select FrameID
        From dbo.p0v_UserFrameList
        Where (UserID=@UserID)) And (f.ServiceID=ISNULL(@ServiceID,ServiceID))-->
      </Control>
      <Control ID="DSProfiles" Type="sql" Scontrol="DDLProfiles">
        Select * From SV_Survey_Profiles Where Root=27
      </Control>
      <Control ID="DSJob" Type="sql" Scontrol="DDLJob">
        SELECT 0 AS ID, 'כל התפקידים' AS [AnswerText]
        UNION ALL
        SELECT [ID], [AnswerText]
        FROM dbo.SV_fnSelectionList(@SurveyID,'JobID',1)
        Where ExcludeFromList = 0 AND ID in (Select DISTINCT JobID FROM dbo.SV_fnAnswers_2(@SurveyID,2,Coalesce(@FrameID,@FrameIDD,999999),NULL,NULL,NULL) GROUP BY JobID Having COUNT(JobID)&gt;1)
      </Control>
    </SelectionControls>
    <Criterions>
      <Criterion Name="@Services">(Prefix.ServiceID=@Services)</Criterion>
      <Criterion Name="@Frames">(Prefix.FrameID=@Frames)</Criterion>
      <Criterion Name="@SEN">(Prefix.SenID=@Sen)</Criterion>
      <Criterion Name="@Age">(Prefix.AgeID=@Age)</Criterion>
      <Criterion Name="@Gender">(Prefix.GenderID=@Gender)</Criterion>
      <Criterion Name="@Jobs">(Prefix.JobID=@Jobs)</Criterion>
      <Criterion Name="@Profiles">((isnull(פרופיל_1,'') = ISNULL(@Profile_1,פרופיל_1)) And (isnull(פרופיל_2,'') = ISNULL(@Profile_2,isnull(פרופיל_2,''))) And (isnull(פרופיל_3,'') = ISNULL(@Profile_3,isnull(פרופיל_3,''))))</Criterion>
      <Criterion Name="@Questions">שאלה in @Questions</Criterion>
      <Criterion Name="@UserID">Prefix.FrameID in (select frameid from dbo.p0v_UserFrameList where userid=@UserID)</Criterion>
      <Criterion Name="@FrameID">ISNULL(Prefix.FrameID,@FrameID)=@FrameID</Criterion>
      <Criterion Name="@Profilen">
        Prefix.QuestionID in (SELECT QuestionID
        FROM SV_Survey_PRofileSA
        Where SurveyID=@SurveyID And CategoryID=(Select CategoryID From SV_Survey_Profiles Where title=@Profilen And SurveyID=@SurveyID))
      </Criterion>
      <Criterion Name="@ExcludeFrameID">Prefix.FrameID!=@ExcludeFrameID</Criterion>
      <Criterion Name="@SurveyGroupID">@SurveyGroupID</Criterion>
      <Criterion Name="@SurveyGroupName">@SurveyGroupName</Criterion>
      <Criterion Name="@JobQ">(Prefix.JobID=@JobQ)</Criterion>
      <Criterion Name="@FrameQ">(Prefix.FrameID=@FrameQ)</Criterion>
      <Criterion Name="@SurveyID">(SurveyID=@SurveyID)</Criterion>
      <Criterion Name="@RSurveyID">@RSurveyID</Criterion>
    </Criterions>
    <Chart Name="כותרות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>כותרות</Name>
      <Type>Img</Type>
      <Query>
        SELECT
        [filename]
        FROM [SV_DispImages]
        Where SlideID={SlideID}
      </Query>
      <Params>
        <Param Name="@Frames" Repl="2">[P]</Param>
       </Params>
    </Chart>
    <Chart ID="4" Name="אחוזי השבה למסגרת" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>אחוזי השבה למסגרת</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="מענה" pivotNameColumn="סקר" pivotValueColumn="Cnt" MinY="0" MaxY="100" AdditionalHeaderTextColumn="CCnt">
        DECLARE @FrameID int
        DECLARE @ServiceTypeID int
        DECLARE @ServiceID int
        SELECT @FrameID=FrameID,@ServiceTypeID=ServiceTypeHID,@ServiceID=ServiceID
        FROM Book10_21.dbo.FrameList f
        LEFT OUTER JOIN Book10_21.dbo.p5t_ServiceType st ON st.ServiceTypeID=f.ServiceTypeID
        WHERE 2=2
        SELECT סקר,מענה,Cnt,CASE  WHEN S2='2012' AND מענה='ענו' THEN '{Color=LightBlue}' ELSE '' END + CAST(Cnt AS nvarchar(10)) + '\nמ-' +  + CAST(c as nvarchar(5))  + '\n(' + CAST(ROUND(CAST(cnt As float) / CAST(SCnt As float) * 100,0) AS nvarchar(5)) + '%)' AS CCnt
        FROM (
        SELECT FrameName AS Col,Survey + ' ' + FrameName סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2, 'a4' s1
        FROM SV_tblCount_15
        WHERE FrameID=@FrameID
        GROUP BY Survey,FrameName
        UNION ALL
        SELECT FrameName AS Col,Survey + ' ' + FrameName סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2, 'a4' s1
        FROM SV_tblCount_15
        WHERE FrameID=@FrameID
        GROUP BY Survey,FrameName

        UNION ALL

        SELECT ServiceType AS Col,Survey + ' ' + ServiceType סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2,'a3' s1
        FROM SV_tblCount_15
        where ServiceTypeID = @ServiceTypeID
        GROUP BY Survey,ServiceType
        UNION ALL
        SELECT ServiceType AS Col,Survey + ' ' + ServiceType סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2,'a3' s1
        FROM SV_tblCount_15
        where ServiceTypeID = @ServiceTypeID
        GROUP BY Survey,ServiceType

        UNION ALL

        SELECT ServiceName AS Col,Survey + ' ' + ServiceName סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2, 'a2' s1
        FROM SV_tblCount_15
        where ServiceID = @ServiceID
        GROUP BY Survey,ServiceName
        UNION ALL
        SELECT ServiceName AS Col,Survey + ' ' + ServiceName סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2, 'a2' s1
        FROM SV_tblCount_15
        where ServiceID = @ServiceID
        GROUP BY Survey,ServiceName

        UNION ALL

        SELECT 'ארגוני' AS Col,Survey + ' ארגוני' סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s2,'a1' S1
        FROM SV_tblCount_15
        GROUP BY Survey
        UNION ALL
        SELECT 'ארגוני' AS Col,Survey + ' ארגוני' סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s2,'a1' S1
        FROM SV_tblCount_15
        GROUP BY Survey
        ) a
        Order By s1,S2 Desc,מענה Desc
      </Query>
      <Params>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="התפלגות משיבים לפי גיל" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>התפלגות משיבים לפי גיל</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="מענה" pivotNameColumn="סקר" pivotValueColumn="Cnt" MinY="0" MaxY="100" AdditionalHeaderTextColumn="CCnt">
        DECLARE @FrameID int
        DECLARE @ServiceTypeID int
        DECLARE @ServiceID int
        SELECT @FrameID=FrameID,@ServiceTypeID=ServiceTypeHID,@ServiceID=ServiceID
        FROM Book10_21.dbo.FrameList f
        LEFT OUTER JOIN Book10_21.dbo.p5t_ServiceType st ON st.ServiceTypeID=f.ServiceTypeID
        WHERE 2=2
        SELECT סקר,מענה,Cnt,CAST(Cnt AS nvarchar(10)) + '\nמ-' +  + CAST(SUM(Cnt) OVER(PARTITION BY Col,סקר) AS nvarchar(5))  + '\n(' + CAST(ROUND(CAST(cnt As float) / CAST(SUM(Cnt) OVER(PARTITION BY Col,סקר) As float) * 100,0) AS nvarchar(5)) + '%)' AS CCnt
        FROM (
        SELECT FrameName AS Col,ShortDescription + ' ' + FrameName סקר, Jage מענה ,COUNT(FormID) Cnt,ShortDescription S2, 'a4' s1,JageID
        FROM (SELECT DISTINCT SurveyID,FrameID,FrameName,FormID,JAge,JageID FROM SV_TblAnswers_15 WHERE FrameID=@FrameID) x
        LEFT OUTER JOIN SV_Surveys s ON s.SurveyID=x.SurveyID
        GROUP BY ShortDescription,FrameName,Jage,JageID

        UNION ALL

        SELECT Sh.Name AS Col,ShortDescription + ' ' + sh.Name סקר, Jage מענה ,COUNT(FormID) Cnt,ShortDescription S2, 'a3' s1,JageID
        FROM (SELECT DISTINCT SurveyID,ServiceTypeID,FormID,JAge,JageID FROM SV_TblAnswers_15) x
        LEFT OUTER JOIN SV_Surveys s ON s.SurveyID=x.SurveyID
        LEFT OUTER JOIN Book10_21.dbo.p5t_ServiceType st ON st.ServiceTypeID=x.ServiceTypeID
        LEFT OUTER JOIN Book10_21.dbo.p5t_ServiceTypes_H sh ON sh.Id=st.ServiceTypeHID
        WHERE sh.ID = @ServiceTypeID
        GROUP BY ShortDescription,sh.Name,Jage,JageID

        UNION ALL

        SELECT ServiceName AS Col,ShortDescription + ' ' + ServiceName סקר, Jage מענה ,COUNT(FormID) Cnt,ShortDescription S2, 'a2' s1,JageID
        FROM (SELECT DISTINCT SurveyID,ServiceName,FormID,JAge,JageID FROM SV_TblAnswers_15 where ServiceID = @ServiceID) x
        LEFT OUTER JOIN SV_Surveys s ON s.SurveyID=x.SurveyID
        GROUP BY ShortDescription,ServiceName,Jage,JageID


        UNION ALL

        SELECT 'ארגוני' AS Col,ShortDescription + ' ' + 'ארגוני' סקר, Jage מענה ,COUNT(FormID) Cnt,ShortDescription S2, 'a1' s1,JageID
        FROM (SELECT DISTINCT SurveyID,FormID,JAge,JageID FROM SV_TblAnswers_15 ) x
        LEFT OUTER JOIN SV_Surveys s ON s.SurveyID=x.SurveyID
        GROUP BY ShortDescription,Jage,JageID
        ) a
        GROUP BY סקר,Col,s1,s2,מענה,cnt,JageID
        Order By s1,JageID,S2 Desc,מענה Desc
      </Query>
      <Params>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="התפלגות משיבים לפי תפקיד" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>התפלגות משיבים לפי תפקיד</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="מענה" pivotNameColumn="סקר" pivotValueColumn="Cnt" MinY="0" MaxY="100" AdditionalHeaderTextColumn="CCnt">
        DECLARE @FrameID int
        DECLARE @ServiceTypeID int
        DECLARE @ServiceID int
        SELECT @FrameID=FrameID,@ServiceTypeID=ServiceTypeHID,@ServiceID=ServiceID
        FROM Book10_21.dbo.FrameList f
        LEFT OUTER JOIN Book10_21.dbo.p5t_ServiceType st ON st.ServiceTypeID=f.ServiceTypeID
        WHERE 2=2;
        WITH CTE AS (SELECT top 4 JobID FROM SV_TblAnswers_15 WHERE 2=2 AND SurveyID=15 GROUP BY JobID ORDER BY COUNT(Distinct FormID) DESC)
        SELECT סקר,REPLACE(מענה,'quot;','') מענה,Cnt,CAST(Cnt AS nvarchar(10)) + '\nמ-' +  + CAST(SUM(Cnt) OVER(PARTITION BY Col,סקר) AS nvarchar(5))  + '\n(' + CAST(ROUND(CAST(cnt As float) / CAST(SUM(Cnt) OVER(PARTITION BY Col,סקר) As float) * 100,0) AS nvarchar(5)) + '%)' AS CCnt
        FROM (
        SELECT FrameName AS Col,ShortDescription + ' ' + FrameName סקר, Job מענה ,COUNT(FormID) Cnt,ShortDescription S2, 'a4' s1,JobID
        FROM (SELECT DISTINCT SurveyID,FrameID,FrameName,FormID,Job,JobID FROM SV_TblAnswers_15 WHERE FrameID=@FrameID AND JobID IN (SELECT JobID FROM CTE)) x
        LEFT OUTER JOIN SV_Surveys s ON s.SurveyID=x.SurveyID
        GROUP BY ShortDescription,FrameName,Job,JobID

        UNION ALL

        SELECT Sh.Name AS Col,ShortDescription + ' ' + sh.Name סקר, Job מענה ,COUNT(FormID) Cnt,ShortDescription S2, 'a3' s1,JobID
        FROM (SELECT DISTINCT SurveyID,ServiceTypeID,FormID,Job,JobID FROM SV_TblAnswers_15) x
        LEFT OUTER JOIN SV_Surveys s ON s.SurveyID=x.SurveyID
        LEFT OUTER JOIN Book10_21.dbo.p5t_ServiceType st ON st.ServiceTypeID=x.ServiceTypeID
        LEFT OUTER JOIN Book10_21.dbo.p5t_ServiceTypes_H sh ON sh.Id=st.ServiceTypeHID
        WHERE sh.ID = @ServiceTypeID  AND JobID IN (SELECT JobID FROM CTE)
        GROUP BY ShortDescription,sh.Name,Job,JobID

        UNION ALL

        SELECT ServiceName AS Col,ShortDescription + ' ' + ServiceName סקר, Job מענה ,COUNT(FormID) Cnt,ShortDescription S2, 'a2' s1,JobID
        FROM (SELECT DISTINCT SurveyID,ServiceName,FormID,Job,JobID FROM SV_TblAnswers_15 where ServiceID = @ServiceID AND JobID IN (SELECT JobID FROM CTE)) x
        LEFT OUTER JOIN SV_Surveys s ON s.SurveyID=x.SurveyID
        GROUP BY ShortDescription,ServiceName,Job,JobID


        UNION ALL

        SELECT 'ארגוני' AS Col,ShortDescription + ' ' + 'ארגוני' סקר, Job מענה ,COUNT(FormID) Cnt,ShortDescription S2, 'a1' s1,JobID
        FROM (SELECT DISTINCT SurveyID,FormID,Job,JobID FROM SV_TblAnswers_15 WHERE JobID IN (SELECT JobID FROM CTE) ) x
        LEFT OUTER JOIN SV_Surveys s ON s.SurveyID=x.SurveyID
        GROUP BY ShortDescription,Job,JobID
        ) a
        GROUP BY סקר,Col,s1,s2,מענה,cnt,JobID
        Order By s1,JobID,S2 Desc,מענה Desc
      </Query>
      <Params>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="התפלגות ציונים" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>התפלגות ציונים</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="val" pivotNameColumn="s" pivotValueColumn="c" MinY="0" MaxY="100">
        SELECT ShortDescription s,val,COUNT(*) c
        FROM SV_TblAnswers_15 a
        WHERE 2=2 AND val IS NOT NULL 
        GROUP BY Val,ShortDescription
        Order By Val,ShortDescription Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="פרופיל הסקר" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>פרופיל הסקר</Name>
      <Type>Column</Type>
      <Query keyColumn="s" pivotNameColumn="Class" pivotValueColumn="rslt" MinY="0" MaxY="5" AdditionalHeaderTextColumn="CCnt">
       DECLARE @FrameID int
        DECLARE @ServiceTypeID int
        DECLARE @ServiceID int
        SELECT @FrameID=FrameID,@ServiceTypeID=ServiceTypeHID,@ServiceID=ServiceID
        FROM Book10_21.dbo.FrameList f
        LEFT OUTER JOIN Book10_21.dbo.p5t_ServiceType st ON st.ServiceTypeID=f.ServiceTypeID
        WHERE 2=2
        Select s,Class,rslt,CCnt
        FROM (
        Select a.FrameName s,s.Name AS Class,ROUND(AVG(CAST(Val As Float)),2) rslt,'{LabelBackColor=RoyalBlue|LabelForeColor=White}' + CAST(ROUND(AVG(CAST(Val As Float)),2) AS nvarchar(5)) CCnt,'a' s1
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN B10Sec.dbo.GL_Classifications c ON c.Fid=a.QuestionID
        LEFT OUTER JOIN B10Sec.dbo.GL_Classes s ON s.Id=c.ClassId
        WHERE ClassNameID=3 AND a.FrameID=@FrameID And a.SurveyID=15
        GROUP BY a.ShortDescription,s.Name,a.FrameName

        UNION  ALL

        Select a.FrameName s,'ממוצע' Class,ROUND(AVG(CAST(Val As Float)),2) rslt,'{Color=SlateBlue|LabelBackColor=SlateBlue|LabelForeColor=White}ממוצע\n' + CAST(ROUND(AVG(CAST(Val As Float)),2) AS nvarchar(5)) CCnt,'a' s1
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN B10Sec.dbo.GL_Classifications c ON c.Fid=a.QuestionID
        LEFT OUTER JOIN B10Sec.dbo.GL_Classes s ON s.Id=c.ClassId
        WHERE ClassNameID=3 AND FrameID=@FrameID And a.SurveyID=15
        GROUP BY a.ShortDescription,a.FrameName

	UNION ALL

        Select a.ServiceType s,s.Name AS Class,ROUND(AVG(CAST(Val As Float)),2) rslt,'{LabelForeColor=Violet}' + CAST(ROUND(AVG(CAST(Val As Float)),2) AS nvarchar(5)) CCnt,'b' s1
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN B10Sec.dbo.GL_Classifications c ON c.Fid=a.QuestionID
        LEFT OUTER JOIN B10Sec.dbo.GL_Classes s ON s.Id=c.ClassId
        WHERE ClassNameID=3 AND ServiceTypeID=@ServiceTypeID And a.SurveyID=15
        GROUP BY a.ShortDescription,s.Name,a.ServiceType	
 
        UNION  ALL

        Select a.ServiceType s,'ממוצע' Class,ROUND(AVG(CAST(Val As Float)),2) rslt,'{ChartType=Line|LabelForeColor=LimeGreen}' + CAST(ROUND(AVG(CAST(Val As Float)),2) AS nvarchar(5)) CCnt,'b' s1
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN B10Sec.dbo.GL_Classifications c ON c.Fid=a.QuestionID
        LEFT OUTER JOIN B10Sec.dbo.GL_Classes s ON s.Id=c.ClassId
        WHERE ClassNameID=3 AND ServiceTypeID=@ServiceTypeID And a.SurveyID=15
        GROUP BY a.ShortDescription,a.ServiceType

	UNION ALL

        Select 'ארגוני' s,s.Name AS Class,ROUND(AVG(CAST(Val As Float)),2) rslt,'{LabelForeColor=LimeGreen}' + CAST(ROUND(AVG(CAST(Val As Float)),2) AS nvarchar(5)) CCnt,'c' s1
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN B10Sec.dbo.GL_Classifications c ON c.Fid=a.QuestionID
        LEFT OUTER JOIN B10Sec.dbo.GL_Classes s ON s.Id=c.ClassId
        WHERE ClassNameID=3  And a.SurveyID=15
        GROUP BY a.ShortDescription,s.Name	

        UNION  ALL

        Select 'ארגוני' s,'ממוצע' Class,ROUND(AVG(CAST(Val As Float)),2) rslt,'{ChartType=Line|LabelForeColor=LimeGreen}' + CAST(ROUND(AVG(CAST(Val As Float)),2) AS nvarchar(5)) CCnt,'c' s1
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN B10Sec.dbo.GL_Classifications c ON c.Fid=a.QuestionID
        LEFT OUTER JOIN B10Sec.dbo.GL_Classes s ON s.Id=c.ClassId
        WHERE ClassNameID=3 AND a.SurveyID=15
        GROUP BY a.ShortDescription

       ) a
        Order By s1,Rslt Desc
      </Query>
      <Params>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="פרופיל הסקר בהשואה לתקופה קודמת" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>פרופיל הסקר בהשוואה לתקופה קודמת</Name>
      <Type>Column</Type>
      <Query keyColumn="s" pivotNameColumn="Class" pivotValueColumn="rslt" MinY="0" MaxY="5" AdditionalHeaderTextColumn="CCnt">
        Select s,Class,rslt,CCnt
        FROM (
        Select a.ShortDescription s,s.Name AS Class,ROUND(AVG(CAST(Val As Float)),2) rslt,CAST(ROUND(AVG(CAST(Val As Float)),2) AS nvarchar(5)) CCnt
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN B10Sec.dbo.GL_Classifications c ON c.Fid=a.QuestionID
        LEFT OUTER JOIN B10Sec.dbo.GL_Classes s ON s.Id=c.ClassId
        WHERE ClassNameID=3 AND 2=2
        GROUP BY a.ShortDescription,s.Name
        UNION  ALL
        Select a.ShortDescription s,'ממוצע' Class,ROUND(AVG(CAST(Val As Float)),2) rslt,'{Color=' + CASE a.ShortDescription WHEN '2013' THEN 'SlateBlue}ממוצע\n' ELSE 'LightBlue}' END + CAST(ROUND(AVG(CAST(Val As Float)),2) AS nvarchar(5)) CCnt
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN B10Sec.dbo.GL_Classifications c ON c.Fid=a.QuestionID
        LEFT OUTER JOIN B10Sec.dbo.GL_Classes s ON s.Id=c.ClassId
        WHERE ClassNameID=3 AND 2=2
        GROUP BY a.ShortDescription
        ) a
        Order By s Desc,Rslt Desc
      </Query>
      <Params>
        <Param Name="@Frames" Repl="2" Prefix="a">[P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="שביעות רצון כללית בהשוואה למסגרות דומות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית בהשוואה למסגרות דומות</Name>
      <Type>Column</Type>
      <Query keyColumn="s" pivotNameColumn="FrameName" pivotValueColumn="rslt" MinY="0" MaxY="5" AdditionalHeaderTextColumn="CCnt">
        DECLARE @FrameID int
        DECLARE @ServiceTypeID int
        DECLARE @ServiceID int
        SELECT @FrameID=FrameID,@ServiceTypeID=ServiceTypeHID,@ServiceID=ServiceID
        FROM Book10_21.dbo.FrameList f
        LEFT OUTER JOIN Book10_21.dbo.p5t_ServiceType st ON st.ServiceTypeID=f.ServiceTypeID
        WHERE 2=2 
        Select s,FrameName,rslt,CCnt
        FROM (
        Select a.ShortDescription s,a.FrameName,ROUND(AVG(CAST(Val As Float)),2) rslt,'{Color=SlateBlue}' + FrameName + '\n' + CAST(ROUND(AVG(CAST(Val As Float)),2) AS nvarchar(5)) CCnt
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN Book10_21.dbo.p5t_ServiceType st ON st.ServiceTypeID=a.ServiceTypeID
        LEFT OUTER JOIN B10Sec.dbo.GL_Classifications c ON c.Fid=a.QuestionID
        WHERE ClassID=23 AND a.FrameID=@FrameID And a.SurveyID=15
        GROUP BY a.ShortDescription,a.FrameName
        UNION  ALL
        Select a.ShortDescription s,a.FrameName,ROUND(AVG(CAST(Val As Float)),2) rslt,CAST(ROUND(AVG(CAST(Val As Float)),2) AS nvarchar(5)) CCnt
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN Book10_21.dbo.p5t_ServiceType st ON st.ServiceTypeID=a.ServiceTypeID
        LEFT OUTER JOIN B10Sec.dbo.GL_Classifications c ON c.Fid=a.QuestionID
        WHERE ClassID=23 AND a.FrameID!=@FrameID AND ServiceTypeHID=@ServiceTypeID And a.SurveyID=15
        GROUP BY a.ShortDescription,a.FrameName
        ) a
        Order By Rslt Desc
      </Query>
      <Params>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="שביעות רצון כללית בהשואה לתקופה קודמת" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית בהשואה לתקופה קודמת</Name>
      <Type>Column</Type>
      <Query keyColumn="s" pivotNameColumn="Class" pivotValueColumn="rslt" MinY="0" MaxY="5" AdditionalHeaderTextColumn="CCnt">
        Select s,Class,rslt,CCnt
        FROM (
        Select a.ShortDescription s,s.Name COLLATE Hebrew_CI_AI AS Class,ROUND(AVG(CAST(Val As Float)),2) rslt,'{Color=' + CASE a.ShortDescription WHEN '2013' THEN 'SlateBlue}' + s.Name COLLATE Hebrew_CI_AI + '\n'  ELSE 'LightBlue}' END + CAST(ROUND(AVG(CAST(Val As Float)),2) AS nvarchar(5)) CCnt
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN B10Sec.dbo.GL_Classifications c ON c.Fid=a.QuestionID
        LEFT OUTER JOIN B10Sec.dbo.GL_Classes s ON s.Id=c.ClassId
        WHERE ClassID=23 AND 2=2 
        GROUP BY a.ShortDescription,s.Name
        UNION ALL
        Select a.ShortDescription s,q.Question AS Class,ROUND(AVG(CAST(Val As Float)),2) rslt,CAST(ROUND(AVG(CAST(Val As Float)),2) AS nvarchar(5)) CCnt
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN B10Sec.dbo.GL_Classifications c ON c.Fid=a.QuestionID
        LEFT OUTER JOIN B10Sec.dbo.GL_Classes s ON s.Id=c.ClassId
        LEFT OUTER JOIN (SELECT QuestionID,Question FROM SV_SurQuestions WHERE SurveyID=15) q ON q.QuestionID=a.QuestionID
        WHERE ClassID=23 AND 2=2
        GROUP BY a.ShortDescription,q.Question

        ) a
        Order By s Desc,Rslt Desc,Class
      </Query>
      <Params>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="המאפיינים הבולטים בתרבות הארגונית" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR" MinY="0" MaxY="40" >
      <Name>המאפיינים הבולטים בתרבות הארגונית</Name>
      <Type>Bar</Type>
      <Query keyColumn="s" pivotNameColumn="Question" pivotValueColumn="prc" AdditionalHeaderTextColumn="CCnt">
        WITH CTE AS (
        SELECT a.QuestionID,ROUND(CAST(cnt As Float) / CAST(SUM(cnt) OVER() AS float) * 100,0) prc
        FROM (
        SELECT a.QuestionID,COUNT(*) cnt
        FROM SV_vSurvey_Answers a
        LEFT OUTER JOIN SV_tSurveyForms_15 f ON f.FormID=a.FormID
        WHERE 2=2 AND a.QuestionID BETWEEN 6700 AND 6799
        GROUP BY a.QuestionID
        ) a),
        CTE1 AS (SELECT Top 3 QuestionID FROM CTE ORDER BY prc DESC)
       SELECT '2013' s,cte.QuestionID,q.Question,cte.prc,CASE WHEN CTE1.QuestionID IS NULL THEN CAST(CTE.prc AS nvarchar(5)) ELSE '{LabelBackColor=LightBlue|LabelBorderWidth=15|LabelBorderColor=LightBlue|Color=LightBlue}' + CAST(CTE.prc AS nvarchar(5)) END + '%' As CCnt
         FROM CTE
        LEFT OUTER JOIN (SELECT QuestionID,Question FROM SV_SurQuestions WHERE SurveyID=15) q ON q.QuestionID=cte.QuestionID
        LEFT OUTER JOIN CTE1 ON cte1.QuestionID=CTE.QuestionID
        LEFT OUTER JOIN (SELECT QuestionID,Question FROM SV_SurQuestions WHERE SurveyID=15) q1 ON q1.QuestionID=cte1.QuestionID
	ORDER BY prc
      </Query>
      <Params>
        <Param Name="@Frames" Repl="2" Prefix="f">[P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="המאפיינים הפחות הבולטים בתרבות הארגונית" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR" MinY="0" MaxY="40">
      <Name>המאפיינים הפחות הבולטים בתרבות הארגונית</Name>
      <Type>Column</Type>
      <Query keyColumn="s" pivotNameColumn="Question" pivotValueColumn="prc" AdditionalHeaderTextColumn="CCnt">
        WITH CTE AS (
        SELECT a.QuestionID,ROUND(CAST(cnt As Float) / CAST(SUM(cnt) OVER() AS float) * 100,0) prc
        FROM (
        SELECT a.QuestionID,COUNT(*) cnt
        FROM SV_vSurvey_Answers a
        LEFT OUTER JOIN SV_tSurveyForms_15 f ON f.FormID=a.FormID
        WHERE 2=2 AND a.QuestionID BETWEEN 6800 AND 6899
        GROUP BY a.QuestionID
        ) a),
        CTE1 AS (SELECT Top 3 QuestionID FROM CTE ORDER BY prc DESC)
        SELECT '2013' s,cte.QuestionID,q.Question,cte.prc,CASE WHEN CTE1.QuestionID IS NULL THEN CAST(CTE.prc AS nvarchar(5)) ELSE '{LabelBackColor=LightBlue|LabelBorderWidth=15|LabelBorderColor=LightBlue|Color=LightBlue}' + q1.Question + '\n' + CAST(CTE.prc AS nvarchar(5)) END + '%' As CCnt
        FROM CTE
        LEFT OUTER JOIN (SELECT QuestionID,Question FROM SV_SurQuestions WHERE SurveyID=15) q ON q.QuestionID=cte.QuestionID
        LEFT OUTER JOIN CTE1 ON cte1.QuestionID=CTE.QuestionID
        LEFT OUTER JOIN (SELECT QuestionID,Question FROM SV_SurQuestions WHERE SurveyID=15) q1 ON q1.QuestionID=cte1.QuestionID
      </Query>
      <Params>
       <Param Name="@Frames" Repl="2" Prefix="f">[P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="עוצמות המסגרת - ההיגדים שנמצאו הגבוהים ביותר" MinY="0" MaxY="5" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>עוצמות המסגרת - ההיגדים שנמצאו הגבוהים ביותר</Name>
      <Type>Bar</Type>
      <Query keyColumn="s" pivotNameColumn="Question" pivotValueColumn="rslt">
	WITH CTE AS (
        SELECT TOP 7 a.FrameName s,a.QuestionID,q.Question,ROUND(AVG(CAST(val AS float)),2) rslt,'a' s1
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN SV_SurQuestions q ON q.QuestionID=a.QuestionID AND a.SurveyID=q.SurveyID
        WHERE a.SurveyID=15 AND 2=2 AND a.QuestionID!=59
        GROUP BY a.QuestionID,q.Question,FrameName
        Order By AVG(CAST(val AS float)) DEsc)
        SELECT * FROM (
	SELECT * FROM CTE
	UNION ALL
        SELECT 'ארגוני' s,a.QuestionID,q.Question,ROUND(AVG(CAST(val AS float)),2) rslt,'b' s1
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN SV_SurQuestions q ON q.QuestionID=a.QuestionID AND a.SurveyID=q.SurveyID
        WHERE a.SurveyID=15 AND a.QuestionID!=59 AND a.questionID IN (SELECT QuestionID FROM CTE)
        GROUP BY a.QuestionID,q.Question
        ) a
        ORDER BY s1,rslt
      </Query>
      <Params>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="הזדמנויות לשיפור- ההיגדים שנמצאו הנמוכים ביותר" MinY="0" MaxY="5" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>הזדמנויות לשיפור- ההיגדים שנמצאו הנמוכים ביותר</Name>
      <Type>Bar</Type>
      <Query keyColumn="s" pivotNameColumn="Question" pivotValueColumn="rslt">
	WITH CTE AS (
        SELECT TOP 7 a.FrameName s,a.QuestionID,q.Question,ROUND(AVG(CAST(val AS float)),2) rslt,'a' s1
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN SV_SurQuestions q ON q.QuestionID=a.QuestionID AND a.SurveyID=q.SurveyID
        WHERE a.SurveyID=15 AND 2=2 AND a.QuestionID!=59
        GROUP BY a.QuestionID,q.Question,FrameName
        Order By AVG(CAST(val AS float)))
        SELECT * FROM (
	SELECT * FROM CTE
	UNION ALL
        SELECT 'ארגוני' s,a.QuestionID,q.Question,ROUND(AVG(CAST(val AS float)),2) rslt,'b' s1
        FROM SV_TblAnswers_15 a
        LEFT OUTER JOIN SV_SurQuestions q ON q.QuestionID=a.QuestionID AND a.SurveyID=q.SurveyID
        WHERE a.SurveyID=15 AND a.QuestionID!=59 AND a.questionID IN (SELECT QuestionID FROM CTE)
        GROUP BY a.QuestionID,q.Question
        ) a
        ORDER BY s1,rslt DESC  
 </Query>
      <Params>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr,SurveysF,Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>הטקסט המלא של שאלות הסקר</Name>
      <Type>URL</Type>
      <Query>
        SurveyQuestionpopup.aspx?s=1=1&amp;g=2
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
  </Charts>
  <Charts SurveyGroupID="3" SubGroup="1" ConnectionString="Book10VPS">
    <OrganizationalData>
      <Avg AvgType="1"></Avg>
      <Avg AvgType="2"></Avg>
    </OrganizationalData>
    <SelectionControls>
      <Control ID="DSServices" Type="sql" Scontrol="DDLServices">
        Select ServiceName,ServiceID
        From (Select 'כל האזורים' As ServiceName,0 as ServiceID
        UNION All
        SELECT ServiceName, ServiceID
        FROM ServiceList sl
        WHERE ServiceID in (1,2,3,4) AND ServiceID IN (SELECT DISTINCT ServiceID
        FROM FrameList
        WHERE FrameID IN (SELECT FrameID FROM dbo.p0v_UserFrameList
        WHERE UserID=@UserID))) x
        ORDER BY ServiceID
      </Control>
      <Control ID="DSFrames" Type="sql" Scontrol="DDLFrames">
        Select FrameName,FrameID
        From (Select 'כל המסגרות' As FrameName,'0' as FrameID
        UNION All
        SELECT FrameName,FrameID
        FROM FrameList
        WHERE FrameID IN (SELECT FrameID FROM dbo.p0v_UserFrameList
        WHERE UserID=@UserID) AND ServiceID=@ServiceID) c
      </Control>
      <Control ID="DSProfiles" Type="sql" Scontrol="DDLProfiles">
        SELECT 0 AS CategoryID,'כל המימדים' AS Title UNION ALL Select CategoryID,Title From SV_Survey_Profiles Where Root=17 AND ParentID!=0
      </Control>
      <Control ID="DSSEN" Type="sql" Scontrol="DDLSEN" SurveyID="13">
        SELECT AnswerText,val,Ord FROM (
        SELECT 'כל רמות הותק' AS AnswerText, 0 AS Val,0 AS Ord
        UNION ALL
        SELECT AnswerText,Val,Ord
        FROM SV_SurAnswers
        WHERE SurveyID=13 AND AnsGroup = 2) x
        Order by Val
      </Control>
      <Control ID="DSSEN" Type="sql" Scontrol="DDLSEN" SurveyID="9">
        SELECT 'כל רמות הותק' AS AnswerText, 0 AS Val,0 AS Ord
      </Control>
      <Control ID="DSSEN" Type="sql" Scontrol="DDLSEN" SurveyID="3">
        SELECT 'כל רמות הותק' AS AnswerText, 0 AS Val,0 AS Ord
      </Control>
    </SelectionControls>
    <Criterions>
      <Criterion Name="@Age">(AgeID=@Age)</Criterion>
      <Criterion Name="@Sen">(SenID=@Sen)</Criterion>
      <Criterion Name="@Lakut">(lakutID=@Lakut)</Criterion>
      <Criterion Name="@ServiceType">(ServiceTypeID=@ServiceType)</Criterion>
      <Criterion Name="@Services">(ServiceID=@Services)</Criterion>
      <Criterion Name="@Frames">(Prefix.FrameID=@Frames)</Criterion>
      <Criterion Name="@ServiceID">@ServiceID</Criterion>
      <Criterion Name="@Questions">QuestionID in @Questions</Criterion>
      <Criterion Name="@UserID">Prefix.FrameID in (select frameid from dbo.p0v_UserFrameList where userid=@UserID)</Criterion>
      <Criterion Name="@SurveyGroupID">@SurveyGroupID</Criterion>
      <Criterion Name="@SurveyID">סקר=@SurveyID</Criterion>
      <Criterion Name="@RSurveyID">@RSurveyID</Criterion>
      <Criterion Name="@SurveyGroupName">@SurveyGroupName</Criterion>
      <Criterion Name="@Profiles">(isnull(ProfileID,0) = @Profiles)</Criterion>
    </Criterions>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR">
      <Name>אחוז השבה ארגוני</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ממוצע" pivotValueColumn="prc" AdditionalHeaderTextColumn="cnt" MinY="0" MaxY="100" AvgType="2">
        EXEC SV_pSurveyCount 1=1,1,NULL,NULL
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>אחוזי השבה למסגרת לפי אזור</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="prc" AdditionalHeaderTextColumn="cnt" MinY="0" MaxY="100" AvgType="2">
        EXEC SV_pSurveyCount 1=1,3,2=2,NULL
      </Query>
      <Params>
        <Param Name="@Services" Repl="2" Type="N"/>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr">
      <Name>אחוזי השבה למסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="prc" AdditionalHeaderTextColumn="cnt" MinY="0" MaxY="100" AvgType="2">
        EXEC SV_pSurveyCount 1=1,3,NULL,NULL,'לקוחות',2=2
      </Query>
      <Params>
        <Param Name="@UserID" Repl="2" Type="N"/>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>אחוזי השבה אזורים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="אזור" pivotValueColumn="prc" AdditionalHeaderTextColumn="cnt" MinY="0" MaxY="100" AvgType="2">
        EXEC SV_pSurveyCount 1=1,2,NULL,NULL
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,MPREFERENT,FMNGRTest,Frmngr,fmngr,FullSurveys,SMNGR,MPMNGR">
      <Name>ממוצע ארגוני</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="KK" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT סקר,rslt,'ממוצע' As KK
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר
        FROM	dbo.SV_fnAnswers_3(1=1)
        WHERE 2=2
        GROUP BY ShortDescription) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@RSurveyID" />
        <Param Name="@ServiceType" Repl="2">שירות: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Profiles" Repl="2">מימד: [P]</Param>
        <Param Name="@Questions" Repl="2">שאלה: [P]</Param>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr">
      <Name>ממוצע למסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT rslt,סקר,מסגרת
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,FrameName AS מסגרת
        FROM	dbo.SV_fnAnswers_3x(1=1,3=3,NULL,NULL)
        WHERE 2=2
        GROUP BY ShortDescription,FrameName ) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@UserID" Repl="3" Type="N" />
        <Param Name="@RSurveyID" />
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Profiles" Repl="2">מימד: [P]</Param>
        <Param Name="@Questions" Repl="2">שאלה: [P]</Param>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי אזורים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="אזור" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT rslt,סקר,אזור
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,ServiceName AS אזור
        FROM	dbo.SV_fnAnswers_3(1=1)
        WHERE 2=2
        GROUP BY ShortDescription,ServiceName ) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Profiles" Repl="2">מימד: [P]</Param>
        <Param Name="@Questions" Repl="2">שאלה: [P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי מסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT rslt,סקר,מסגרת
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,FrameName AS מסגרת
        FROM	dbo.SV_fnAnswers_3(1=1)
        WHERE 2=2
        GROUP BY ShortDescription,FrameName ) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param> 
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Profiles" Repl="2">מימד: [P]</Param>
        <Param Name="@Questions" Repl="2">שאלה: [P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי מימדים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מימד" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT rslt,סקר,מימד
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,Profile AS מימד
        FROM	dbo.SV_fnAnswers_3(1=1)
        WHERE 2=2
        GROUP BY ShortDescription,Profile ) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@RSurveyID" />
        <Param Name="@ServiceType" Repl="2">שירות: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr">
      <Name>ממוצע לפי מימדים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מימד" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT rslt,סקר,מימד
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,Profile AS מימד
        FROM	dbo.SV_fnAnswers_3x(1=1,3=3,NULL,NULL)
        WHERE 2=2
        GROUP BY ShortDescription,Profile ) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@UserID" Repl="3" Type="N" />
        <Param Name="@RSurveyID" />
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי שאלות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="שאלה" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT rslt,שאלה,סקר
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt, QuestionID AS שאלה,ShortDescription AS סקר
        FROM	dbo.SV_fnAnswers_3(1=1)
        WHERE 2=2
        GROUP BY ShortDescription,QuestionID ) x
        ORDER BY ISNULL(סקר,'') DESC,שאלה DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@Services" Repl="2" />
        <Param Name="@Frames" Repl="2" />
        <Param Name="@ServiceType" Repl="2">שירות: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Questions" Repl="2" /><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr">
      <Name>ממוצע לפי שאלות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="שאלה" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT rslt,שאלה,סקר
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt, QuestionID AS שאלה,ShortDescription AS סקר
        FROM	dbo.SV_fnAnswers_3x(1=1,3=3,NULL,NULL)
        WHERE 2=2
        GROUP BY ShortDescription,QuestionID ) x
        ORDER BY ISNULL(סקר,'') DESC,שאלה DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@UserID" Repl="3" Type="N" />
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Questions" Repl="2" /><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי שירות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="שירות" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT rslt,סקר,שירות
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,ServiceType AS שירות
        FROM	dbo.SV_fnAnswers_3(1=1)
        WHERE 2=2
        GROUP BY ShortDescription,ServiceType ) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Profiles" Repl="2">מימד: [P]</Param>
        <Param Name="@Questions" Repl="2" /><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי לקות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="לקות" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT rslt,סקר,לקות
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,Lakut AS לקות
        FROM	dbo.SV_fnAnswers_3(1=1)
        WHERE 2=2
        GROUP BY ShortDescription,Lakut) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Profiles" Repl="2">מימד: [P]</Param>
        <Param Name="@Questions" Repl="2" /><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי קבוצת גיל</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="גיל" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT rslt,סקר,גיל
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,Age AS גיל
        FROM	dbo.SV_fnAnswers_3(1=1)
        WHERE Age IS NOT NULL AND 2=2
        GROUP BY ShortDescription,Age) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@ServiceType" Repl="2">שירות: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Profiles" Repl="2">מימד: [P]</Param>
        <Param Name="@Questions" Repl="2" /><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי ותק</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ותק" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT rslt,סקר,ותק
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,SEN AS ותק
        FROM	dbo.SV_fnAnswers_3(1=1)
        WHERE SEN IS NOT NULL AND 2=2
        GROUP BY ShortDescription,SEN) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@ServiceType" Repl="2">שירות: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Profiles" Repl="2">מימד: [P]</Param>
        <Param Name="@Questions" Repl="2" /><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr">
      <Name>ממוצע לפי ותק</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ותק" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1">
        SELECT rslt,סקר,ותק
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,SEN AS ותק
        FROM	dbo.SV_fnAnswers_3x(1=1,3=3,NULL,NULL)
        WHERE SEN IS NOT NULL AND 2=2
        GROUP BY ShortDescription,SEN) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@UserID" Repl="3" Type="N" />
        <Param Name="@Profiles" Repl="2">מימד: [P]</Param>
        <Param Name="@Questions" Repl="2" /><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>התפלגות "האם היית ממליץ לאדם אחר.."</Name>
      <Type>Column</Type>
      <Query keyColumn="sDesc" pivotNameColumn="T" pivotValueColumn="prc" MinY="0" MaxY="100" AvgType="2">
        SELECT ROUND(SUM(cF) * 100,0) AS prc,ShortDescription as sDesc,T
        FROM (
        Select CAST(COUNT(*) AS float)/CAST(COUNT(*) OVER() AS float) AS cF,SurveyID,Val,f.FrameID
        FROM SV_vSurvey_Answers a
        LEFT OUTER JOIN SV_vSurveyForms f ON f.FormID=a.FormID
        WHERE SurveyID=1=1 and QuestionID=16 AND 2=2
        GROUP BY SurveyID,Val,a.FOrmID,f.FrameID) a
        RIGHT OUTER JOIN (SELECT NULL As CID,'לא ענו' AS T
        UNION ALL
        SELECT 1 As CID,'כן' AS T
        UNION ALL
        SELECT 2 As CID,'לא' AS T) r ON ISNULL(a.Val,0)=ISNULL(r.CID,0)
        LEFT OUTER JOIN SV_Surveys s ON s.SurveyID=a.SUrveyID
        LEFT OUTER JOIN FrameList fr ON fr.FrameID=a.FrameID
        GROUP BY ShortDescription,T
      </Query>
      <Params>
        <Param Name="@Services" Repl="2"/>
        <Param Name="@Frames" Repl="2" Prefix="f"/>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr">
      <Name>התפלגות "האם היית ממליץ לאדם אחר.."</Name>
      <Type>Column</Type>
      <Query keyColumn="sDesc" pivotNameColumn="T" pivotValueColumn="prc" MinY="0" MaxY="100" AvgType="2">
        SELECT ROUND(SUM(cF) * 100,0) AS prc,ShortDescription as sDesc,T
        FROM (
        Select CAST(COUNT(*) AS float)/CAST(COUNT(*) OVER() AS float) AS cF,SurveyID,Val
        FROM SV_vSurvey_Answers a
        LEFT OUTER JOIN SV_vSurveyForms f ON f.FormID=a.FormID
        WHERE SurveyID=1=1 and QuestionID=16 AND 2=2
        GROUP BY SurveyID,Val,a.FOrmID) a
        RIGHT OUTER JOIN (SELECT NULL As CID,'לא ענו' AS T
        UNION ALL
        SELECT 1 As CID,'כן' AS T
        UNION ALL
        SELECT 2 As CID,'לא' AS T) r ON ISNULL(a.Val,0)=ISNULL(r.CID,0)
        LEFT OUTER JOIN SV_Surveys s ON s.SurveyID=a.SUrveyID
        GROUP BY ShortDescription,T
      </Query>
      <Params>
        <Param Name="@UserID" Repl="2" Prefix="f"/>
        <Param Name="@RSurveyID"/>
        <Param Name="@Frames" Repl="2" Prefix="f"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr,SurveysF,Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>רשימת הטקסטים החופשיים במסגרת</Name>
      <Type>URL</Type>
      <Query>
        SurveyTexts.aspx?sg=1=1&amp;T=2=2&amp;sb=1&amp;r=רשימת הטקסטים החופשיים&amp;s=3=3
      </Query>
      <Params>
        <Param Name="@RSurveyID" Repl="3" Conc=""/>
        <Param Name="@SurveyGroupID" Repl="1" Conc=""/>
        <Param Name="@SurveyGroupName" Repl="2" Conc=""/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr,SurveysF,Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>הטקסט המלא של שאלות הסקר</Name>
      <Type>URL</Type>
      <Query>
        SurveyQuestionpopup.aspx?s=1=1&amp;g=1
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
  </Charts>
  <Charts SurveyGroupID="3" SubGroup="2" ConnectionString="Book10VPS">
    <OrganizationalData>
      <Avg AvgType="1"></Avg>
      <Avg AvgType="2"></Avg>
    </OrganizationalData>
    <SelectionControls>
      <Control ID="DSServiceID" Type="sql" Scontrol="DDLServiceID">
        Select ServiceName,ServiceID
        From (Select 'כל האזורים' As ServiceName,0 as ServiceID
        UNION All
        SELECT ServiceName, ServiceID
        FROM ServiceList sl
        WHERE ServiceID in (1,2,3,4) AND ServiceID IN (SELECT DISTINCT ServiceID
        FROM FrameList
        WHERE FrameID IN (SELECT FrameID FROM dbo.p0v_UserFrameList
        WHERE UserID=@UserID))) x
        ORDER BY ServiceID
      </Control>
      <Control ID="DSFrameID" Type="sql" Scontrol="DDLFrameID">
        Select FrameName,FrameID
 
        FROM FrameList
where frameID=25
      </Control>
      <Control ID="DSProfileID" Type="sql" Scontrol="DDLProfileID" SurveyID="16">
        SELECT 0 AS CategoryID,'כל המימדים' AS Title UNION ALL Select CategoryID,Title From SV_Survey_Profiles Where SurveyID=16
      </Control>
      <Control ID="DSSENID" Type="sql" Scontrol="DDLSENID" SurveyID="13">
        SELECT AnswerText,val,Ord FROM (
        SELECT 'כל רמות הותק' AS AnswerText, 0 AS Val,0 AS Ord
        UNION ALL
        SELECT AnswerText,Val,Ord
        FROM SV_SurAnswers
        WHERE SurveyID=13 AND AnsGroup = 2) x
        Order by Val
      </Control>
      <Control ID="DSSENID" Type="sql" Scontrol="DDLSENID" SurveyID="9">
        SELECT 'כל רמות הותק' AS AnswerText, 0 AS Val,0 AS Ord
      </Control>
      <Control ID="DSSENID" Type="sql" Scontrol="DDLSENID" SurveyID="16">
        SELECT AnswerText,val,Ord FROM (
        SELECT 'כל רמות הותק' AS AnswerText, 0 AS Val,0 AS Ord
        UNION ALL
        SELECT AnswerText,Val,Ord
        FROM SV_SurAnswers
        WHERE SurveyID=16 AND AnsGroup = 2) x
        Order by Val
      </Control>
    </SelectionControls>
    <Criterions>
      <Criterion Name="@Age">(AgeID=@Age)</Criterion>
      <Criterion Name="@Sen">(SenID=@Sen)</Criterion>
      <Criterion Name="@Lakut">(lakutID=@Lakut)</Criterion>
      <Criterion Name="@ServiceType">(ServiceTypeID=@ServiceType)</Criterion>
      <Criterion Name="@Services">(ServiceID=@Services)</Criterion>
      <Criterion Name="@Frames">(Prefix.FrameID=@Frames)</Criterion>
      <Criterion Name="@ServiceID">@ServiceID</Criterion>
      <Criterion Name="@Questions">QuestionID in @Questions</Criterion>
      <Criterion Name="@UserID">Prefix.FrameID in (select frameid from dbo.p0v_UserFrameList where userid=@UserID)</Criterion>
      <Criterion Name="@SurveyGroupID">@SurveyGroupID</Criterion>
      <Criterion Name="@SurveyID">סקר=@SurveyID</Criterion>
      <Criterion Name="@RSurveyID">@RSurveyID</Criterion>
      <Criterion Name="@SurveyGroupName">@SurveyGroupName</Criterion>
      <Criterion Name="@Profiles">@Profiles</Criterion>
    </Criterions>
    <Chart Name="כותרות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>כותרות</Name>
      <Type>Img</Type>
      <Query>
        SELECT
        [filename]
        FROM [SV_DispImages]
        Where SlideID={SlideID}
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">[P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="1" Name="ציון כללי לפי תחום" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ציון כללי לפי תחום</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="תחום" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,תחום,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי תחומים

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS תחום,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS תחום,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        ) x
        Group by תחום,סקר
        ORDER By תחום,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="1" Name="ציון כללי לפי תחום ואזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ציון כללי לפי תחום ואזור</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="תחום" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,תחום,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי תחומים

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS תחום,'C' + ServiceType S,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        --  לפי אזור

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceName AS אזור,'B' S,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS תחום,'A' S,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by תחום,סקר,S
        ORDER By S,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="2" Name="ציון כללי לפי ותק" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ציון כללי לפי ותק</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ותק" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,ותק,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי ותק

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ISNULL(SEN,'לא צויין') AS ותק,ISNULL(SenID,99) AS SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS ותק,NULL AS SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        ) x
        Group by ותק,סקר,SenID
        ORDER By SenID,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="2" Name="ציון כללי לפי ותק ואזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ציון כללי לפי ותק ואזור</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ותק" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,ותק,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי ותק

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ISNULL(SEN,'לא צויין') AS ותק,ISNULL(SenID,99) AS SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        --  לפי אזור

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceName AS אזור,0 AS SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS ותק,-1 AS SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by ותק,סקר,SenID
        ORDER By SenID,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="3" Name="ציון כללי לפי אזור ותחום " UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ציון כללי לפי אזור ותחום</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="אזור" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,אזור,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי תחומים

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS אזור,FormID,'aa' as s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        --  לפי אזורים

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceName AS אזור,FormID,ServiceName As s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS אזור,FormID,'a' as s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by אזור,סקר,s
        ORDER By s,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="3" Name="ציון כללי לפי אזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ציון כללי לפי אזור</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="אזור" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,אזור,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי אזורים

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceName AS אזור,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS אזור,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by אזור,סקר
        ORDER By Case אזור WHEN 'ארגוני' THEN '' ELSE אזור END,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="3" Name="ציון כללי לפי מסגרת" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ציון כללי לפי מסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרות

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,frameName AS מסגרת,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        --  לפי אזור

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceName AS אזור,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by מסגרת,סקר
        ORDER By Case מסגרת WHEN 'ארגוני' THEN '' WHEN 'חטיבה טיפולית' THEN '1' WHEN 'אזור שרון צפון' THEN '1' WHEN 'איזור מרכז דרום' THEN '1' ELSE מסגרת END,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="3" Name="ציון כללי לפי מסגרת ותחום" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ציון כללי לפי מסגרת ותחום</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרות

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,frameName AS מסגרת,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE FrameID=25
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS אזור,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE ServiceTypeID=3
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by מסגרת,סקר
        ORDER By Case מסגרת WHEN 'ארגוני' THEN '' WHEN 'חינוך' THEN '1' ELSE מסגרת END,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="3" Name="ציון כללי המסגרות ללא המעונות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ציון כללי המסגרות ללא המעונות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרות

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,frameName AS מסגרת,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=4) c ON c.Fid=a.FrameID
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS אזור,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by מסגרת,סקר
        ORDER By Case מסגרת WHEN 'ארגוני' THEN '' ELSE מסגרת END,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="3" Name="ציון כללי שלונסקי/ליבריה/הנרקיסים" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ציון כללי שלונסקי/ליבריה/הנרקיסים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרות

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,frameName AS מסגרת,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=2) c ON c.Fid=a.FrameID
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS אזור,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by מסגרת,סקר
        ORDER By Case מסגרת WHEN 'ארגוני' THEN '' ELSE מסגרת END,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="3" Name="ציון כללי הוסטלים אחרים" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ציון כללי הוסטלים אחרים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf

        --  לפי מסגרות

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,frameName AS מסגרת,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=3) c ON c.Fid=a.FrameID
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS אזור,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by מסגרת,סקר
        ORDER By Case מסגרת WHEN 'ארגוני' THEN '' ELSE מסגרת END,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="3" Name="ציון כללי מעונות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ציון כללי מעונות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרות

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,frameName AS מסגרת,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=1) c ON c.Fid=a.FrameID
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS אזור,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by מסגרת,סקר
        ORDER By Case מסגרת WHEN 'ארגוני' THEN '' ELSE מסגרת END,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="1" Name="ציון כללי לפי לקות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ציון כללי לפי לקות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="לקות" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,לקות,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי לקות

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,Lakut AS לקות,'C' + Lakut As S,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS לקות,'aa' as s,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS לקות,'A' As S,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by לקות,סקר,S
        ORDER By S,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="1" Name="ציון כללי לפי לקות ואזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ציון כללי לפי לקות ואזור</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="לקות" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,לקות,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי לקות

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,Lakut AS לקות,'C' + Lakut As S,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        --  לפי אזור

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceName AS אזור,'B' AS S,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS לקות,'A' As S,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by לקות,סקר,S
        ORDER By S,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="אחוזי השבה ארגוני" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>אחוזי השבה ארגוני</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="מענה" pivotNameColumn="סקר" pivotValueColumn="Cnt" MinY="0" MaxY="100" AdditionalHeaderTextColumn="CCnt">
        SELECT סקר,מענה,Cnt,CAST(Cnt AS nvarchar(10)) + '\nמ-' +  + CAST(c as nvarchar(5))  + '\n(' + CAST(ROUND(CAST(cnt As float) / CAST(SCnt As float) * 100,0) AS nvarchar(5)) + '%)' AS CCnt
        FROM (
        SELECT 'ארגוני' AS Col,Survey + ' ארגוני' סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s1,'א' S2
        FROM SV_tblCount_16
        GROUP BY Survey
        UNION ALL
        SELECT 'ארגוני' AS Col,Survey + ' ארגוני' סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s1,'א' S2
        FROM SV_tblCount_16
        GROUP BY Survey) a Order By s1 Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="אחוז השבה לפי אזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>אחוזי השבה לפי אזור</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="מענה" pivotNameColumn="סקר" pivotValueColumn="Cnt" MinY="0" MaxY="100" AdditionalHeaderTextColumn="CCnt">
        SELECT סקר,מענה,Cnt,CAST(Cnt AS nvarchar(10)) + '\nמ-' +  + CAST(c as nvarchar(5))  + '\n(' + CAST(ROUND(CAST(cnt As float) / CAST(SCnt As float) * 100,0) AS nvarchar(5)) + '%)' AS CCnt
        FROM (

        SELECT ServiceName AS Col,Survey + ' ' + ServiceName סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2, ServiceName s1
        FROM SV_tblCount_16
        where ServiceID in (1,3,4)
        GROUP BY Survey,ServiceName
        UNION ALL
        SELECT ServiceName AS Col,Survey + ' ' + ServiceName סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2, ServiceName s1
        FROM SV_tblCount_16
        where ServiceID in (1,3,4)
        GROUP BY Survey,ServiceName

        UNION ALL

        SELECT 'ארגוני' AS Col,Survey + ' ארגוני' סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s2,'א' S1
        FROM SV_tblCount_16
        GROUP BY Survey
        UNION ALL
        SELECT 'ארגוני' AS Col,Survey + ' ארגוני' סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s2,'א' S1
        FROM SV_tblCount_16
        GROUP BY Survey
        ) a Order By Col,סקר Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="אחוז השבה לפי תחום" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>אחוזי השבה לפי תחום</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="מענה" pivotNameColumn="סקר" pivotValueColumn="Cnt" MinY="0" MaxY="100" AdditionalHeaderTextColumn="CCnt">
        SELECT סקר,מענה,Cnt,CAST(Cnt AS nvarchar(10)) + '\nמ-' +  + CAST(c as nvarchar(5))  + '\n(' + CAST(ROUND(CAST(cnt As float) / CAST(SCnt As float) * 100,0) AS nvarchar(5)) + '%)' AS CCnt
        FROM (

        SELECT ServiceType AS Col,Survey + ' ' + ServiceType סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2,ServiceType s1
        FROM SV_tblCount_16
        where ServiceID in (1,3,4) And ServiceType IS NOT NULL
        GROUP BY Survey,ServiceType
        UNION ALL
        SELECT ServiceType AS Col,Survey + ' ' + ServiceType סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2,ServiceType s1
        FROM SV_tblCount_16
        where 2=2 And ServiceType IS NOT NULL
        GROUP BY Survey,ServiceType

        UNION ALL

        SELECT 'ארגוני' AS Col,Survey + ' ארגוני' סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s2,'ארגוני' S1
        FROM SV_tblCount_16
        GROUP BY Survey
        UNION ALL
        SELECT 'ארגוני' AS Col,Survey + ' ארגוני' סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s2,'ארגוני' S1
        FROM SV_tblCount_16
        GROUP BY Survey

        ) a Order By s1,S2 Desc,מענה Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="אחוז השבה לפי תחום ואזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>אחוזי השבה לפי תחום ואזור</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="מענה" pivotNameColumn="סקר" pivotValueColumn="Cnt" MinY="0" MaxY="100" AdditionalHeaderTextColumn="CCnt">
        SELECT סקר,מענה,Cnt,CAST(Cnt AS nvarchar(10)) + '\nמ-' +  + CAST(c as nvarchar(5))  + '\n(' + CAST(ROUND(CAST(cnt As float) / CAST(SCnt As float) * 100,0) AS nvarchar(5)) + '%)' AS CCnt
        FROM (

        SELECT ServiceType AS Col,Survey + ' ' + ServiceType סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2,ServiceType s1
        FROM SV_tblCount_16
        where ServiceID in (1,3,4) And ServiceType IS NOT NULL AND 2=2
        GROUP BY Survey,ServiceType
        UNION ALL
        SELECT ServiceType AS Col,Survey + ' ' + ServiceType סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2,ServiceType s1
        FROM SV_tblCount_16
        where ServiceID in (1,3,4) And 2=2 And ServiceType IS NOT NULL
        GROUP BY Survey,ServiceType

        UNION ALL

        SELECT ServiceName AS Col,Survey + ' ' + ServiceName סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2, 'אא' s1
        FROM SV_tblCount_16
        where ServiceID in (1,3,4) AND 2=2
        GROUP BY Survey,ServiceName
        UNION ALL
        SELECT ServiceName AS Col,Survey + ' ' + ServiceName סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2, 'אא' s1
        FROM SV_tblCount_16
        where ServiceID in (1,3,4) AND 2=2
        GROUP BY Survey,ServiceName

        UNION ALL

        SELECT 'ארגוני' AS Col,Survey + ' ארגוני' סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s2,'א' S1
        FROM SV_tblCount_16
        GROUP BY Survey
        UNION ALL
        SELECT 'ארגוני' AS Col,Survey + ' ארגוני' סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s2,'א' S1
        FROM SV_tblCount_16
        GROUP BY Survey

        ) a Order By s1,S2 Desc,מענה Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="אחוז השבה לפי לקות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>אחוזי השבה לפי לקות</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="מענה" pivotNameColumn="סקר" pivotValueColumn="Cnt" MinY="0" MaxY="100" AdditionalHeaderTextColumn="CCnt">
        SELECT סקר,מענה,Cnt,CAST(Cnt AS nvarchar(10)) + '\nמ-' +  + CAST(c as nvarchar(5))  + '\n(' + CAST(ROUND(CAST(cnt As float) / CAST(SCnt As float) * 100,0) AS nvarchar(5)) + '%)' AS CCnt
        FROM (

        SELECT Lakut AS Col,Survey + ' ' + Lakut סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2,Lakut s1
        FROM SV_tblCount_16
        where ServiceID in (1,3,4) And Lakut IS NOT NULL
        GROUP BY Survey,Lakut
        UNION ALL
        SELECT Lakut AS Col,Survey + ' ' + Lakut סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2,Lakut s1
        FROM SV_tblCount_16
        where ServiceID in (1,3,4) And Lakut IS NOT NULL
        GROUP BY Survey,Lakut

        UNION ALL

        SELECT 'ארגוני' AS Col,Survey + ' ארגוני' סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s2,'א' S1
        FROM SV_tblCount_16
        GROUP BY Survey
        UNION ALL
        SELECT 'ארגוני' AS Col,Survey + ' ארגוני' סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s2,'א' S1
        FROM SV_tblCount_16
        GROUP BY Survey

        ) a Order By s1,S2 Desc,מענה Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="4" Name="אחוז השבה לפי מסגרת" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>אחוזי השבה לפי מסגרת</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="מענה" pivotNameColumn="סקר" pivotValueColumn="Cnt" MinY="0" MaxY="100" AdditionalHeaderTextColumn="CCnt">
        SELECT סקר,מענה,Cnt,CAST(Cnt AS nvarchar(5)) + '\nמ-' + CAST(c as nvarchar(5))  + '\n(' + CAST(ROUND(CAST(cnt As float) / CAST(SCnt As float) * 100,0) AS nvarchar(5)) + '%)' AS CCnt
        FROM (

        SELECT FrameName AS Col,Survey + ' ' + FrameName סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey S2,FrameName S1
        FROM SV_tblCount_16
        where FrameID NOT IN(36,37,117) AND FrameID=25
        GROUP BY Survey,FrameName
        UNION ALL
        SELECT FrameName AS Col,Survey + ' ' + FrameName סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,survey S2,FrameName S1
        FROM SV_tblCount_16
        where FrameID NOT IN(36,37,117) AND FrameID=25
        GROUP BY Survey,FrameName

        UNION ALL

        SELECT 'ארגוני' AS Col,Survey + ' ארגוני' סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s2,'א' S1
        FROM SV_tblCount_16
        GROUP BY Survey
        UNION ALL
        SELECT 'ארגוני' AS Col,Survey + ' ארגוני' סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s2,'א' S1
        FROM SV_tblCount_16
        GROUP BY Survey

        UNION ALL

        SELECT ServiceType AS Col,Survey + ' ' + ServiceType סקר, 'ענו' מענה ,SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s2,'אא' s1
        FROM SV_tblCount_16
        where ServiceID in (1,3,4) AND ServiceTypeID=3
        GROUP BY Survey,ServiceType
        UNION ALL
        SELECT ServiceType AS Col,Survey + ' ' + ServiceType סקר, 'לא ענו' מענה, SUM(cnt)-SUM(Acnt) Cnt,SUM(Cnt) As SCnt,SUM(Cnt) as c,Survey s2,'אא' s1
        FROM SV_tblCount_16
        where ServiceID in (1,3,4) AND ServiceTypeID=3
        GROUP BY Survey,ServiceType

        ) a Order By s1,S2 DESC,מענה Desc
    </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="6" Name="שביעות רצון כללית לפי תחום" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית לפי תחום</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="תחום" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,תחום,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי תחומים

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS תחום
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE Val IS NOT NULL AND 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS תחום
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE Val IS NOT NULL
        ) x
        Group by תחום,סקר
        ORDER By תחום,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="6" Name="שביעות רצון כללית לפי תחום ואזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית לפי תחום ואזור</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="תחום" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,תחום,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי תחומים

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS תחום,ShortDescription As s2,ServiceType As s1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND 2=2
        UNION ALL

        --  לפי אזורים

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription סקר,ServiceName As תחום,ShortDescription as S2,'אא' S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS תחום,ShortDescription as s2,'א' As s1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by תחום,סקר,s1,s2
        ORDER By s1,s2 DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="שביעות רצון כללית לפי אזור ותחום" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית לפי אזור ותחום</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="אזור" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,אזור,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי אזורים

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceName AS אזור,FormID,ServiceName s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        --  לפי ,juo

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS אזור,FormID,'aa' as s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS אזור,FormID,'a' as s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by אזור,סקר,s
        ORDER By s,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="שביעות רצון כללית לפי אזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית לפי אזור</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="אזור" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,אזור,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי אזורים

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceName AS אזור,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS אזור,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by אזור,סקר
        ORDER By Case אזור WHEN 'ארגוני' THEN '' ELSE אזור END,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="שביעות רצון כללית לפי מסגרת" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית לפי מסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרתים

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,FrameName AS מסגרת,ShortDescription as S2,FrameName AS S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        --  לפי אזורים

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceName AS אזור,ShortDescription as S2,'aa' AS S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,ShortDescription as S2,'a' AS S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by מסגרת,סקר,s1,s2
        ORDER By s1,s2 desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="שביעות רצון כללית לפי מסגרת ותחום" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית לפי מסגרת ותחום</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרתים

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,FrameName AS מסגרת,ShortDescription as S2,FrameName AS S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  FrameID=25
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS אזור,ShortDescription as S2,'aa' AS S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  ServiceTypeID=3
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,ShortDescription as S2,'a' AS S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by מסגרת,סקר,s1,s2
        ORDER By s1,s2 desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="שביעות רצון כללית מסגרות ללא המעונות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית מסגרות ללא המעונות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרתים

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,FrameName AS מסגרת,FormID,FramenAME AS S
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=4) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS אזור,FormID,'aa' as s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,FormID,'a' s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by מסגרת,סקר,s
        ORDER By s,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="שביעות רצון כללית שלונסקי/ליבריה/הנרקיסים" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית שלונסקי/ליבריה/הנרקיסים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרתים

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,FrameName AS מסגרת,FormID,FrameName s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=2) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND 2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS אזור,FormID,'aa' as s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,FormID,'a' s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        Val IS NOT NULL AND
        ) x
        Group by מסגרת,סקר,s
        ORDER By s,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="שביעות רצון כללית הוסטלים אחרים" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית הוסטלים אחרים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרתים

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,FrameName AS מסגרת,FormID,FrameName s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=3) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS אזור,FormID,'aa' as s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL


        -- ארגוני

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,FormID,'a' s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by מסגרת,סקר,s
        ORDER By s,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="שביעות רצון כללית המעונות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית המעונות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרתים

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,FrameName AS מסגרת,FormID,FrameName s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=1) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS אזור,FormID,'aa' as s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,FormID,'a' s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by מסגרת,סקר,s
        ORDER By s,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="8" Name="שביעות רצון כללית לפי ותק ואזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית לפי ותק ואזור</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ותק" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,ותק,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי ותק

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,CASE WHEN Sen IS NULL THEN 'לא צויין' ELSE Sen END As ותק,ISNULL(SenID,99) SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        --  לפי אזורים

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription סקר,ServiceName As ותק,0 as SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS ותק,NULL As SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by ותק,סקר,SenID
        ORDER By SenID,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="8" Name="שביעות רצון כללית לפי ותק ותחום" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית לפי ותק ותחום</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ותק" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,ותק,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי ותק

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,CASE WHEN Sen IS NULL THEN 'לא צויין' ELSE Sen END As ותק,ISNULL(SenID,99) SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription סקר,ServiceType As ותק,0 as SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS ותק,NULL As SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by ותק,סקר,SenID
        ORDER By SenID,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="8" Name="שביעות רצון כללית לפי ותק" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>שביעות רצון כללית לפי ותק</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ותק" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,ותק,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי אזורים

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,CASE WHEN Sen IS NULL THEN 'לא צויין' ELSE Sen END As ותק,ISNULL(SenID,99) SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID = 101
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS ותק,NULL As SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (101,103)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by ותק,סקר,SenID
        ORDER By SenID,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="6" Name="מימד לפי תחום ואזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מימד לפי תחום ואזור</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="תחום" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,תחום,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי תחומים

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS תחום,ShortDescription S2,ServiceType S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        --  לפי אזורים

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceName AS אזור,ShortDescription S2,'aa' S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS תחום,ShortDescription S2,'a' S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by תחום,סקר,s1,s2
        ORDER By s1,s2 desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Profiles" Repl="3">מימד: [P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="6" Name="מימד לפי תחום" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מימד לפי תחום</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="תחום" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,תחום,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי תחומים

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS תחום,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE Val IS NOT NULL AND 2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS תחום,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE Val IS NOT NULL
        ) x
        Group by תחום,סקר
        ORDER By תחום,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="מימד לפי אזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מימד לפי אזור</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="אזור" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,אזור,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי אזורים

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceName AS אזור,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS אזור,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by אזור,סקר
        ORDER By Case אזור WHEN 'ארגוני' THEN '' ELSE אזור END,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="מימד לפי אזור ותחום" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מימד לפי אזור ותחום</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="אזור" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,אזור,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי אזורים

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceName AS אזור,FormID,ServiceName as s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS אזור,FormID,'aa' as s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS אזור,FormID,'a' s
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by אזור,סקר
        ORDER By s,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="מימד לפי מסגרת" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מימד לפי מסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרות

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,FrameName AS מסגרת,shortDescription S2,FrameName S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        --  לפי אזורים

        SELECT CASE WHEN p.CategoryID IS NULL
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceName AS אזור,shortDescription S2,'aa' S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        LEFT OUTER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,shortDescription S2,'a' S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by מסגרת,סקר,s1,s2
        ORDER By s1,s2 DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="מימד לפי מסגרת ותחום" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מימד לפי מסגרת ותחום</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרות

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,FrameName AS מסגרת,shortDescription S2,FrameName S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  FrameID=25
        UNION ALL

        --  לפי מסגרות

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS מסגרת,shortDescription S2,'aa' s1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  ServiceTypeID=3
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,shortDescription S2,'a' S1,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by מסגרת,סקר,s1,s2
        ORDER By s1,s2 DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="מימד לפי מסגרות ללא המעונות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מימד לפי מסגרות ללא המעונות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרות

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,FrameName AS מסגרת,FormID,ShortDescription s2,FrameName s1
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=4) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS מסגרת,FormID,shortDescription S2,'aa' s1
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,FormID,shortDescription S2,'a' s1
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by מסגרת,סקר,s1,s2
        ORDER By s1,s2 DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="מימד לפי שלונסקי/ליבריה/הנרקיסים" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מימד לפי שלונסקי/ליבריה/הנרקיסים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרות

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,FrameName AS מסגרת,FormID,ShortDescription s2,FrameName s1
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=2) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS מסגרת,FormID,shortDescription S2,'aa' s1
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,FormIDAhrtDescription s2,'a' s1
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by מסגרת,סקר,s1,s2
        ORDER Bys1,s2 DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="מימד לפי הוסטלים אחרים" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מימד לפי הוסטלים אחרים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרות

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,FrameName AS מסגרת,FormID,ShortDescription as s2,FrameName as s1
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=3) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND 2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS מסגרת,FormID,shortDescription S2,'aa' s1
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,FormID,ShortDescription as s2,'a' s1
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL
        ) x
        Group by מסגרת,סקר,s1,s2
        ORDER By s1,s2 DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="7" Name="מימד לפי המעונות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מימד לפי מהמעונות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מסגרת,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי מסגרות

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,FrameName AS מסגרת,FormID,ShortDescription as s2,FraeName as s1
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=1) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND 2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS מסגרת,FormID,shortDescription S2,'aa' s1
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS מסגרת,FormID,ShortDescription as s2,'a' s1
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by מסגרת,סקר,s1,s2
        ORDER By s1,s2 DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="8" Name="מימד לפי ותק" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מימד לפי ותק</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ותק" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,ותק,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי ותק

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,CASE WHEN Sen IS NULL THEN 'לא צויין' ELSE Sen END As ותק,ISNULL(SenID,99) SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS ותק,NULL As SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by ותק,סקר,SenID
        ORDER By SenID,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="8" Name="מימד לפי ותק ואזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מימד לפי ותק ואזור</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ותק" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,ותק,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי ותק

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,CASE WHEN Sen IS NULL THEN 'לא צויין' ELSE Sen END As ותק,ISNULL(SenID,99) SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        --  לפי אזורים

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceName AS אזור,0 As SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS ותק,NULL As SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by ותק,סקר,SenID
        ORDER By SenID,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="8" Name="מימד לפי ותק ותחום" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מימד לפי ותק ותחום</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ותק" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,ותק,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי ותק

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,CASE WHEN Sen IS NULL THEN 'לא צויין' ELSE Sen END As ותק,ISNULL(SenID,99) SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        --  לפי תחום

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,ServiceType AS אזור,0 As SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,'ארגוני' AS ותק,NULL As SenID,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (3=3)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE   Val IS NOT NULL
        ) x
        Group by ותק,סקר,SenID
        ORDER By SenID,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="6" Name="טיב  השירות מול תחושת המשפחה" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>טיב  השירות מול תחושת המשפחה</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מימד" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מימד,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי תחומים

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,pc.Title AS מימד,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (120,121)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        LEFT OUTER JOIN SV_Survey_Profiles pc ON p.CategoryID=pc.CategoryID
        WHERE  Val IS NOT NULL AND  2=2
        --UNION ALL

        -- ארגוני

        --SELECT CASE WHEN p.CategoryID != 103
        --THEN CAST(Val AS float)
        --ELSE CASE ISNULL(Val,0) WHEN 1
        --THEN 5.0
        --ELSE 1.0
        --END
        --END  AS Val,ShortDescription AS סקר,'ארגוני' AS תחום,FormID
        --FROM	dbo.SV_fnAnswers_3(1=1) a
        --INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (120,121)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by מימד,סקר
        ORDER By מימד,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="6" Name="טיב  השירות מול תחושת המשפחה במסגרות ללא המעונות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>טיב  השירות מול תחושת המשפחה במסגרות ללא המעונות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מימד" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מימד,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי תחומים

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,pc.Title AS מימד,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (120,121)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        LEFT OUTER JOIN SV_Survey_Profiles pc ON p.CategoryID=pc.CategoryID
        WHERE  Val IS NOT NULL AND  2=2
        --UNION ALL

        -- ארגוני

        --SELECT CASE WHEN p.CategoryID != 103
        --THEN CAST(Val AS float)
        --ELSE CASE ISNULL(Val,0) WHEN 1
        --THEN 5.0
        --ELSE 1.0
        --END
        --END  AS Val,ShortDescription AS סקר,'ארגוני' AS תחום
        --FROM	dbo.SV_fnAnswers_3(1=1) a
        --INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (120,121)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by מימד,סקר
        ORDER By מימד,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="6" Name="טיב השירות מול תחושת המשפחה בשלונסקי/ליברינ/הנרקיסים" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>טיב השירות מול תחושת המשפחה בשלונסקי/ליברינ/הנרקיסים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מימד" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מימד,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי תחומים

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,pc.Title AS מימד,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=2) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (120,121)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        LEFT OUTER JOIN SV_Survey_Profiles pc ON p.CategoryID=pc.CategoryID
        WHERE  Val IS NOT NULL AND  2=2
        UNION ALL

        -- ארגוני

        --SELECT CASE WHEN p.CategoryID != 103
        --THEN CAST(Val AS float)
        --ELSE CASE ISNULL(Val,0) WHEN 1
        --THEN 5.0
        --ELSE 1.0
        --END
        --END  AS Val,ShortDescription AS סקר,'ארגוני' AS תחום,FormID
        --FROM	dbo.SV_fnAnswers_3(1=1) a
        --INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (120,121)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by מימד,סקר
        ORDER By מימד,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="6" Name="טיב השירות מול תחושת המשפחה בהוסטלים אחרים" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>טיב השירות מול תחושת המשפחה בהוסטלים אחרים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מימד" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מימד,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי תחומים

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,pc.Title AS מימד,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=3) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (120,121)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        LEFT OUTER JOIN SV_Survey_Profiles pc ON p.CategoryID=pc.CategoryID
        WHERE  Val IS NOT NULL AND  2=2
        --UNION ALL

        -- ארגוני

        --SELECT CASE WHEN p.CategoryID != 103
        --THEN CAST(Val AS float)
        --ELSE CASE ISNULL(Val,0) WHEN 1
        --THEN 5.0
        --ELSE 1.0
        --END
        --END  AS Val,ShortDescription AS סקר,'ארגוני' AS תחום,FormID
        --FROM	dbo.SV_fnAnswers_3(1=1) a
        --INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (120,121)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by מימד,סקר
        ORDER By מימד,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="6" Name="טיב השירות מול תחושת המשפחה במעונות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>טיב השירות מול תחושת המשפחה במעונות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מימד" pivotValueColumn="rslt" MinY="0" MaxY="5" AvgType="1" AdditionalHeaderTextColumn="Adf">
        SELECT ROUND(Avg(val),2) rslt,סקר,מימד,CAST(ROUND(Avg(val),2) AS nvarchar(5)) + '\n(N=' + CAST(COUNT(DISTINCT FormID) AS nvarchar(5)) + ')' AS Adf
        FROM (

        --  לפי תחומים

        SELECT CASE WHEN p.CategoryID != 103
        THEN CAST(Val AS float)
        ELSE CASE ISNULL(Val,0) WHEN 1
        THEN 5.0
        ELSE 1.0
        END
        END  AS Val,ShortDescription AS סקר,pc.Title AS מימד,FormID
        FROM	dbo.SV_fnAnswers_3(1=1) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=1) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (120,121)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        LEFT OUTER JOIN SV_Survey_Profiles pc ON p.CategoryID=pc.CategoryID
        WHERE  Val IS NOT NULL AND  2=2
        --UNION ALL

        -- ארגוני

        --SELECT CASE WHEN p.CategoryID != 103
        --THEN CAST(Val AS float)
        --ELSE CASE ISNULL(Val,0) WHEN 1
        --THEN 5.0
        --ELSE 1.0
        --END
        --END  AS Val,ShortDescription AS סקר,'ארגוני' AS תחום,FormID
        --FROM	dbo.SV_fnAnswers_3(1=1) a
        --INNER JOIN (SELECT CategoryID,SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID IN (120,121)) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        ) x
        Group by מימד,סקר
        ORDER By מימד,ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="3">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="9" Name="מענה לשאלת המלצה לפי תחום ואזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מענה לשאלת המלצה לפי תחום ואזור</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="ANS" pivotNameColumn="תחום" pivotValueColumn="Rslt" MinY="0" MaxY="100" AvgType="1">
        WITH CTE AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,ServiceType תחום
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,ServiceType)
        SELECT ANS,ROUND(Rslt,0) Rslt,תחום,סקר,s
        FROM (
        SELECT ANS,SUM(Rslt) AS Rslt,'ארגוני - '+CTE.סקר AS תחום,CTE.סקר,'ארגוני' S
        FROM CTE
        GROUP BY CTE.סקר,ANS
        UNION ALL
        SELECT CTE.ANS,SUM(CTE.Rslt) As Rslt,תחום+' - '+CTE.סקר As תחום,CTE.סקר,תחום S
        FROM CTE
        GROUP BY CTE.סקר,ANS,תחום) a
        Order by S,סקר Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="2">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="9" Name="מענה לשאלת המלצה לפי תחום" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מענה לשאלת המלצה לפי תחום</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="ANS" pivotNameColumn="תחום" pivotValueColumn="Rslt" MinY="0" MaxY="100" AvgType="1">
        WITH CTE AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,ServiceType תחום
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,ServiceType)
        SELECT ANS,ROUND(Rslt,0) Rslt,תחום,סקר,s
        FROM (
        SELECT ANS,SUM(Rslt) AS Rslt,'ארגוני - '+CTE.סקר AS תחום,CTE.סקר,'ארגוני' S
        FROM CTE
        GROUP BY CTE.סקר,ANS
        UNION ALL
        SELECT CTE.ANS,SUM(CTE.Rslt) As Rslt,תחום+' - '+CTE.סקר As תחום,CTE.סקר,תחום S
        FROM CTE
        GROUP BY CTE.סקר,ANS,תחום) a
        Order by S,סקר Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="2">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="10" Name="מענה לשאלת המלצה לפי אזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מענה לשאלת המלצה לפי אזור</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="ANS" pivotNameColumn="אזור" pivotValueColumn="Rslt" MinY="0" MaxY="100" AvgType="1">
        WITH CTE AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,ServiceName אזור
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,ServiceName)
        SELECT ANS,ROUND(Rslt,0) Rslt,אזור,סקר,s
        FROM (
        SELECT ANS,SUM(Rslt) AS Rslt,'ארגוני - '+CTE.סקר AS אזור,CTE.סקר,'ארגוני' S
        FROM CTE
        GROUP BY CTE.סקר,ANS

        UNION ALL

        SELECT CTE.ANS,SUM(CTE.Rslt) As Rslt,אזור+' - '+CTE.סקר As אזוק,CTE.סקר,אזור S
        FROM CTE
        GROUP BY CTE.סקר,ANS,אזור) a
        Order by CASE S WHEN 'ארגוני' THEN'' ELSE S END,סקר Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="2">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="10" Name="מענה לשאלת המלצה לפי מסגרת ואזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מענה לשאלת המלצה לפי מסגרת ואזור</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="ANS" pivotNameColumn="מסגרת" pivotValueColumn="Rslt" MinY="0" MaxY="100" AvgType="1">
        WITH CTE AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,FrameName מסגרת
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,FrameName),
        CTE1 AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,ServiceName תחום
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,ServiceName)
        SELECT ANS,ROUND(Rslt,0) Rslt,מסגרת,סקר,s
        FROM (
        SELECT ANS,SUM(Rslt) AS Rslt,'ארגוני - '+CTE.סקר AS מסגרת,CTE.סקר,'a' s
        FROM CTE
        GROUP BY CTE.סקר,ANS
        UNION ALL
        SELECT ANS,SUM(Rslt) AS Rslt,תחום + ' ' +CTE1.סקר AS ותק,CTE1.סקר,'aa' as s
        FROM CTE1
        GROUP BY CTE1.סקר,ANS,תחום
        UNION ALL
        SELECT CTE.ANS,SUM(CTE.Rslt) As Rslt,מסגרת+' - '+CTE.סקר As אזוק,CTE.סקר,מסגרת s
        FROM CTE
        GROUP BY CTE.סקר,ANS,מסגרת) a
        Order by s,סקר Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="2">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="10" Name="מענה לשאלת המלצה לפי מסגרת ותחום" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מענה לשאלת המלצה לפי מסגרת ותחום</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="ANS" pivotNameColumn="מסגרת" pivotValueColumn="Rslt" MinY="0" MaxY="100" AvgType="1">
        WITH CTE AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,FrameName מסגרת
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE FrameID=25
        group by Val,a.ShortDescription,FrameName),
        CTE1 AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,ServiceType תחום
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE ServiceTypeID=3
        group by Val,a.ShortDescription,ServiceType),
	CTE2 AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,'ארגוני' תחום
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        group by Val,a.ShortDescription,ServiceType)
        SELECT ANS,ROUND(Rslt,0) Rslt,מסגרת,סקר,s
        FROM (
        SELECT ANS,SUM(Rslt) AS Rslt,'ארגוני - '+CTE2.סקר AS מסגרת,CTE2.סקר,'a' s
        FROM CTE2
        GROUP BY CTE2.סקר,ANS
        UNION ALL
        SELECT ANS,SUM(Rslt) AS Rslt,תחום + ' ' +CTE1.סקר AS ותק,CTE1.סקר,'aa' as s
        FROM CTE1
        GROUP BY CTE1.סקר,ANS,תחום
        UNION ALL
        SELECT CTE.ANS,SUM(CTE.Rslt) As Rslt,מסגרת+' - '+CTE.סקר As אזוק,CTE.סקר,מסגרת s
        FROM CTE
        GROUP BY CTE.סקר,ANS,מסגרת) a
        Order by s,סקר Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="2">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="10" Name="מענה לשאלת המלצה מסגרות ללא המעונות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מענה לשאלת המלצה מסגרות ללא המעונות</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="ANS" pivotNameColumn="מסגרת" pivotValueColumn="Rslt" MinY="0" MaxY="100" AvgType="1">
        WITH CTE AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,FrameName מסגרת
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=4) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,FrameName),
        CTE1 AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,ServiceType תחום
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,ServiceType)
        SELECT ANS,ROUND(Rslt,0) Rslt,מסגרת,סקר,s
        FROM (
        SELECT ANS,SUM(Rslt) AS Rslt,'ארגוני - '+CTE.סקר AS מסגרת,CTE.סקר,'ארגוני' S
        FROM CTE
        GROUP BY CTE.סקר,ANS
        UNION ALL
        SELECT ANS,SUM(Rslt) AS Rslt,תחום + ' ' +CTE1.סקר AS ותק,CTE1.סקר,'aa' as s
        FROM CTE1
        GROUP BY CTE1.סקר,ANS,תחום
        UNION ALL
        SELECT CTE.ANS,SUM(CTE.Rslt) As Rslt,מסגרת+' - '+CTE.סקר As אזוק,CTE.סקר,'a' s
        FROM CTE
        GROUP BY CTE.סקר,ANS,מסגרת) a
        Order by s desc,סקר Desc,Ans
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="2">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="10" Name="מענה לשאלת המלצה שלונסקי/ליברה/הנרקיסים" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מענה לשאלת המלצה שלונסקי/ליברה/הנרקיסים</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="ANS" pivotNameColumn="מסגרת" pivotValueColumn="Rslt" MinY="0" MaxY="100" AvgType="1">
        WITH CTE AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,FrameName מסגרת
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=2) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,FrameName)
        ,
        CTE1 AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,ServiceType תחום
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,ServiceType)
        SELECT ANS,ROUND(Rslt,0) Rslt,מסגרת,סקר,s
        FROM (
        SELECT ANS,SUM(Rslt) AS Rslt,'ארגוני - '+CTE.סקר AS מסגרת,CTE.סקר,'ארגוני' S
        FROM CTE
        GROUP BY CTE.סקר,ANS
        UNION ALL
        SELECT ANS,SUM(Rslt) AS Rslt,תחום + ' ' +CTE1.סקר AS ותק,CTE1.סקר,'aa' as s
        FROM CTE1
        GROUP BY CTE1.סקר,ANS,תחום
        UNION ALL
        SELECT CTE.ANS,SUM(CTE.Rslt) As Rslt,מסגרת+' - '+CTE.סקר As מסגרת,CTE.סקר,'a' s
        FROM CTE
        GROUP BY CTE.סקר,ANS,מסגרת) a
        Order by s desc,סקר Desc,Ans
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="2">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="10" Name="מענה לשאלת המלצה מסגרות הוסטלים אחרים" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מענה לשאלת המלצה מסגרות הוסטלים אחרים</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="ANS" pivotNameColumn="מסגרת" pivotValueColumn="Rslt" MinY="0" MaxY="100" AvgType="1">
        WITH CTE AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,FrameName מסגרת
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=3) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,FrameName)
        ,
        CTE1 AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,ServiceType תחום
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,ServiceType)
        SELECT ANS,ROUND(Rslt,0) Rslt,מסגרת,סקר,s
        FROM (
        SELECT ANS,SUM(Rslt) AS Rslt,'ארגוני - '+CTE.סקר AS מסגרת,CTE.סקר,'ארגוני' S
        FROM CTE
        GROUP BY CTE.סקר,ANS
        UNION ALL
        SELECT ANS,SUM(Rslt) AS Rslt,תחום + ' ' +CTE1.סקר AS ותק,CTE1.סקר,'aa' as s
        FROM CTE1
        GROUP BY CTE1.סקר,ANS,תחום
        UNION ALL
        SELECT CTE.ANS,SUM(CTE.Rslt) As Rslt,מסגרת+' - '+CTE.סקר As אזוק,CTE.סקר,'a' s
        FROM CTE
        GROUP BY CTE.סקר,ANS,מסגרת) a
        Order by s desc,סקר Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="2">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="10" Name="מענה לשאלת המלצה המעונות" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מענה לשאלת המלצה המעונות</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="ANS" pivotNameColumn="מסגרת" pivotValueColumn="Rslt" MinY="0" MaxY="100" AvgType="1">
        WITH CTE AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,FrameName מסגרת
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT Fid FROM B10Sec.dbo.GL_Classifications WHERE ClassID=1) c ON c.Fid=a.FrameID
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,FrameName),
        CTE1 AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,ServiceType תחום
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,ServiceType)
        SELECT ANS,ROUND(Rslt,0) Rslt,מסגרת,סקר,s
        FROM (
        SELECT ANS,SUM(Rslt) AS Rslt,'ארגוני - '+CTE.סקר AS מסגרת,CTE.סקר,'ארגוני' S
        FROM CTE
        GROUP BY CTE.סקר,ANS
        UNION ALL
        SELECT ANS,SUM(Rslt) AS Rslt,תחום + ' ' +CTE1.סקר AS ותק,CTE1.סקר,'aa' as s
        FROM CTE1
        GROUP BY CTE1.סקר,ANS,תחום
        UNION ALL
        SELECT CTE.ANS,SUM(CTE.Rslt) As Rslt,מסגרת+' - '+CTE.סקר As אזוק,CTE.סקר,'a' as s
        FROM CTE
        GROUP BY CTE.סקר,ANS,מסגרת) a
        Order by s Desc,סקר Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="2">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="11" Name="מענה לשאלת המלצה לפי ותק" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מענה לשאלת המלצה לפי ותק</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="ANS" pivotNameColumn="ותק" pivotValueColumn="Rslt" MinY="0" MaxY="100" AvgType="1">
        WITH CTE AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,ISNULL(SEN,'לא צויין') AS ותק,ISNULL(SenID,99) AS SenID
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,Sen,SenID)
        SELECT ANS,ROUND(Rslt,0) Rslt,ותק,סקר
        FROM (
        SELECT ANS,SUM(Rslt) AS Rslt,'ארגוני - '+CTE.סקר AS ותק,CTE.סקר,NULL AS SenID
        FROM CTE
        GROUP BY CTE.סקר,ANS
        UNION ALL
        SELECT CTE.ANS,SUM(CTE.Rslt) As Rslt,ותק+' - '+CTE.סקר As ותק,CTE.סקר,SenID
        FROM CTE
        GROUP BY CTE.סקר,ANS,ותק,SenID) a
        Order BY SenID,סקר Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="2">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="11" Name="מענה לשאלת המלצה לפי ותק ותחום" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מענה לשאלת המלצה לפי ותק ותחום</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="ANS" pivotNameColumn="ותק" pivotValueColumn="Rslt" MinY="0" MaxY="100" AvgType="1">
        WITH CTE AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,ISNULL(SEN,'לא צויין') AS ותק,ISNULL(SenID,99) AS SenID
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,Sen,SenID),
        CTE1 AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,ServiceType תחום
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,ServiceType)
        SELECT ANS,ROUND(Rslt,0) Rslt,ותק,סקר
        FROM (
        SELECT ANS,SUM(Rslt) AS Rslt,תחום + ' ' +CTE1.סקר AS ותק,CTE1.סקר,0 AS SenID
        FROM CTE1
        GROUP BY CTE1.סקר,ANS,תחום
        UNION ALL
        SELECT ANS,SUM(Rslt) AS Rslt,'ארגוני - '+CTE.סקר AS ותק,CTE.סקר,NULL AS SenID
        FROM CTE
        GROUP BY CTE.סקר,ANS
        UNION ALL
        SELECT CTE.ANS,SUM(CTE.Rslt) As Rslt,ותק+' - '+CTE.סקר As ותק,CTE.סקר,SenID
        FROM CTE
        GROUP BY CTE.סקר,ANS,ותק,SenID) a
        Order BY SenID,סקר Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="2">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart ID="11" Name="מענה לשאלת המלצה לפי ותק ואזור" UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>מענה לשאלת המלצה לפי ותק ואזור</Name>
      <Type>StackedColumn</Type>
      <Query keyColumn="ANS" pivotNameColumn="ותק" pivotValueColumn="Rslt" MinY="0" MaxY="100" AvgType="1">
        WITH CTE AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,ISNULL(SEN,'לא צויין') AS ותק,ISNULL(SenID,99) AS SenID
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,Sen,SenID),
        CTE1 AS(
        select CAST(COUNT(*) AS float) Rslt,ISNULL(Val,0) Val,
        CASE ISNULL(Val,0)	WHEN 0 THEN 'לא ענו'
        WHEN 1 THEN 'כן'
        WHEN 2 THEN 'לא'
        ELSE 'לא מעונינים לענות' END AS ANS,a.ShortDescription AS סקר,ServiceName אזור
        FROM dbo.SV_fnAnswers_3(016) a
        INNER JOIN (SELECT SurveyID,QuestionID FROM SV_Survey_PRofileSA WHERE CategoryID=103) p ON p.SurveyID=a.OSurveyID AND p.QuestionID=a.QuestionID
        WHERE 2=2
        group by Val,a.ShortDescription,ServiceType)
        SELECT ANS,ROUND(Rslt,0) Rslt,ותק,סקר
        FROM (
        SELECT ANS,SUM(Rslt) AS Rslt,תחום + ' ' +CTE1.סקר AS ותק,CTE1.סקר,0 AS SenID
        FROM CTE1
        GROUP BY CTE1.סקר,ANS,תחום
        UNION ALL
        SELECT ANS,SUM(Rslt) AS Rslt,'ארגוני - '+CTE.סקר AS ותק,CTE.סקר,NULL AS SenID
        FROM CTE
        GROUP BY CTE.סקר,ANS
        UNION ALL
        SELECT CTE.ANS,SUM(CTE.Rslt) As Rslt,ותק+' - '+CTE.סקר As ותק,CTE.סקר,SenID
        FROM CTE
        GROUP BY CTE.סקר,ANS,ותק,SenID) a
        Order BY SenID,סקר Desc
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param>
        <Param Name="@Frames" Repl="2">[P]</Param>
        <Param Name="@ServiceType" Repl="2">תחום: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param><Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param><Param Name="@Profiles" Repl="2">מימד: [P]</Param><Param Name="@RSurveyID" />
      </Params>
    </Chart>
  </Charts>
  <Charts SurveyGroupID="4" SubGroup="1" ConnectionString="Book10VPS">
    <OrganizationalData>
      <Avg AvgType="1"></Avg>
      <Avg AvgType="2"></Avg>
    </OrganizationalData>
    <SelectionControls>
      <Control ID="DSServices" Type="sql" Scontrol="DDLServices">
        Select ServiceName,ServiceID
        From (Select 'כל האזורים' As ServiceName,0 as ServiceID
        UNION All
        SELECT ServiceName, ServiceID
        FROM ServiceList sl
        WHERE ServiceID in (1,2,3,4) AND ServiceID IN (SELECT DISTINCT ServiceID
        FROM FrameList
        WHERE FrameID IN (SELECT FrameID FROM dbo.p0v_UserFrameList
        WHERE UserID=@UserID))) x
        ORDER BY ServiceID
      </Control>
      <Control ID="DSFrames" Type="sql" Scontrol="DDLFrames">
        Select FrameName,FrameID
        From (Select 'כל המסגרות' As FrameName,'0' as FrameID
        UNION All
        SELECT FrameName,FrameID
        FROM FrameList
        WHERE FrameID IN (SELECT FrameID FROM dbo.p0v_UserFrameList
        WHERE UserID=@UserID) AND ServiceID=@ServiceID) c
      </Control>
      <Control ID="tdd" Type="tdd" Scontrol="tdd">17</Control>
      <Control ID="DSSEN" Type="sql" Scontrol="DDLSEN" SurveyID="14">
        SELECT AnswerText,val,Ord FROM (
        SELECT 'כל רמות הותק' AS AnswerText, 0 AS Val,0 AS Ord
        UNION ALL
        SELECT AnswerText,Val,Ord
        FROM SV_SurAnswers
        WHERE SurveyID=14 AND AnsGroup = 2) x
        Order by Ord
      </Control>
      <Control ID="DSSEN" Type="sql" Scontrol="DDLSEN" SurveyID="11">
        SELECT 'כל רמות הותק' AS AnswerText, 0 AS Val,0 AS Ord
      </Control>
    </SelectionControls>
    <Criterions>
      <Criterion Name="@Age">(AgeID=@Age)</Criterion>
      <Criterion Name="@Sen">(SenID=@Sen)</Criterion>
      <Criterion Name="@Lakut">(lakutID=@Lakut)</Criterion>
      <Criterion Name="@ServiceType">(ServiceTypeID=@ServiceType)</Criterion>
      <Criterion Name="@Services">(ServiceID=@Services)</Criterion>
      <Criterion Name="@Frames">(FrameID=@Frames)</Criterion>
      <Criterion Name="@ServiceID">@ServiceID</Criterion>
      <Criterion Name="@Questions">QuestionID in @Questions</Criterion>
      <Criterion Name="@UserID">FrameID in (select frameid from dbo.p0v_UserFrameList where userid=@UserID)</Criterion>
      <Criterion Name="@SurveyGroupID">@SurveyGroupID</Criterion>
      <Criterion Name="@SurveyID">סקר=@SurveyID</Criterion>
      <Criterion Name="@RSurveyID">@RSurveyID</Criterion>
      <Criterion Name="@SurveyGroupName">@SurveyGroupName</Criterion>
    </Criterions>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>אחוז השבה ארגוני</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ממוצע" pivotValueColumn="prc" AdditionalHeaderTextColumn="cnt" MinY="0" MaxY="100" AvgType="2">
        EXEC SV_pSurveyCount 1=1,1,NULL,NULL
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>אחוזי השבה למסגרת לפי אזור</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="prc" AdditionalHeaderTextColumn="cnt" MinY="0" MaxY="100" AvgType="2">
        EXEC SV_pSurveyCount 1=1,3,2=2,NULL
      </Query>
      <Params>
        <Param Name="@Services" Repl="2" Type="N"/>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr">
      <Name>אחוזי השבה למסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="prc" AdditionalHeaderTextColumn="cnt" MinY="0" MaxY="100" AvgType="2">
        EXEC SV_pSurveyCount 1=1,3,NULL,NULL,'לקוחות',2=2
      </Query>
      <Params>
        <Param Name="@UserID" Repl="2" Type="N"/>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>אחוזי השבה אזורים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="אזור" pivotValueColumn="prc" AdditionalHeaderTextColumn="cnt" MinY="0" MaxY="100" AvgType="2">
        EXEC SV_pSurveyCount 1=1,2,NULL,NULL
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,MPREFERENT,FMNGRTest,Frmngr,fmngr,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע ארגוני</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="KK" pivotValueColumn="rslt" MinY="0" MaxY="4" AvgType="1">
        SELECT סקר,rslt,'ממוצע' As KK
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר
        FROM	dbo.SV_fnAnswers_4(1=1)
        WHERE 2=2
        GROUP BY ShortDescription) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC
      </Query>
      <Params>
        <Param Name="@RSurveyID" />
        <Param Name="@ServiceType" Repl="2">שירות: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Questions" Repl="2">שאלה: [P]</Param>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr">
      <Name>ממוצע למסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="4" AvgType="1">
        SELECT rslt,סקר,מסגרת
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,FrameName AS מסגרת
        FROM	dbo.SV_fnAnswers_4x(1=1,3=3,NULL,NULL)
        WHERE 2=2
        GROUP BY ShortDescription,FrameName ) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@UserID" Repl="3" Type="N" />
        <Param Name="@RSurveyID" />
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Questions" Repl="2">שאלה: [P]</Param>
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי אזורים</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="אזור" pivotValueColumn="rslt" MinY="0" MaxY="4" AvgType="1">
        SELECT rslt,סקר,אזור
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,ServiceName AS אזור
        FROM	dbo.SV_fnAnswers_4(1=1)
        WHERE 2=2
        GROUP BY ShortDescription,ServiceName ) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Questions" Repl="2">שאלה: [P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי מסגרת</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="מסגרת" pivotValueColumn="rslt" MinY="0" MaxY="4" AvgType="1">
        SELECT rslt,סקר,מסגרת
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,FrameName AS מסגרת
        FROM	dbo.SV_fnAnswers_4(1=1)
        WHERE 2=2
        GROUP BY ShortDescription,FrameName ) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@Services" Repl="2">[P]</Param> 
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Questions" Repl="2">שאלה: [P]</Param>
        <Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי שאלות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="שאלה" pivotValueColumn="rslt" MinY="0" MaxY="4" AvgType="1">
        SELECT rslt,שאלה,סקר
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt, QuestionID AS שאלה,ShortDescription AS סקר
        FROM	dbo.SV_fnAnswers_4(1=1)
        WHERE 2=2
        GROUP BY ShortDescription,QuestionID ) x
        ORDER BY ISNULL(סקר,'') DESC,שאלה DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@Services" Repl="2" />
        <Param Name="@Frames" Repl="2" />
        <Param Name="@ServiceType" Repl="2">שירות: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Questions" Repl="2" /><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr,SMNGR">
      <Name>ממוצע לפי שאלות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="שאלה" pivotValueColumn="rslt" MinY="0" MaxY="4" AvgType="1">
        SELECT rslt,שאלה,סקר
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt, QuestionID AS שאלה,ShortDescription AS סקר
        FROM	dbo.SV_fnAnswers_4x(1=1,3=3,NULL,NULL)
        WHERE 2=2
        GROUP BY ShortDescription,QuestionID ) x
        ORDER BY ISNULL(סקר,'') DESC,שאלה DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@UserID" Repl="3" Type="N" />
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Questions" Repl="2" /><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי שירות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="שירות" pivotValueColumn="rslt" MinY="0" MaxY="4" AvgType="1">
        SELECT rslt,סקר,שירות
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,ServiceType AS שירות
        FROM	dbo.SV_fnAnswers_4(1=1)
        WHERE 2=2
        GROUP BY ShortDescription,ServiceType ) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Questions" Repl="2" /><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי לקות</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="לקות" pivotValueColumn="rslt" MinY="0" MaxY="4" AvgType="1">
        SELECT rslt,סקר,לקות
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,Lakut AS לקות
        FROM	dbo.SV_fnAnswers_4(1=1)
        WHERE 2=2
        GROUP BY ShortDescription,Lakut) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Questions" Repl="2" /><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי קבוצת גיל</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="גיל" pivotValueColumn="rslt" MinY="0" MaxY="4" AvgType="1">
        SELECT rslt,סקר,גיל
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,Age AS גיל
        FROM	dbo.SV_fnAnswers_4(1=1)
        WHERE Age IS NOT NULL AND 2=2
        GROUP BY ShortDescription,Age) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@ServiceType" Repl="2">שירות: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Sen" Repl="2">ותק: [P]</Param>
        <Param Name="@Questions" Repl="2" /><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="Admin,FullSurveys,MPMNGR,SMNGR">
      <Name>ממוצע לפי ותק</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ותק" pivotValueColumn="rslt" MinY="0" MaxY="4" AvgType="1">
        SELECT rslt,סקר,ותק
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,SEN AS ותק
        FROM	dbo.SV_fnAnswers_4(1=1)
        WHERE SEN IS NOT NULL AND 2=2
        GROUP BY ShortDescription,SEN) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@ServiceType" Repl="2">שירות: [P]</Param>
        <Param Name="@Lakut" Repl="2">לקות: [P]</Param>
        <Param Name="@Age" Repl="2">קבוצת גיל: [P]</Param>
        <Param Name="@Questions" Repl="2" /><Param Name="@RSurveyID" />
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr">
      <Name>ממוצע לפי ותק</Name>
      <Type>Column</Type>
      <Query keyColumn="סקר" pivotNameColumn="ותק" pivotValueColumn="rslt" MinY="0" MaxY="4" AvgType="1">
        SELECT rslt,סקר,ותק
        FROM (
        SELECT ROUND(AVG(CAST(Val AS float)), 2) AS rslt,ShortDescription AS סקר,SEN AS ותק
        FROM	dbo.SV_fnAnswers_4x(1=1,3=3,NULL,NULL)
        WHERE SEN IS NOT NULL AND 2=2
        GROUP BY ShortDescription,SEN) x
        WHERE rslt IS NOT NULL
        ORDER BY ISNULL(סקר,'') DESC,ISNULL(rslt,0)
      </Query>
      <Params>
        <Param Name="@UserID" Repl="3" Type="N"/>
        <Param Name="@Questions" Repl="2"/>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr,SurveysF,Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>רשימת הטקסטים החופשיים במסגרת</Name>
      <Type>URL</Type>
      <Query>
        SurveyTexts.aspx?sg=1=1&amp;T=2=2&amp;sb=1&amp;r=רשימת הטקסטים החופשיים&amp;s=3=3
      </Query>
      <Params>
        <Param Name="@RSurveyID" Repl="3" Conc=""/>
        <Param Name="@SurveyGroupID" Repl="1" Conc=""/>
        <Param Name="@SurveyGroupName" Repl="2" Conc=""/>
      </Params>
    </Chart>
    <Chart UserGroups="MPREFERENT,FMNGRTest,Frmngr,fmngr,SurveysF,Admin,SMNGR,MPMNGR,FullSurveys">
      <Name>הטקסט המלא של שאלות הסקר</Name>
      <Type>URL</Type>
      <Query>
        SurveyQuestionpopup.aspx?s=1=1&amp;g=1
      </Query>
      <Params>
        <Param Name="@RSurveyID"/>
      </Params>
    </Chart>
  </Charts>
</Surveys>
